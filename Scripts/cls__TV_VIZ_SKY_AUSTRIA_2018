<script>
<script_header>
</script_header>
<script_body>

Class cls__TV_VIZ_SKY_AUSTRIA_2018
     public s__VizPath,s__VizPathAR,s__VizPathARTemp  ,s__VizPathWF
     Private ActionList
     Private s__LastAnim
     public s__FotoPath, s__LogoPath, s__SymbolPath, s__PhotoPath, s__BibPath, s__VartafelPath , s__PlayerFotoPath,s__LogoPathDiv,s__PhotoVirtual ,s__ColorPath
     private b__VisibleDSS, b__VisibleClock, b__VisibleADD, b__VisibleText ,b__VisibleRedCardH,b__VisibleRedCardG
     Public objNames(13), objID(13)
     Private i__TVContent
     Private obj__TV
     Private i__TVLanguage
     private PAGE_IDX   ' Für wechsel Animationen
     Private sScene
     Private dssishiding
     private databuffer
     public s_ARScene
    private data
    private i_variant
    private pnggenerate
    public s_pngscene
    
    private displaysponsor
    
    dim ExportData
    dim ExportDataTyp
    dim ExportDataDesc

    Private Sub Class_Initialize
    End Sub

    Public default function init(i)
         i_variant=i
         cc.SF.DebugText i
        s__VizPath    = "scene/SKY/Redesign_2016/Austria/Fussball"
        s__VizPathWF    = "VizDbCube/scene/Live_Sports/Austria/Redesign_2018"
        s__VizPathAR    = "scene/SKY/Redesign_2016/Austria/Fussball_AR"
        s__VizPathARTemp    = "scene/SKY/Redesign_2016/Austria/Fussball_AR/temp"
        s__LastAnim   = GetIniOption("LAST_SCENE", "")
        s__ColorPath   = "material/SKY/Austria/Fussball"
        s__LogoPath   = "image/SKY/Redesign_2016/Logos/Austria/Fussball"
        s__LogoPathDiv   = "image/SKY/Redesign_2016/Logos/Diverse"
        s__FotoPath   = "image/SKY/Redesign_2016/Fotos/Kommentatoren"
        s__PlayerFotoPath   = "image/SKY/Redesign_2016/Fotos/Spieler/AUT"
        s__VartafelPath = "scene/SKY/Redesign_2016/Vartafeln/Austria"
        s__PhotoVirtual ="image/VIRTUAL"
        Set Obj__TV     = Nothing
        b__VisibleDSS   = cBool(GetIniOption("VISIBLE_DSS", "false"))         ' DSS allgemein
        b__VisibleClock = cBool(GetIniOption("VISIBLE_CLOCK", "False"))       ' DSS mit Rolling Time
        b__VisibleADD   = cBool(GetIniOption("VISIBLE_ADD", "False"))         ' DSS Zusatz  Overtime clock
        b__VisibleText  = cBool(GetIniOption("VISIBLE_TEXT", "False"))        ' DSS Zusatz Infotext
        b__VisibleRedCardH = cBool(GetIniOption("VISIBLE_CARDH", "False"))
        b__VisibleRedCardG = cBool(GetIniOption("VISIBLE_CARDG", "False"))
        dssishiding=false
         databuffer=off
         displaysponsor=""
         set ExportData = CreateObject("Scripting.Dictionary")
         set ExportDataTyp = CreateObject("Scripting.Dictionary")
         set ExportDataDesc = CreateObject("Scripting.Dictionary")
    End function

    Private Sub Class_Terminate()
    End Sub
    
    public sub SaveAR(name)
        dim uuid
        uuid = obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*UUID GET")
        obj__TV.SendCommandEx("SCENE SAVE_AS "&uuid&" """&s__VizPathARTemp&"/"&name&"""")
    end sub
    
    public sub ExportARXml(name)
        dim outtxt
        outtxt="<?xml version=""1.0""?>"&vbCrLf&"<data>"&vbCrLf
        for each param in ExportData.keys()
            outtxt=outtxt&"<entry key="""&param&""" value="""&ExportData.Item(param)&""" typ="""&ExportDataTyp.Item(param)&""" desc="""&ExportDataDesc.Item(param)&"""></entry>"&vbCrLf
        next
        
        outtxt=outtxt&"</data>"
        dim   objFSO, outFile
        Set objFSO=CreateObject("Scripting.FileSystemObject")
        'datu+zeit
        'TimeStamp

        outFile=pg_settings.tb_arexportpath.text &"\"&TimeStamp&"_"&name&".xml"
        
        Set objFile = objFSO.CreateTextFile(outFile,True)
        objFile.Write outtxt
        objFile.Close
    end sub
    
    public sub GetARScenes()
        tw_virtuell.cb_gfx.Items.Clear
        tw_virtuell.cb_gfx.Items.Add "NONE"
        dim Tmp : Tmp = obj__TV.GetGroupItems(s__VizPathARTemp, gkScene)
        dim i,res
        If IsArray(Tmp) Then
            For i = 0 to UBound(Tmp)
                tw_virtuell.cb_gfx.Items.Add Tmp(i)
            next
        end if
    end sub


    public Sub SetVizData(id, value,typ,desc)
        If obj__TV is Nothing Then Exit Sub
        if databuffer then
            data=data & id&" SET "&value&"\0"
        else
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON " &id&" SET "&value)
        end if
        if ExportData.Exists(id) then
            ExportData.Item(id)=value
        else
            ExportData.add id,value
        end if
        if ExportDataTyp.Exists(id) then
            ExportDataTyp.Item(id)=typ
        else
            ExportDataTyp.add id,typ
        end if
        if ExportDataDesc.Exists(id) then
            ExportDataDesc.Item(id)=desc
        else
            ExportDataDesc.add id,desc
        end if
    end sub

    public Sub SetVizDataUpper(id, value,typ,desc)	
		SetVizData id,ucase(value),typ,desc       
    end sub
    
    public sub SetVizDataBufferOn
        data="RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON "
        databuffer=true
    end sub
    public sub SetVizDataBufferOff
        obj__TV.SendCommand(data)
        databuffer=false
    end sub
    
    public Sub SetVizDataFL(id, value)
        If obj__TV is Nothing Then Exit Sub
        obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON " &id&" SET "&value)
    end sub

    public Sub SetVizDataUpperFL(id, value)
        If obj__TV is Nothing Then Exit Sub
        obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON " &id&" SET "&Ucase(value))
    end sub
    
    public Sub SetVizDataBL(id, value)
        If obj__TV is Nothing Then Exit Sub
        obj__TV.SendCommand("RENDERER*BACK_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON " &id&" SET "&value)
    end sub

    public Sub SetVizDataUpperBL(id, value)
        If obj__TV is Nothing Then Exit Sub
        obj__TV.SendCommand("RENDERER*BACK_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON " &id&" SET "&ucase(value))
    end sub
    
    public Sub SetPFirstName(value)
        SetVizData "0100",value,"string","Player First name"
    end sub
    public Sub SetPLastName(value)
        SetVizData "0102",value,"string" ,"Player Last Name"
    end sub
    
    public Sub SetPFirstName2(value)
        SetVizData "0104",value,"string" ,"Player B First Name"
    end sub
    public Sub SetPLastName2(value)
        SetVizData "0106",value,"string", "Player B Last Name"
    end sub
    public Sub SetPNummer(value)
        SetVizData "0095",value,"string", "Player Number"
    end sub
    public Sub SetTName(value)
        SetVizData "0100",value,"string" ,"Team Name"
    end sub
    public Sub SetTLogo(value)
        if value="" then
            SetVizData "0089" ,0,"int","Team Logo On/Off"
        else
            SetVizData "0089",1 ,"int","Team Logo On/Off"
            SetVizData "0090","IMAGE*"&s__LogoPath & "/" &value,"image","Team Logo"
        end if
    end sub
    public Sub SetTName2(value)
        SetVizData "0200",value,"string","Team 2 Name"
    end sub
    public Sub SetTLogo2(value)
        SetVizData "0190","IMAGE*"&s__LogoPath & "/" &value,"image","Team 2 Logo"
    end sub
    public Sub SetTLogo2_WF(value)
        SetVizData "0095","IMAGE*"&s__LogoPath & "/" &value,"image","Team 2 Logo(WF)"
    end sub
    public Sub SetPHSOff()
        SetVizData "0092",0,"int","Player Headshot On/Off"
    end sub
    public Sub SetPHS(team,value)
        SetVizData "0092",1 ,"int","Player Headshot On/Off"
        SetVizData "0093","IMAGE*"&s__PlayerFotoPath & "/" & team & "/"&value,"image","Player Headshot"
    end sub
    
    public Sub SetMHS(valuel, valuer)
        SetVizData "0092",1 ,"int","Mod/Com Headshot On/Off"
        SetVizData "0093","IMAGE*"&s__FotoPath & "/" & valuel,"image","Mod/Com Headshot"
        SetVizData "0094","IMAGE*"&s__FotoPath & "/" & valuer,"image","Mod/Com Headshot"
    end sub
    
   public sub SetScore(value)
        SetVizData "0149",1 ,"int","Score On/Off"
        SetVizData "0150",value,"string","Score"
   end sub
   
   public Sub SetSubLine (value)
        SetVizData "0500",value,"string","Subline"
    end sub
    public Sub SetTitle(value)
        SetVizData "0100",value,"string","Title"
        SetVizData "0102","","string","Title 2.Part"
    end sub
    public Sub SetTitleSubLine (value)
        SetVizData "0200",value,"string","Title Subline"
    end sub
    public Sub SetDropLine (value)
        SetVizData "9000",value,"string","Dropline"
    end sub
    
    public Sub SetTitleLogo(value,league)
        if value="" then
            SetVizData "0085" ,0,"int","Title Logo VAR/Off"
        else
            if league = true then
                SetVizData "0085" ,2 ,"int","Title Logo VAR/Off"
                SetVizData "0095","IMAGE*"&s__LogoPathDiv & "/" &value ,"image","Title Logo"
            else
                SetVizData "0085" ,1 ,"int","Title Logo VAR/Off"
                SetVizData "0090","IMAGE*"&s__LogoPath & "/" &value ,"image","Title Logo"
            end if
        end if
    end sub
    
    public Sub SetTitelDefaultHeader
        'if tw_Layout.layout.ItemIndex =3 AND pgmain.cb_hide_logo.Checked =false then
        '    SetTitleLogo "talk_tore_schwarz",true
        if CURRENT_LEAGUE = "119" AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogo "tipico_bl_hoch",true
        elseif CURRENT_LEAGUE = "513" AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogo "skygo_erste_liga_hoch",true
        elseif tw_Layout.layout.ItemIndex =1 AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogo "cl",true
         elseif tw_Layout.layout.ItemIndex =2 AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogo "el_logo_quer",true
        else
            SetTitleLogo "",true
        end if
    end sub
    
    public Sub SetTitleLogoLF(value,league)
        if value="" then
            SetVizData "000085" ,0 ,"int","Title Logo VAR/Off"
        else
            if league = true then
                SetVizData "000085" ,2 ,"int","Title Logo VAR/Off"
                SetVizData "000095","IMAGE*"&s__LogoPathDiv & "/" &value ,"image","Title Logo"
            else
                SetVizData "000085" ,1 ,"int","Title Logo VAR/Off"
                SetVizData "000090","IMAGE*"&s__LogoPath & "/" &value ,"image","Title Logo"
            end if
        end if
    end sub

    public Sub SetTitelDefaultHeaderLF
        'if tw_Layout.layout.ItemIndex =3 AND pgmain.cb_hide_logo.Checked =false then
        '    SetTitleLogoLF "talk_tore_schwarz",true
        if CURRENT_LEAGUE = "119" AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogoLF "tipico_bl_hoch",true
        elseif CURRENT_LEAGUE = "513" AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogoLF "skygo_erste_liga_hoch",true
        elseif tw_Layout.layout.ItemIndex =1 AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogoLF "cl",true
         elseif tw_Layout.layout.ItemIndex =2 AND pgmain.cb_hide_logo.Checked =false then
            SetTitleLogoLF "el_logo_quer",true
        else
            SetTitleLogoLF "",true
        end if
    end sub
    
    public Sub SetTeamLogo(id,value,desc)
        SetVizData id,"IMAGE*"&s__LogoPath & "/" &value ,"image",desc
    end sub
    public Sub SetPlayerHS(id,team,value,desc)
        SetVizData id,"IMAGE*"&s__PlayerFotoPath & "/" & team & "/"&value ,"image",desc
    end sub
    
    public Sub SetPlayerHSFL(id,team,value)
        SetVizDataFL id,"IMAGE*"&s__PlayerFotoPath & "/" & team & "/"&value
    end sub
    
    
    public Sub SetLFTitle(value)
        SetVizData "000100",value,"string","L-Form Title"
        SetVizData "000102","" ,"string",""
    end sub

    public sub SetBGOnOff()
        if pgmain.cb_background.Checked then
            SetVizData "0002",1,"int","BG On/Off"
        else
            SetVizData "0002",0 ,"int","BG On/Off"
        end if
    end sub
    
    public sub SetCommercialOnOff(scene)
        if tw_commercial.cb_nexttime.Checked=true  then
            SetVizData "0007",1 ,"commercial","Sponsor"
            displaysponsor=scene
        else
            SetVizData "0007",0 ,"commercial","Sponsor"
            displaysponsor=""
        end if
    end sub
    
    public sub SetCommercialOnOffManual(onoff,scene)
        if onoff=true  then
            SetVizData "0007",1 ,"commercial","Sponsor"
            displaysponsor=scene
        else
            SetVizData "0007",0 ,"commercial","Sponsor"
            displaysponsor=""
        end if
    end sub
    
    public sub SetBGOnOffWF()
        if pgmain.cb_background.Checked then
            SetVizData "0001",1,"int" ,"BG On/Off (WF)"
            SetVizData "0008",0 ,"int","BG 2 On/Off (WF)"
        else
            SetVizData "0001",0 ,"int","BG On/Off (WF)"
            SetVizData "0008",1 ,"int","BG 2 On/Off (WF)"
        end if
    end sub
    
    public sub SetIBSide()
        if pgmain.cb_ib_right.Checked = true then
            SetVizData "0002",1 ,"int","IB Side"
        else
            SetVizData "0002",0 ,"int","IB Side"
        end if
    end sub
    
    public sub SetShow()
        dim i
        select case tw_Layout.layout.ItemIndex
            case 0      i=1
            case 1      i=3
            case 2      i=4
            case 3      i=11
            case 4      i=8
            case 5      i=9
        end select
        SetVizData "0000",i ,"int","Show"
    end sub
    
    public function get_available_logos()
        dim fList
        on error resume next
        fList = obj__TV.GetGroupItems(s__LogoPath, gkImage)
        if Err.Number <> 0 Then
             MsgBox "Please connect to an everest provider first! " & Err.Number & " " & Err.Description
             Err.Clear
             exit function
        end if
        on error goto 0
        get_available_logos = fList
    end function
    
     public function get_available_logodiv()
        dim fList
        on error resume next
        fList = obj__TV.GetGroupItems(s__LogoPathDiv, gkImage)
        if Err.Number <> 0 Then
             MsgBox "Please connect to an everest provider first! " & Err.Number & " " & Err.Description
             Err.Clear
             exit function
        end if
        on error goto 0
        get_available_logodiv = fList
    end function

    public function get_available_fotos()
        dim fList
        on error resume next
        fList = obj__TV.GetGroupItems(s__FotoPath, gkImage)
        if Err.Number <> 0 Then
             MsgBox "Please connect to an everest provider first! " & Err.Number & " " & Err.Description
             Err.Clear
             exit function
        end if
        on error goto 0
        get_available_fotos = fList
    end function

    public function get_available_playerfotos()
        dim fList
        on error resume next
        fList = obj__TV.GetGroupItems(s__PlayerFotoPath, gkImage)
        if Err.Number <> 0 Then
             MsgBox "Please connect to an everest provider first! " & Err.Number & " " & Err.Description
             Err.Clear
             exit function
        end if
        on error goto 0
        get_available_playerfotos = fList
    end function

    public function get_available_scenes()
        dim fList
        on error resume next
        fList = obj__TV.GetGroupItems(s__VartafelPath, gkScene)
        if Err.Number <> 0 Then
             MsgBox "Please connect to an everest provider first! " & Err.Number & " " & Err.Description
             Err.Clear
             exit function
        end if
        on error goto 0
        get_available_scenes = fList
    end function
    
    public function get_available_fotosvirtual()
        dim fList
        on error resume next
        fList = obj__TV.GetGroupItems(s__PhotoVirtual, gkImage)
        if Err.Number <> 0 Then
             MsgBox "Please connect to an everest provider first! " & Err.Number & " " & Err.Description
             Err.Clear
             exit function
        end if
        on error goto 0
        get_available_fotosvirtual = fList
    end function

    public Sub Kill_Bill()
        obj__TV.DoEffect elFrontLayer, "ALL", efReset
        obj__TV.DoEffect elMainLayer,  "ALL", efReset
        obj__TV.ClearScene  elMainLayer
        obj__TV.DoEffect elBackLayer,  "ALL", efReset
        obj__TV.SendCommand "RENDERER PREVIEW CURRENT VIDEO ALL 0.0"
        s__LastAnim = ""
        SetIniOption "LAST_SCENE", s__LastAnim
        ReDim ActionList(1, 0)
        ActionList(0, 0) = ""
        b__VisibleDSS   = False
        b__VisibleClock = False
        b__VisibleADD   = False
        b__VisibleText  = False
        b__VisibleRedCardH = false
        b__VisibleRedCardG = false
        call SetIniOption("VISIBLE_DSS", b__VisibleDSS)
        call SetIniOption("VISIBLE_CLOCK", b__VisibleClock)
        call SetIniOption("VISIBLE_ADD",  b__VisibleADD)
        call SetIniOption("VISIBLE_TEXT", b__VisibleText)
        call SetIniOption("VISIBLE_CARDH", b__VisibleRedCardH)
        call SetIniOption("VISIBLE_CARDG", b__VisibleRedCardG)
    end sub

    Public Sub Anzeigen()
        dim i
        If obj__TV is Nothing Then Exit Sub
        If not IsArray(ActionList) Then Exit Sub
        For i = 1 to UBound(ActionList, 2)
'            msgbox ActionList(1, i) & " " & ActionList(2, i)
            obj__TV.DoEffect elMainLayer, ActionList(1, i), ActionList(2, i)
        Next
        s__LastAnim = ActionList(1, 0)
        SetIniOption "LAST_SCENE", s__LastAnim
        if not i_variant=1 then exit sub
        if displaysponsor<>"" then
            lastcom=time()
            comcount=comcount+1
            pg_settings.list_sponsoren.Items.Add "[" & split(now())(1) & "] " & displaysponsor
            displaysponsor=""

        end if
    End Sub

    Public Sub Continue(Director)
        dim i
        If obj__TV is Nothing Then Exit Sub
        for i = 1 to 15     ' Echt scheiße programmiert ich weiß. Aber es muss jetzt schnell fertig werden
            obj__TV.DoEffect elMainLayer, "H" & i, efReset
        next
        obj__TV.DoEffect elMainLayer, Director, efContinue
        s__LastAnim = "Default" ' Damit clear All wieder funktioniert
        SetIniOption "LAST_SCENE", s__LastAnim
    End Sub

    public Sub PlayChange(dir, dir2)
        If obj__TV is Nothing Then Exit Sub
        obj__TV.DoEffect elMainLayer, dir2, efReset
        obj__TV.DoEffect elMainLayer, dir, efContinue
        obj__TV.DoEffect elMainLayer, dir2, efPlay
        s__LastAnim = "Default" ' Damit clear All wieder funktioniert
        SetIniOption "LAST_SCENE", s__LastAnim
    end sub


    Public Sub Init_Layouts(machine_type)
        dim Tmp : Tmp = obj__TV.GetGroupItems(s__VizPath, gkScene)
        dim i,res
        If IsArray(Tmp) Then
            obj__TV.RendererUpdate false
            obj__TV.OpenProject s__VizPath
            if not pg_settings.cb_fastinit.Checked then
                For i = 0 to UBound(Tmp)
                    CC.SF.ShowSplashForm "Please wait while initializing scenes... (" & Tmp(i) & ")" , RGB(128,12,89)
    '               LoadScene 2, Tmp(i)

                    obj__TV.SendCommandEx("POOLS CLEANUP")
                    obj__TV.SetScene Tmp(i)
                    res = obj__TV.SendCommandEx("RENDERER*MAIN_LAYER SET_OBJECT SCENE*" & s__VizPath & "/" & Tmp(i))
                    res = obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*NAME GET")
                    Prepare_Layer  elMainLayer
                    CC.SF.Wait 100
                Next
            end if

            'obj__TV.SetScene "DSS_Uhr"
            'obj__TV.LoadScene elFrontLayer
            'obj__TV.DoEffect elFrontLayer, "ALL", efReset
            b__VisibleDSS     = True
            b__VisibleADD     = False
            b__VisibleText    = False



            obj__TV.RendererUpdate true
        End If
        if getGFXV =2 then
            Tmp = obj__TV.GetGroupItems(s__VizPathWF, gkScene)
            If IsArray(Tmp) Then
                obj__TV.RendererUpdate false
                obj__TV.OpenProject s__VizPathWF
                if not pg_settings.cb_fastinit.Checked then
                    For i = 0 to UBound(Tmp)
                        CC.SF.ShowSplashForm "Please wait while initializing scenes... (" & Tmp(i) & ")" , RGB(128,12,89)
        '               LoadScene 2, Tmp(i)

                        obj__TV.SendCommandEx("POOLS CLEANUP")
                        obj__TV.SetScene Tmp(i)
                        res = obj__TV.SendCommandEx("RENDERER*MAIN_LAYER SET_OBJECT SCENE*" & s__VizPathWF & "/" & Tmp(i))
                        res = obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*NAME GET")
                        Prepare_Layer  elMainLayer
                        CC.SF.Wait 100
                    Next
                end if
                obj__TV.ClearScene  elMainLayer

                obj__TV.SetScene "DSS"
                obj__TV.LoadScene elFrontLayer
                obj__TV.DoEffect elFrontLayer, "ALL", efReset

                if pg_settings.rb_opmode.ItemIndex=0 then
                    obj__TV.SetScene "VideoBG"
                    obj__TV.LoadScene elBacklayer
                end if
                
                if pg_settings.rb_opmode.ItemIndex>0 then
                    obj__TV.SetScene "DSS_Konf"
                    obj__TV.LoadScene elBacklayer
                    obj__TV.DoEffect elBacklayer, "ALL", efReset
                end if


                b__VisibleDSS     = True
                b__VisibleADD     = False
                b__VisibleText    = False



                obj__TV.RendererUpdate true
            End If
        end if
        
        ' BLACKBURST BUG IM VIZ 3.5
        select case machine_type
            case 0      ' Matrox --> Nix zu tune
            case 1      ' DVE BlackBurst
                obj__TV.SendCommand "MAIN*CONFIGURATION*VIDEO_OUTPUT*GENLOCK SET FREERUN"
                obj__TV.SendCommand "MAIN*CONFIGURATION*VIDEO_OUTPUT*GENLOCK SET BLACKBURST"
                cc.sf.wait 2000
            case 2      ' DVE TriLevel
                obj__TV.SendCommand "MAIN*CONFIGURATION*VIDEO_OUTPUT*GENLOCK SET FREERUN"
                obj__TV.SendCommand "MAIN*CONFIGURATION*VIDEO_OUTPUT*GENLOCK SET TRILEVEL"
                cc.sf.wait 2000
        end select
        s__LastAnim = ""
        SetIniOption "LAST_SCENE", s__LastAnim
        ReDim ActionList(1, 0)
        ActionList(0, 0) = ""
        cc.SF.HideSplashForm
    End Sub

    ' Spieler BB,  Zeilen = [1-3]
    public sub BB_Player(byRef Data, byVal bContinue)
        'if getGFXV =2 then
        if Data.Item("ISWF")= true then
            BB_Player_WF Data,bContinue
            exit sub
        end if
        if not i_variant=1 then exit sub
        if not bContinue then
'            ClearAll
            if     Data.Item("SUBLINE2") <> "" then
                sScene = "BB_3z_"
            elseif Data.Item("SUBLINE1") <> "" then
                sScene = "BB_2z_"
            else
                sScene = "BB_1z_"
            end if
            if Data.Item("LOGO") <> "" then
                sScene = sScene & "Logo"
            else
                sScene = sScene & "Neutral"
            end if

            LoadScene elMainLayer, sScene
            SetShow
            SetVizData "0475", 0,"int",""
            SetPLastName Data.Item("NAME")
            SetPFirstName Data.Item("FNAME")
            if Data.Item("NR")<>"00" then
                SetPNummer Data.Item("NR")
            else
                SetPNummer ""
            end if
            if Data.Item("LOGO") <> "" then
                SetTLogo LCase(Data.Item("LOGO"))
            end if
            if Data.item("SHOWHS") and Data.Item("NR")<>"" then
                SetPHS LCase(Data.Item("LOGO")),Data.Item("NR")
            else
                SetPHSOff
            end if
            dim st,tag,st2,tag2
            select case Data.item("BBTYP")
                case 0
                    SetVizData "0190",0 ,"int",""
                    SetVizData "0200",Data.Item("SUBLINE1") ,"string","Zeile 1"
                    SetVizData "0300",Data.Item("SUBLINE2") ,"string","Zeile 2"
                    SetVizData "0195",0 ,"int",""
                    SetVizData "0196",0 ,"int",""
                case 1
                    st= Data.Item("SUBLINE1")
                    if instr(st,"/")>0 then
                        tag= split(st,"/")(1)
                        st= trim(split(st,"/")(0))
                        if st<>"" then st=st&"/"
                    end if
                    st2= Data.Item("SUBLINE2")
                    if instr(st2,"/")>0 then
                        tag2= split(st2,"/")(1)
                        st2= trim(split(st2,"/")(0))
                        if st2<>"" then st2=st2&"/"
                    end if
                    SetVizData "0190",1 ,"int",""
                    SetVizData "0195",2 ,"int",""
                    SetVizData "0196",2 ,"int",""
                    SetVizData "0197",2 ,"int",""
                    SetVizData "0210", st ,"string","Zeile 1"
                    SetVizData "0212",st2 ,"string","Zeile 2"
                    SetVizData "0211",tag ,"string","Tag 1"
                    SetVizData "0213",tag2 ,"string","Tag 2"
                case 2
                    st= Data.Item("SUBLINE1")
                    if instr(st,"/")>0 then
                        tag= split(st,"/")(1)
                        st= trim(split(st,"/")(0))
                        if st<>"" then st=st&"/"
                    end if
                    st2= Data.Item("SUBLINE2")
                    if instr(st2,"/")>0 then
                        tag2= split(st2,"/")(1)
                        st2= trim(split(st2,"/")(0))
                        if st2<>"" then st2=st2&"/"
                    end if
                    SetVizData "0190",1 ,"int",""
                    SetVizData "0195",1 ,"int",""
                    SetVizData "0196",1 ,"int",""
                    SetVizData "0197",1 ,"int",""
                    SetVizData "0210",st ,"string","Zeile 1"
                    SetVizData "0212",st2 ,"string","Zeile 2"
                    SetVizData "0211",tag  ,"string","Tag 1"
                    SetVizData "0213",tag2 ,"string","Tag 2"
                case 3
                    SetVizData "0190",2 ,"int",""
                    SetVizData "0220",Data.Item("SUBLINE1") ,"string","Zeile 1"
                    SetVizData "0222",Data.Item("SUBLINE2") ,"string","Zeile 2"
                case 4
                    st= Data.Item("SUBLINE1")
                    if instr(st,"/")>0 then
                        tag= split(st,"/")(1)
                        st= trim(split(st,"/")(0))
                        if st<>"" then st=st&"/"
                    end if
                    st2= Data.Item("SUBLINE2")
                    if instr(st2,"/")>0 then
                        tag2= split(st2,"/")(1)
                        st2= trim(split(st2,"/")(0))
                        if st2<>"" then st2=st2&"/"
                    end if
                    SetVizData "0190",1  ,"int",""
                    SetVizData "0195",3  ,"int",""
                    SetVizData "0196",3 ,"int",""
                    SetVizData "0197",3   ,"int",""
                    SetVizData "0210",st ,"string","Zeile 1"
                    SetVizData "0212",st2 ,"string","Zeile 2"
                    SetVizData "0211",tag ,"string","Tag 1"
                    SetVizData "0213",tag2 ,"string","Tag 2"
            end select


            GetPreview "Default 2.0", "WECHSEL 0.0", sScene        ' ACHTUNG!!!!!
            Redim ActionList(2, 1)
            ActionList(1, 0) = "Default"
            ActionList(1, 1) = "Default"
            ActionList(2, 1) = efPlay

            PAGE_IDX = 1
        else
            if PAGE_IDX mod 2 then
                SetVizData "0202",Data.Item("SUBLINE1") ,"string","Zeile 1"
                SetVizData "0302",Data.Item("SUBLINE2") ,"string","Zeile 2"
                SetVizData "0201",Data.Item("SUBLINE1") ,"string","Zeile 1"
                SetVizData "0301",Data.Item("SUBLINE2") ,"string","Zeile 2"
                GetPreview "Default 2.0", "WECHSEL 1.0", sScene
                Redim ActionList(2, 1)
                ActionList(1, 0) = "Default"
                ActionList(1, 1) = "WECHSEL"
                ActionList(2, 1) = efPlay
            else
                SetVizData "0202",Data.Item("SUBLINE1") ,"string","Zeile 1"
                SetVizData "0302",Data.Item("SUBLINE2") ,"string","Zeile 2"
                SetVizData "0204",Data.Item("SUBLINE1") ,"string","Zeile 1"
                SetVizData "0304",Data.Item("SUBLINE2") ,"string","Zeile 2"
                GetPreview "Default 2.0", "WECHSEL 2.0", sScene
                Redim ActionList(2, 1)
                ActionList(1, 0) = "Default"
                ActionList(1, 1) = "WECHSEL"
                ActionList(2, 1) = efContinue
            end if
            PAGE_IDX = PAGE_IDX + 1
        end if
    end sub
    
    public sub BB_Player_WF(byRef Data, byVal bContinue)
        dim p
        p="2.0"
        if not bContinue then
'            ClearAll
            if  Data.Item("SUBLINE2") <> "" then
                sScene = "BB_2z_"
            elseif Data.Item("SUBLINE1") <> "" then
                sScene = "BB_2z_"
            else
                sScene = "BB_1z_"
                if Data.item("SHOWHS") and Data.Item("NR")<>"" then
                    sScene = "BB_2z_"
                end if
            end if
            if Data.item("SHOWHS") and Data.Item("NR")<>"" then
                sScene = sScene & "Foto"
                p="2.78"
            else
                sScene = sScene & "Logo"
                p="1.98"
            end if

            LoadSceneWF elMainLayer, sScene
            SetCommercialOnOff "BB Player"
            SetVizData "0004", 0 ,"int",""
            SetPLastName ucase(Data.Item("NAME"))
            SetPFirstName ucase(Data.Item("FNAME") )
            if Data.Item("NR")<>"00" then
                SetPNummer Data.Item("NR")
            else
                SetPNummer ""
            end if
            if Data.Item("LOGO") <> "" then
                SetTLogo LCase(Data.Item("LOGO"))
            else
                SetVizData "0090","IMAGE*"&s__LogoPathDiv & "/" &"ofbl_Ball","image","Logo Div"
            end if
            if Data.item("SHOWHS") and Data.Item("NR")<>"" then
                SetPHS LCase(Data.Item("LOGO")),Data.Item("NR")
            else
                SetPHSOff
            end if
            dim st,tag,st2,tag2
            select case Data.item("BBTYP")
                case 0
                    SetVizData "0190",0 ,"int",""
                    SetVizDataUpper "0200",Data.Item("SUBLINE1") ,"string","Zeile 1"
                    SetVizDataUpper "0300",Data.Item("SUBLINE2"),"string","Zeile 2"
                    SetVizData "0195",0 ,"int",""
                    SetVizData "0196",0 ,"int",""
                case 1
                    st= Data.Item("SUBLINE1")
                    if instr(st,"/")>0 then
                        tag= split(st,"/")(1)
                        st= trim(split(st,"/")(0))
                        if st<>"" then st=st&"/"
                    end if
                    st2= Data.Item("SUBLINE2")
                    if instr(st2,"/")>0 then
                        tag2= split(st2,"/")(1)
                        st2= trim(split(st2,"/")(0))
                        if st2<>"" then st2=st2&"/"
                    end if
                    SetVizData "0190",1  ,"int",""
                    SetVizData "0195",2  ,"int",""
                    SetVizData "0196",2  ,"int",""
                    SetVizData "0197",2  ,"int",""
                    SetVizDataUpper "0210", st  ,"string","Zeile 1"
                    SetVizDataUpper "0212",st2 ,"string","Zeile 2"
                    SetVizData "0211",tag     ,"string","Tag 1"
                    SetVizData "0213",tag2    ,"string","Tag 2"
                case 2
                    st= Data.Item("SUBLINE1")
                    if instr(st,"/")>0 then
                        tag= split(st,"/")(1)
                        st= trim(split(st,"/")(0))
                        if st<>"" then st=st&"/"
                    end if
                    st2= Data.Item("SUBLINE2")
                    if instr(st2,"/")>0 then
                        tag2= split(st2,"/")(1)
                        st2= trim(split(st2,"/")(0))
                        if st2<>"" then st2=st2&"/"
                    end if
                    SetVizData "0190",1 ,"int",""
                    SetVizData "0195",1 ,"int",""
                    SetVizData "0196",1 ,"int",""
                    SetVizData "0197",1  ,"int",""
                    SetVizDataUpper "0210",st  ,"string","Zeile 1"
                    SetVizDataUpper "0212",st2  ,"string","Zeile 2"
                    SetVizData "0211",tag     ,"string","Tag 1"
                    SetVizData "0213",tag2    ,"string","Tag 2"
                case 3
                    SetVizData "0190",2 ,"int",""
                    SetVizData "0220",Data.Item("SUBLINE1") ,"string","Zeile 1"
                    SetVizData "0222",Data.Item("SUBLINE2") ,"string","Zeile 2"
                case 4
                    st= Data.Item("SUBLINE1")
                    if instr(st,"/")>0 then
                        tag= split(st,"/")(1)
                        st= trim(split(st,"/")(0))
                        if st<>"" then st=st&"/"
                    end if
                    st2= Data.Item("SUBLINE2")
                    if instr(st2,"/")>0 then
                        tag2= split(st2,"/")(1)
                        st2= trim(split(st2,"/")(0))
                        if st2<>"" then st2=st2&"/"
                    end if
                    SetVizData "0190",1  ,"int",""
                    SetVizData "0195",3  ,"int",""
                    SetVizData "0196",3  ,"int",""
                    SetVizData "0197",3         ,"int",""
                    SetVizDataUpper "0210",st   ,"string","Zeile 1"
                    SetVizDataUpper "0212",st2  ,"string","Zeile 2"
                    SetVizData "0211",tag      ,"string","Tag 1"
                    SetVizData "0213",tag2      ,"string","Tag 2"
            end select


            GetPreviewWF "Default",p, sScene        ' ACHTUNG!!!!!
            Redim ActionList(2, 1)
            ActionList(1, 0) = "Default"
            ActionList(1, 1) = "Default"
            ActionList(2, 1) = efPlay

            PAGE_IDX = 1
        else
            if PAGE_IDX mod 2 then
                SetVizDataUpper "0202",Data.Item("SUBLINE1")  ,"string","Zeile 1"
                SetVizDataUpper "0302",Data.Item("SUBLINE2") ,"string","Zeile 2"
                SetVizDataUpper "0201",Data.Item("SUBLINE1")  ,"string","Zeile 1"
                SetVizDataUpper "0301",Data.Item("SUBLINE2")  ,"string","Zeile 2"
                GetPreview "Default 2.78", "WECHSEL 1.0", sScene
                Redim ActionList(2, 1)
                ActionList(1, 0) = "Default"
                ActionList(1, 1) = "WECHSEL"
                ActionList(2, 1) = efPlay
            else
                SetVizDataUpper "0202",Data.Item("SUBLINE1")  ,"string","Zeile 1"
                SetVizDataUpper "0302",Data.Item("SUBLINE2") ,"string","Zeile 2"
                SetVizDataUpper "0204",Data.Item("SUBLINE1")  ,"string","Zeile 1"
                SetVizDataUpper "0304",Data.Item("SUBLINE2")   ,"string","Zeile 2"
                GetPreview "Default 2.0", "WECHSEL 2.0", sScene
                Redim ActionList(2, 1)
                ActionList(1, 0) = "Default"
                ActionList(1, 1) = "WECHSEL"
                ActionList(2, 1) = efContinue
            end if
            PAGE_IDX = PAGE_IDX + 1
        end if
    end sub

    public sub Trenner(byVal anim)
        select case anim
            case 1  sScene = "VB_KK_Trenner_Admiral_HD"
            case 2  sScene = "VB_KK_Trenner_Austria_HD"
            case 3  sScene = "VB_KK_Trenner_Austria_2_HD"
            case 4  sScene = "VB_KK_Trenner_Austria_3_HD"
            case 5  sScene = "VB_KK_Trenner_Beukeler"
            case else exit sub
        end select

        obj__TV.OpenProject s__VizPath
        obj__TV.RendererUpdate false
        obj__TV.SendCommandEx("POOLS CLEANUP")
        obj__TV.SetScene sScene
        obj__TV.SendCommandEx("RENDERER*FRONT_LAYER SET_OBJECT SCENE*" & s__VizPath & "/" & sScene)
        obj__TV.SendCommandEx("RENDERER*FRONT_LAYER*NAME GET")
        Prepare_Layer 1
        obj__TV.RendererUpdate true

        obj__TV.DoEffect elFrontLayer, "Default", efPlay
        cc.SF.wait 1000
        obj__TV.DoEffect elMainLayer, "ALL", efReset   ' Ich mach mal ne Art Clear All auf den MainLayer
        s__LastAnim = ""
        ReDim ActionList(1, 0)
        ActionList(0, 0) = ""
        SetIniOption "LAST_SCENE", s__LastAnim
    end sub

    public sub Hashtag(ByVal typ, ByVal bLinks)
        sScene = "CB_Hashtag"
        LoadScene elMainLayer, sScene
        dim side

        if bLinks then
            SetVizData "0002",0 ,"int","Position"
        else
            SetVizData "0002",1 ,"int","Position"
        end if

        if typ=0 then
            SetVizData "1100","#SkyTuT","string","Hashtag"
        elseif typ=1 then
            SetVizData "1100","#SkyBuliAT" ,"string","Hashtag"
        else
            SetVizData "1100","#SkyGoEL","string","Hashtag"
        end if

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Watermark
        if pg_settings.cb_watermark.Checked then
            obj__TV.SendCommandEx("RENDERER*BACK_LAYER SET_OBJECT SCENE*" & s__VizPath & "/Wasserzeichen")
            obj__TV.DoEffect elBackLayer, "Default", efPlay
        else
            obj__TV.SendCommandEx("RENDERER*BACK_LAYER SET_OBJECT")
        end if
    end sub

    public sub BB_Crawl(title, msg, logo, bLoop, speed)
        if not i_variant=1 then exit sub
        dim strCmd
        if trim(title) <> "" then
            sScene    = "BB_Crawl_2z_Neutral"
        else
            sScene    = "BB_Crawl_1z_Neutral"
        end if
        LoadScene elMainLayer, sScene
        SetShow
        SetTLogo LCase(logo)
        SetTitle title

        strCmd    = "SCENE*" & s__VizPath & "/" & sScene & "*TREE*$txt_Crawl"
        obj__TV.SetCrawl "txt_Crawl", crClear,  ""
        if trim(title) <> "" then
            obj__TV.SetCrawl "txt_Crawl", crScript, "<SET Scaling 27>" & msg
        else
            obj__TV.SetCrawl "txt_Crawl", crScript, "<SET Scaling 35>" & msg
        end if
        obj__TV.SetCrawl "txt_Crawl", crReset, ""
        obj__TV.SendCommand strCmd & "*GEOM*loopmode SET " & -CInt(bLoop) ' Micha, das "Minus" hat einen Grund!   ;-)
        obj__TV.SendCommand strCmd & "*GEOM*time SET " & speed

        GetPreview "Default", "2.0", sScene ' Preview von Crawl scheint nicht zu gehen
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

     public sub BB_LineupCrawl(byRef Data)
     'if getGFXV =2 then
        if Data.Item("ISWF")= true then
            BB_LineupCrawl_WF Data
            exit sub
        end if
        dim i
        sScene = "BB_Aufstellungscrawl"
        if Data.Item("FOTO") = true then
            sScene = "BB_Fotocrawl"
        end if
        LoadScene elMainLayer, sScene
        SetShow
        SetTitle Data.Item("TNAME")
        SetTitleSubLine Data.Item("TRAINER")
        SetTLogo LCase(Data.Item("LOGO"))
         dim ids: ids=1100
        for i = 1 to 11
            SetVizData ids+1,Data.Item("BIB"  & i),"string","Player Number"
            SetVizData ids+2,Data.Item("NAME" & i) ,"string","Player Name"
            SetVizData ids+3, GetString(Data.Item("TEXT" & i), i__TVLanguage) ,"string","Player Position"
            if Data.Item("FOTO") = true then
                SetPlayerHS ids,LCase(Data.Item("LOGO")),Data.Item("BIB"  & i),"Player HS"
            end if

            if  Data.Item("HL"  & i) then
                obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$img_Showcolor*TEXTURE*POSITION SET -10.0 5.5"
                obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$txt_Number*MATERIAL*COLOR SET 1.0 1.0 1.0"
                'SetVizData "LUCRAWL"&i,"true","special"
            else
               obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$img_Showcolor*TEXTURE*POSITION SET 500.0 5.5"
               obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$txt_Number*MATERIAL*COLOR SET 0.0 0.0 0.0"
               'SetVizData "LUCRAWL"&i,"false","special"
            end if
            ids=ids+100
        next
        SetVizData "0005",Data.Item("ITEMCOUNT"),"int","Count"

        GetPreview "Default 2.0", "CRAWL 1.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub BB_LineupCrawl_WF(byRef Data)
        dim i   ,zero
        sScene = "BB_Aufstellungscrawl"
        if Data.Item("FOTO") = true then
            sScene = "BB_FotoAufstellungscrawl"
        end if
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff"BB Lineupcrawl"
        SetTitle ucase(Data.Item("TNAME") )
        SetTitleSubLine ucase(Data.Item("TRAINER") )
        SetTLogo LCase(Data.Item("LOGO"))
        dim ids: ids=110
        for i = 1 to 11
            if ids<1000 then
                zero="0"
            else
                zero=""
            end if
           SetVizData zero&(ids+0),Data.Item("BIB"  & i) ,"string","Player Number"
            SetVizDataUpper zero&(ids+10),Data.Item("NAME" & i) ,"string","Player Name"
            SetVizData zero&(ids+20), GetString(Data.Item("TEXT" & i), i__TVLanguage) ,"string","Player Position"
            if Data.Item("FOTO") = true then
                SetPlayerHS zero&(ids-5),LCase(Data.Item("LOGO")),Data.Item("BIB"  & i),"Player HS"
            end if
            if  Data.Item("HL"  & i) then
               SetVizData zero&(ids-10),1 ,"int","HL On/Off"
            else
                SetVizData zero&(ids-10),0,"int","HL On/Off"
            end if
            'if  Data.Item("HL"  & i) then
            '    obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$img_Showcolor*TEXTURE*POSITION SET -10.0 5.5"
            '    obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$txt_Number*MATERIAL*COLOR SET 1.0 1.0 1.0"
            'else
            '   obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$img_Showcolor*TEXTURE*POSITION SET 500.0 5.5"
            '   obj__TV.SendCommand "RENDERER*MAIN_LAYER*TREE*$ANIM_CRAWL$"&i&"$txt_Number*MATERIAL*COLOR SET 0.0 0.0 0.0"
            'end if
            ids=ids+100
        next
        SetVizData "0002",Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreviewWF "Default 1.98", "CRAWL 5.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_LineupNum(byRef Data)
        if getGFXV =2 then
            VB_LineupNum_WF Data
            exit sub
        end if

    end sub

    public sub VB_LineupNum_WF(byRef Data)
        dim i
        sScene = "VB_Numm_Aufstellung"

        LoadSceneWF elMainLayer, sScene
        SetBGOnOffWF
        SetCommercialOnOff "VB Lineup Num"
        SetVizDataUpper "0100","Aufstellung" ,"string","Title"
        SetVizData "0110","" ,"string",""
        SetVizDataUpper "0094",Data.Item("TNAMES") ,"string","Team Name"
        SetVizdata "0095","" ,"string",""
        SetTeamLogo "0090",  LCase(Data.Item("LOGO")),"Team Logo"
        SetVizDataUpper "0098",Data.Item("TNAMES2") ,"string","Team 2 Name"
        SetVizdata "0099","" ,"string",""
        SetTeamLogo  "0096",LCase(Data.Item("LOGO2")),"Team 2 Logo"


        dim ids: ids=1110
        for i = 1 to 22
            SetVizData ids,Data.Item("BIB"  & i) ,"string","Player Number"
            SetVizDataUpper ids+1,Trim(Data.Item("FNAME" & i)& " "&Data.Item("NAME" & i)) ,"string","Player Name"

            ids=ids+100
        next

        GetPreviewWF "Default", "3.14", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub BB_LineupCrawlSmall(byRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "Crawl_Aufstellungen"

        LoadScene elMainLayer, sScene

        SetShow
        SetVizData "4100", "Aufstellung "&Data.Item("TNAME"),"string","Team Name"
        SetVizData "4101", Data.Item("TNAME") ,"string","TEam Name"
        SetVizData "4200", "Aufstellung "&Data.Item("TNAME2")  ,"string","Team 2 Name"
        SetVizData "4201", Data.Item("TNAME2") ,"string","Team 2 Name"
        if tw_Layout.layout.ItemIndex = 0 then
            if CURRENT_LEAGUE = "119" then
                SetVizData "9000","tipico Bundesliga" ,"string","Title"
            else
                SetVizData "9000","","string","Title" '"sky Go Erste Liga","string"
            end if
        elseif tw_Layout.layout.ItemIndex =1 then
            SetVizData "9000","Champions League" ,"string","Title"
        elseif tw_Layout.layout.ItemIndex =2 then
            SetVizData "9000","Europa League" ,"string","Title"
        else
            SetVizData "9000","Talk und Tore" ,"string","Title"
        end if

        strCmd    = "SCENE*" & s__VizPath & "/" & sScene & "*TREE*$txt_Crawl_Aufstellung_1"
        'obj__TV.SendCommand strCmd & "*GEOM*clear INVOKE"
        obj__TV.SendCommand strCmd & "*GEOM*text SET "&Data.Item("TEXT")
        obj__TV.SendCommand strCmd & "*GEOM*build INVOKE"
        obj__TV.SendCommand strCmd & "*GEOM*reset INVOKE"

        strCmd    = "SCENE*" & s__VizPath & "/" & sScene & "*TREE*$txt_Crawl_Aufstellung_2"
        'obj__TV.SendCommand strCmd & "*GEOM*clear INVOKE"
        obj__TV.SendCommand strCmd & "*GEOM*text SET "&Data.Item("TEXT2")
        obj__TV.SendCommand strCmd & "*GEOM*build INVOKE"
        obj__TV.SendCommand strCmd & "*GEOM*reset INVOKE"

        obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE SHOW 0.0"
        GetPreview "Default", "0.6", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub


    public sub AdmiralCrawl(msg)
        sScene = "ADMIRAL-Crawl"
        LoadScene elMainLayer, sScene
        SetText "txt_Wetten", msg
        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Vartafel(scene)
'        ClearAll
        CC.SF.ShowSplashForm "VIZ is loading scene " & sScene & " ... ", clYellow
        obj__TV.OpenProject s__VartafelPath
        obj__TV.RendererUpdate false
        obj__TV.SendCommandEx("POOLS CLEANUP")
        obj__TV.SetScene scene
        obj__TV.SendCommandEx("RENDERER*MAIN_LAYER SET_OBJECT SCENE*" & s__VartafelPath & "/" & scene)
        obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*NAME GET")
        Prepare_Layer elMainLayer
        obj__TV.RendererUpdate true
        CC.SF.HideSplashForm
        obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VartafelPath & "/" & scene & " VIDEO Default 1.8"
        'If tw_preview.Visible Then
           call obj__TV.GetPreview("Default", "1.8", 1, "C:\Preview.jpg")
           tw_preview.img_preview.LoadFromFile "C:\Preview.jpg"
        'end If

        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub SkyScraper(name1, name2, quoten, LFrame)
        if LFrame then
            sScene = "Lframe_Admiral_key"
        else
            sScene = "ASW_Skyscraper"
        end if
        LoadScene elMainLayer, sScene
        SetText "txt_TeamHeim", UCase(name1)
        SetText "txt_TeamGast", UCase(name2)
        if LFrame then
            SetText "txt_Quote_1", quoten(0)
            SetText "txt_Quote_2", quoten(1)
            SetText "txt_Quote_3", quoten(2)
        else
            SetText "txt_Quote_1", quoten(0)
            SetText "txt_Quote_X", quoten(1)
            SetText "txt_Quote_2", quoten(2)
        end if
        GetPreview "Default", "0.3", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub AdmiralInsert()
        'sScene = "ADMIRAL-Insert"
        sScene = "Live_Insert_Admiral"
        LoadScene elMainLayer, sScene
        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Kurier_SS(nr)
        sScene = "Skyscraper_Kurier"
        LoadScene elMainLayer, sScene
        obj__TV.SendCommand "SCENE*" & s__VizPath & "/" & sScene & "*TREE*$MOTIV_SELECT*FUNCTION*Omo*vis_con SET " & nr - 1
        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub FreeGfx(gfx)
        if not i_variant=1 then exit sub
        sScene =gfx
        LoadScene elMainLayer, sScene
        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub SkyButton()
        sScene = "BB_Sky_at_Button"
        LoadScene elMainLayer, sScene
        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub FBButton()
        if not i_variant=1 then exit sub
        sScene = "Facebook_Aufruf"
        LoadScene elMainLayer, sScene
        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub FB_BB(head, subline)
        if not i_variant=1 then exit sub
        sScene = "BB_Facebook"
        LoadScene elMainLayer, sScene
        SetText "txt_Zeile_1", head
        SetText "txt_Zeile_2", subline
        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub SkyMediathek()
        sScene = "BB_Sky_at_Videos_BL"
        LoadScene elMainLayer, sScene
        GetPreview "Default", "2.4", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_Social(head, subline,subline2)
        if not i_variant=1 then exit sub
        sScene = "BB_Facebook_Twitter"
        LoadScene elMainLayer, sScene
        SetShow
        SetVizData "0110",head ,"string","Headline"
        SetVizData "0120",head ,"string","Headline"
        SetVizData "0210",subline ,"string","Subline"
        SetVizData "0220",subline2 ,"string","Subline 2"
        
        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_Comment(name, foto,sl,fname)
        if not i_variant=1 then exit sub
        sScene = "BB_2z_Neutral"
        LoadScene elMainLayer, sScene
       SetShow
       SetPFirstName fname

        SetPLastName name


        SetVizData "0200",sl ,"string","Subline"
        SetVizData "0190",0 ,"int",""
        SetVizData "0195",0 ,"int",""


        if foto <> "" then
            SetMHS foto,""
         else
            SetPHSOff
         end if

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_Comment2(name, foto,sl,name2, foto2,sl2,fname,fname2)
        if not i_variant=1 then exit sub
        sScene = "BB_Kommentatoren"

        LoadScene elMainLayer, sScene
        SetShow
        SetPFirstName fname
        SetPFirstName2 fname2
        SetPLastName name
        SetPLastName2 name2
        
        SetVizData "0200",sl ,"string","Subline"
        SetVizData "0205",sl2 ,"string","Subline 2"

        if foto <> "" then
            SetMHS foto,foto2
         else
            SetPHSOff
         end if


        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub MatchBB(ByRef Data)
        if not i_variant=1 then exit sub
        if (Len(Data.Item("NAME1")) > 17) or (Len(Data.Item("NAME2")) > 17) then
            sScene = "BB_Opening_breit"
        else
            sScene = "BB_Opening"
        end if
        LoadScene elMainLayer, sScene

        SetText "txt_TeamHeim", UCase(Data.Item("NAME1"))
        SetText "txt_TeamGast", UCase(Data.Item("NAME2"))
        SetText "txt_Zeile_2",  UCase(GetString("ABSCHNITT_" & Data.Item("ROUND"), i__TVLanguage))
        SetImg  "img_LogoHeim", s__LogoPath & "\" & LCase(Data.Item("LOGO1"))
        SetImg  "img_LogoGast", s__LogoPath & "\" & LCase(Data.Item("LOGO2"))

        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_Wechsel(ByRef Data)
        if getGFXV =2 then
            BB_Wechsel_WF Data
            exit sub
        end if
        if Data.Item("DOPPEL") = true then
            sScene = "BB_Wechsel_2_Players"
        else
            sScene = "BB_Wechsel_1_Player"
        end if
        LoadScene elMainLayer, sScene
        SetShow
        SetTName Data.Item("TEAMNAME")
        SetVizData "1100",Data.Item("P_NR_OUT") ,"string","Player Out Number"
        SetVizData "1101" ,Data.Item("P_LNAME_OUT") ,"string","Player Out Name"
        SetVizData "1102","" ,"string",""
        SetVizData "1200",Data.Item("P_NR_IN") ,"string","Player In Number"
        SetVizData "1201" ,Data.Item("P_LNAME_IN") ,"string","Player In Name"

        SetTLogo Data.Item("LOGO")
        if Data.Item("DOPPEL") = true then
            SetVizData "1103",Data.Item("P_NR_OUT2") ,"string","Player 2 Out Number"
            SetVizData "1104" ,Data.Item("P_LNAME_OUT2"),"string","Player 2 Out Name"
            SetVizData "1105",""  ,"string",""
            SetVizData "1203",Data.Item("P_NR_IN2")  ,"string","Player 2 In Number"
            SetVizData "1204" ,Data.Item("P_LNAME_IN2") ,"string","Player 2 In Name"
        end if


        GetPreview "Default 2.0", "L1 2.0 L2 2.0", sScene
        Redim ActionList(2, 2)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
        ActionList(1, 2) = "CHANGE"
        ActionList(2, 2) = efReset
    end sub
    
    public sub BB_Wechsel_WF(ByRef Data)
        if Data.Item("DOPPEL") = true then
            sScene = "BB_Spielerwechsel_Doppel"
        else
            sScene = "BB_Spielerwechsel_Einzel"
        end if
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff "BB Wechsel"
        'SetTName Data.Item("TEAMNAME")
        SetVizData "0100",Data.Item("P_NR_OUT") ,"string","Player Out Number"
        SetVizData "0102" ,UCase(Data.Item("P_LNAME_OUT") ),"string","Player Out Name"
        SetVizData "0200",Data.Item("P_NR_IN"),"string","Player In Number"
        SetVizData "0202" ,UCase(Data.Item("P_LNAME_IN")) ,"string","Player In Name"

        SetTLogo Data.Item("LOGO")

        if Data.Item("DOPPEL") = true then
            SetTLogo2_WF Data.Item("LOGO2")
            SetVizData "0300",Data.Item("P_NR_OUT2") ,"string","Player Out Number"
            SetVizData "0302" ,UCase(Data.Item("P_LNAME_OUT2") ),"string","Player Out Name"
            SetVizData "0400",Data.Item("P_NR_IN2") ,"string","Player In Number"
            SetVizData "0402" ,UCase(Data.Item("P_LNAME_IN2")   ) ,"string","Player In Name"
        end if


        GetPreviewWF "Default", "1.74", sScene
        Redim ActionList(2, 2)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub DSS_Wechsel_WF(ByRef Data)

        'SetTName Data.Item("TEAMNAME")
        SetVizDataFL "5005",Data.Item("P_NR_OUT") ,"string"
        SetVizDataUpperFL "5011" ,Data.Item("P_LNAME_OUT") ,"string"
        SetVizDataFL "5007",Data.Item("P_NR_IN") ,"string"
        SetVizDataUpperFL "5012" ,Data.Item("P_LNAME_IN") ,"string"

        sScene="DSS"
        GetPreviewWF "SPIELERWECHSEL", "2.52", sScene
    end sub

    Public Sub PageChange(ByRef Data)
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "CHANGE"
        ActionList(2, 1) = efPlay
        if getGFXV =2 then
            ActionList(1, 1) = "Default"
            ActionList(2, 1) = efContinue
        end if


    End Sub

    public sub vbStanding_HL(ByRef Data)
        dim i
        select case Data.Item("ANIM_TYPE")
            case 1,2,3,5
                for i = 1 to 5
                    if Data.Item("THL" & i) then
                        obj__TV.DoEffect elMainLayer, "H" & i, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                next
                for i = 1 to 10
                    if Data.Item("HL" & i) then
                        obj__TV.DoEffect elMainLayer, "T" & i, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                next
            case 4
                for i = 1 to 10
                    if Data.Item("HL" & i) then
                        obj__TV.DoEffect elMainLayer, "H" & i, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                next
        end select
    end sub
    
    public sub vbStanding_HL2(dir)
        obj__TV.DoEffect elMainLayer, dir, efPlay
    end sub

    public sub vbStanding20_HL(ByRef Data,side)
        dim i
        dim count,hcount
        count = Data.Item("ITEMCOUNTTAB")
        hcount=count
        if count>10 then
            page2=true
            hcount=Ceil(count/2.0)
        end if
        select case side
            case 1
                for i = 1 to hcount
                    if Data.Item("HL" & i) then
                        obj__TV.DoEffect elMainLayer, "H" & i, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                next
            case 2
                DIM k:k=10
                for i = hcount to hcount*2
                    if Data.Item("HL" & i) then
                        obj__TV.DoEffect elMainLayer, "H" & k, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                    k=k+1
                next
        end select
    end sub

    public sub vbStanding20_HL2(dir)
        obj__TV.DoEffect elMainLayer, dir, efPlay
    end sub

    public sub vbErg20_HL(ByRef Data,side)
        dim i
        dim count,hcount
        count = Data.Item("ITEMCOUNT")
        hcount=count
        if count>10 then
            page2=true
            hcount=Ceil(count/2.0)
        end if
        select case side
            case 1
                for i = 1 to hcount
                    if Data.Item("HL" & i) then
                        obj__TV.DoEffect elMainLayer, "H" & i, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                next
            case 2
                DIM k:k=10
                for i = hcount to hcount*2
                    if Data.Item("HL" & i) then
                        obj__TV.DoEffect elMainLayer, "H" & k, efPlay
                        CC.SF.Wait 100      ' SIEMIC:  Lieber ohne zeitlichen Versatz?
                    end if
                    k=k+1
                next
        end select
    end sub
    
    public sub vbErg20_HL2(dir)
        obj__TV.DoEffect elMainLayer, dir, efPlay
    end sub

    public sub vbStanding_Preview(ByRef Data)
        'GetPreview "Default",  "3.2", sScene
    end sub


    public sub VB_Standing(ByRef Data)
        if getGFXV =2 then
            VB_Standing_WF Data
            exit sub
        end if
        dim i, sCont
        dim showp
        dim isdiv:isdiv=true
        showp=false
        select case Data.Item("ANIM_TYPE")
            case 1  sScene = "VB_Erg"
            case 2  sScene = "VB_Erg6_Tab12"
            case 3  sScene = "VB_Tab_Erg"
            case 4  sScene = "VB_Tab_12"
            case 5  sScene = "VB_Erg3_Tab6"
            case 6
                sScene = "VB_Erg3_Tab6_M"
            case 7
                sScene = "VB_Erg3_Tab6_Q"
            case 8
                sScene = "VB_Tab_M"
            case 9
                sScene = "VB_Tab_Q"
        end select
        LoadScene elMainLayer, sScene
        if  Data.Item("ANIM_TYPE") = 1 then
            showp=true
        end if
        SetBGOnOff
        SetShow
        SetTitelDefaultHeader
        if Data.Item("ANIM_TYPE")= 5 then
            SetTitleLogo "el_logo_quer",true
        end if
        if Data.Item("ANIM_TYPE") <> 6 and Data.Item("ANIM_TYPE") <> 7 then
            SetTitle Data.item("OPT_TITLE")
            SetTitleSubLine Data.item("TITLE")
            SetDropLine ""
        end if

        if Data.Item("ANIM_TYPE") <> 4 and Data.Item("ANIM_TYPE") < 6  then
            dim ids : ids=1101
            for i = 1 to 6  ' DAILY RESULTS
               SetVizDataBufferOn
               SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_A"&i) ,"image","Logo 1 "&i
               SetVizData ids+1,Data.Item("NAME_A" & i) ,"string","Team Name 1 "&i

               SetVizData ids+3, Data.Item("RESULT" & i),"string","Result "&i

               SetVizData ids+5,Data.Item("NAME_B" & i) ,"string","Tem Name 2 "&i
               SetVizData ids+6,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_B"&i) ,"image","Logo 2 "&i
               SetVizDataBufferOff
               ids=ids+100
            next
            if Data.Item("ANIM_TYPE") =2 or Data.Item("ANIM_TYPE") =5 then
                SetVizData "0003",Data.Item("ITEMCOUNT"),"int","Count Erg"
            else
                SetVizData "0004",Data.Item("ITEMCOUNT") ,"int","Count Erg"
            end if

        end if


        if Data.Item("ANIM_TYPE") <> 1 and Data.Item("ANIM_TYPE") < 6  then
            ids =1100
            if Data.Item("ANIM_TYPE") =2 or Data.Item("ANIM_TYPE") =3 then ids=ids+1000
            if Data.Item("ANIM_TYPE") =4  then ids=ids+1000
            if Data.Item("ANIM_TYPE") =5  then ids=ids+400
            for i = 1 to 12   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData ids,Data.Item("PLACE" & i) ,"string","Place "&i
                SetVizData ids+1,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO"&i) ,"image","Logo "&i
                SetVizData ids+2,Data.Item("NAME" & i) ,"string","Team Name "&i
                SetVizData ids+3,Data.Item("GAMES" & i) ,"string","Games "&i
                SetVizData ids+4,Data.Item("GOALS" & i) ,"string","Goals "&i
                SetVizData ids+5,Data.Item("DIFF" & i)  ,"string","Diff "&i
                SetVizData ids+6,Data.Item("PTS" & i)   ,"string","Points "&i
                select case Data.Item("TREND" & i)
                    case "+"    SetVizData ids+9,1 ,"int" ,"Trend "&i
                    case ""     SetVizData ids+9,0 ,"int","Trend "&i
                    case "-"    SetVizData ids+9,2 ,"int","Trend "&i
                end select
                SetVizDataBufferOff
                ids=ids+100
              next

            SetVizData "0004",Data.Item("ITEMCOUNTTAB"),"int","Count Tab"

        end if
        
        if Data.Item("ANIM_TYPE") > 5 then
            ids =1100
            if Data.Item("ANIM_TYPE") =6 or Data.Item("ANIM_TYPE")=7 then ids=ids+400
            dim s,e,count
            count=1
            if  Data.Item("ANIM_TYPE") = 6  or Data.Item("ANIM_TYPE")=8 then
                s=1
                e=6
            else
                s=7
                e=12
            end if
            for i = s to e
                SetVizDataBufferOn
                SetVizData ids,count&".","string","Place "&i
                SetVizData ids+1,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO"&i) ,"image","Logo "&i
                SetVizData ids+2,Data.Item("NAME" & i) ,"string","Team Name "&i
                SetVizData ids+3,Data.Item("GAMES" & i) ,"string","Games "&i
                SetVizData ids+4,Data.Item("GOALS" & i) ,"string","Goals "&i
                SetVizData ids+5,Data.Item("DIFF" & i)  ,"string","Diff "&i
                if isdiv then
                    SetVizData ids+6,Data.Item("PTS" & i)  ,"string","Points "&i
                else
                SetVizData ids+6,Data.Item("PTSH" & i)  ,"string","Points "&i
                end if
                select case Data.Item("TREND" & i)
                    case "+"    SetVizData ids+9,1  ,"int","Trend "&i
                    case ""     SetVizData ids+9,0  ,"int","Trend "&i
                    case "-"    SetVizData ids+9,2  ,"int","Trend "&i
                end select
                SetVizDataBufferOff
                ids=ids+100
                count=count+1
              next
              if Data.Item("ANIM_TYPE") < 8 then
                if  Data.Item("ANIM_TYPE") = 6 then
                    s=1
                    e=3
                else
                    s=4
                    e=6
                end if
                ids=1101
                for i = s to e  ' DAILY RESULTS
                   SetVizDataBufferOn
                   SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_A"&i) ,"image","Logo 1 "&i
                   SetVizData ids+1,Data.Item("NAME_A" & i) ,"string","Team Name 1 "&i

                   SetVizData ids+3, Data.Item("RESULT" & i),"string","Result "&i

                   SetVizData ids+5,Data.Item("NAME_B" & i) ,"string","Tem Name 2 "&i
                   SetVizData ids+6,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_B"&i) ,"image","Logo 2 "&i
                   SetVizDataBufferOff
                   ids=ids+100
                next
                'SetTitle Data.item("OPT_TITLE")
                'SetTitleSubLine  ""
                'SetDropLine ""
                SetVizData "0500",Data.item("TITLE") ,"string","Subline"
                SetVizData "0003",3,"int","Count Erg"
            end if
        end if

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5 L11 3.5 L12 3.5", sScene
        Redim ActionList(2, 1)
        if (Data.Item("ANIM_TYPE") = 2) or (Data.Item("ANIM_TYPE") = 3) then
            ActionList(1, 0) = "ALL_OUT"
        else
            ActionList(1, 0) = "Default"
        end if
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay

'        if (Data.Item("ANIM_TYPE") = 2) or (Data.Item("ANIM_TYPE") = 3) then         ActionList(1, 0) = ""  ' Ich will verhindern das jemand die Doppelgrafik mit ClearALL versucht rauszunehmen
    end sub
    
    public sub VB_Standing_WF(ByRef Data)
        dim i, sCont
        dim showp
        showp=false
        dim dir
        dir=" "
        select case Data.Item("ANIM_TYPE")
            case 1
                sScene = "VB_ERG"
                dir= "Z1 3.0 Z2 3.0 Z3 3.0 Z4 3.0 Z5 3.0 Z6 3.0"
            case 2  sScene = "VB_Erg5_Tab10"
            case 3  sScene = "VB_Tab_Erg"
            case 4
                sScene = "VB_Tabelle"
                dir="TABELLE 3.0"
            case 6
                sScene = "VB_ERG_Tabelle_M"
            case 7
                sScene = "VB_ERG_Tabelle_Q"
        end select
        LoadSceneWF elMainLayer, sScene
        if  Data.Item("ANIM_TYPE") = 1 then
            showp=true
        end if
        SetBGOnOffWF
         SetCommercialOnOffManual true,"VB Erg Tab"
        if Data.Item("ANIM_TYPE")<6 then SetVizDataUpper "0100", Data.item("OPT_TITLE"),"string","Opt Title"
        SetVizDataUpper "0110",Data.item("TITLE"),"string","Title"


        if Data.Item("ANIM_TYPE") <> 4 and Data.Item("ANIM_TYPE")<6 then
            dim ids : ids=2000
            for i = 1 to 6  ' DAILY RESULTS
               SetVizDataBufferOn
               SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_A"&i) ,"image","Logo 1 "&i
               SetVizDataUpper ids+10,Data.Item("SNAME_A" & i) ,"string","Team Name 1 "&i
               SetVizData ids+13,0  ,"int",""
               SetVizData ids+15, Data.Item("RESULT" & i) ,"string","Result "&i

               SetVizDataUpper ids+20,Data.Item("SNAME_B" & i) ,"string","Team Name 2 "&i
               SetVizData ids+25,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_B"&i) ,"image","Logo 2 "&i
               SetVizDataBufferOff
               ids=ids+1000
            next
            if Data.Item("ANIM_TYPE") =2 or Data.Item("ANIM_TYPE") =5 then
                'SetVizData "0003",Data.Item("ITEMCOUNT")
            else
                'SetVizData "0004",Data.Item("ITEMCOUNT")
            end if

        end if


        if Data.Item("ANIM_TYPE") <> 1 and Data.Item("ANIM_TYPE")<6 then
            ids =2109
            if Data.Item("ANIM_TYPE") =2 or Data.Item("ANIM_TYPE") =3 then ids=ids+1000
            if Data.Item("ANIM_TYPE") =5  then ids=ids+400
            for i = 1 to 12   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO"&i)  ,"image","Logo "&i
                SetVizData ids+1,Data.Item("PLACE" & i) ,"string","Place "&i
                SetVizDataUpper ids+2,Data.Item("NAME" & i) ,"string","Name "&i
                SetVizData ids+3,Data.Item("GAMES" & i)  ,"string","Games "&i
                SetVizData ids+4,Data.Item("GOALS" & i)  ,"string","Goals "&i
                SetVizData ids+5,Data.Item("DIFF" & i)   ,"string","Diff "&i
                SetVizData ids+6,Data.Item("PTS" & i)    ,"string","Points "&i
                select case Data.Item("TREND" & i)
                    case "+"    SetVizData ids+9,1    ,"int","Trend "&i
                    case ""     SetVizData ids+9,0    ,"int","Trend "&i
                    case "-"    SetVizData ids+9,2    ,"int","Trend "&i
                end select
                SetVizDataBufferOff
                ids=ids+100
              next

        end if

        if Data.Item("ANIM_TYPE") = 6 or Data.Item("ANIM_TYPE") = 7 then
            ids =1100
            if isdiv  then ids=ids+400
            dim s,e,count
            count=1
            if  Data.Item("ANIM_TYPE") = 6 then
                s=1
                e=6
            else
                s=7
                e=12
            end if
            ids =2109
            if Data.Item("ANIM_TYPE") =2 or Data.Item("ANIM_TYPE") =3 then ids=ids+1000
            if Data.Item("ANIM_TYPE") =5  then ids=ids+400
            for i = s to e   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO"&i)  ,"image","Logo "&i
                SetVizData ids+1,Data.Item("PLACE" & i) ,"string","Place "&i
                SetVizDataUpper ids+2,Data.Item("NAME" & i) ,"string","Name "&i
                SetVizData ids+3,Data.Item("GAMES" & i)  ,"string","Games "&i
                SetVizData ids+4,Data.Item("GOALS" & i)  ,"string","Goals "&i
                SetVizData ids+5,Data.Item("DIFF" & i)   ,"string","Diff "&i
                SetVizData ids+6,Data.Item("PTS" & i)    ,"string","Points "&i
                select case Data.Item("TREND" & i)
                    case "+"    SetVizData ids+9,1    ,"int","Trend "&i
                    case ""     SetVizData ids+9,0    ,"int","Trend "&i
                    case "-"    SetVizData ids+9,2    ,"int","Trend "&i
                end select
                SetVizDataBufferOff
                ids=ids+100
              next
            if  Data.Item("ANIM_TYPE") = 6 then
                s=1
                e=3
            else
                s=4
                e=6
            end if

            ids=200
            for i = s to e  ' DAILY RESULTS
               SetVizDataBufferOn
               SetVizData "0"&ids+5,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_A"&i) ,"image","Logo 1 "&i
               SetVizDataUpper "0"&ids,Data.Item("SNAME_A" & i) ,"string","Team Name 1 "&i
               SetVizData "0"&ids+20,0  ,"int",""
               SetVizData "0"&ids+25, Data.Item("RESULT" & i) ,"string","Result "&i

               SetVizDataUpper "0"&ids+10,Data.Item("SNAME_B" & i) ,"string","Team Name 2 "&i
               SetVizData "0"&ids+15,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_B"&i) ,"image","Logo 2 "&i
               SetVizDataBufferOff
               ids=ids+100
            next
        end if



        GetPreviewWF "Default 3.1 ", dir, sScene
        Redim ActionList(2, 1)
        if (Data.Item("ANIM_TYPE") = 2) or (Data.Item("ANIM_TYPE") = 3) then
            ActionList(1, 0) = "ALL_OUT"
        else
            ActionList(1, 0) = "Default"
        end if
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay

'        if (Data.Item("ANIM_TYPE") = 2) or (Data.Item("ANIM_TYPE") = 3) then         ActionList(1, 0) = ""  ' Ich will verhindern das jemand die Doppelgrafik mit ClearALL versucht rauszunehmen
    end sub
    
    
    public sub VB_Standing20(ByRef Data)
        if not i_variant=1 then exit sub
        dim i, sCont
        dim count,hcount
        dim page2:page2=false
        showp=false
        sScene = "VB_Tab"
        LoadScene elMainLayer, sScene

        SetBGOnOff
        SetShow
        SetVizData "0085",0,"int",""

        SetTitle Data.item("OPT_TITLE"),"Opt Title"
        SetTitleSubLine Data.item("OPT_ZUSATZ"),"Opt Zusatz"
        SetDropLine ""
        count = Data.Item("ITEMCOUNTTAB")
        hcount=count
        if count>10 then
            page2=true
            hcount=Ceil(count/2.0)
        end if
        'cc.sf.DebugText "HC:" & hcount
            ids =1100
            for i = 1 to hcount   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                'cc.SF.DebugText Data.Item("PLACE" & i)& " - " & Data.Item("NAME" & i)
                SetVizData ids,Data.Item("PLACE" & i) ,"string","Place "&i
                SetVizData ids+1,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO"&i),"image","Logo "&i
                SetVizData ids+2,Data.Item("NAME" & i) ,"string","Name "&i
                SetVizData ids+3,Data.Item("GAMES" & i),"string","GameS "&i
                SetVizData ids+4,Data.Item("GOALS" & i) ,"string","Goals "&i
                SetVizData ids+5,Data.Item("DIFF" & i)  ,"string","Diff "&i
                SetVizData ids+6,Data.Item("PTS" & i)   ,"string","Points "&i
                SetVizData ids+8 ,0 ,"int",""
                select case Data.Item("TREND" & i)
                    case "+"    SetVizData ids+9,1   ,"int","Trend "&i
                    case ""     SetVizData ids+9,0   ,"int","Trend "&i
                    case "-"    SetVizData ids+9,2   ,"int","Trend "&i
                end select
                SetVizDataBufferOff
                ids=ids+100
              next

        ids =2100
            for i = hcount+1 to hcount*2   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData ids,Data.Item("PLACE" & i),"string","Place "&i
                SetVizData ids+1,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO"&i)  ,"image","Logo "&i
                SetVizData ids+2,Data.Item("NAME" & i)  ,"string","Name "&i
                SetVizData ids+3,Data.Item("GAMES" & i) ,"string","Gamse "&i
                SetVizData ids+4,Data.Item("GOALS" & i)  ,"string","Goals "&i
                SetVizData ids+5,Data.Item("DIFF" & i)  ,"string","Diff "&i
                SetVizData ids+6,Data.Item("PTS" & i)   ,"string","Points "&i
                SetVizData ids+8 ,0 ,"int",""
                select case Data.Item("TREND" & i)
                    case "+"    SetVizData ids+9,1  ,"int","Trend "&i
                    case ""     SetVizData ids+9,0  ,"int","Trend "&i
                    case "-"    SetVizData ids+9,2  ,"int","Trend "&i
                end select
                SetVizDataBufferOff
                ids=ids+100
              next
         SetVizData "0004",hcount ,"int","Count"

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5 L11 3.5 L12 3.5", sScene

        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"

        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_Erg20(ByRef Data)
        if not i_variant=1 then exit sub
        dim i, sCont
        dim count,hcount
        dim page2:page2=false
        showp=false
        sScene = "VB_Erg_20"
        LoadScene elMainLayer, sScene

        SetBGOnOff
        SetShow
        SetVizData "0085",0  ,"int",""

        SetTitle Data.item("OPT_TITLE")
        SetTitleSubLine Data.item("OPT_ZUSATZ")
        SetDropLine ""
        SetVizData "0500","" ,"string",""
        count = Data.Item("ITEMCOUNT")
        hcount=count
        if count>10 then
            page2=true
            hcount=Ceil(count/2.0)
        end if
        'cc.sf.DebugText "HC:" & hcount
            ids =1101
            for i = 1 to hcount   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
               SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_A"&i),"image","Logo 1 "&i
               SetVizData ids+1,Data.Item("NAME_A" & i) ,"string","Team Name 1 "&i

               SetVizData ids+3, Data.Item("RESULT" & i),"string","Result "&i

               SetVizData ids+5,Data.Item("NAME_B" & i),"string","Team Name 2 "&i
               SetVizData ids+6,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_B"&i) ,"image","Logo 2 "&i
               SetVizDataBufferOff
               ids=ids+100
              next

        ids =2101
            for i = hcount+1 to hcount*2   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
               SetVizData ids,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_A"&i) ,"image","Logo 1 "&i
               SetVizData ids+1,Data.Item("NAME_A" & i) ,"string","Team Name 1 "&i

               SetVizData ids+3, Data.Item("RESULT" & i),"string","Result "&i

               SetVizData ids+5,Data.Item("NAME_B" & i) ,"string","Team Name 2 "&i
               SetVizData ids+6,"IMAGE*"&s__LogoPath & "/" &Data.Item("LOGO_B"&i),"image","Logo 2 "&i
               SetVizDataBufferOff
               ids=ids+100
              next
         SetVizData "0004",hcount ,"int","Count"

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5", sScene

        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"

        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub


    public sub VB_Opening(ByRef Data)
    	if getGFXV =2 then
            VB_Opening_WF Data
            exit sub
        end if
        if trim(Data.Item("LOGO2")) = "" then
            sScene = "VB_Singlelogo"
        else
            sScene = "VB_Doppellogos"
        end if
        LoadScene elMainLayer, sScene
        SetShow
        SetBGOnOff
        SetTeamLogo "0060",LCase(Data.Item("LOGO1")),"Logo 1"
        SetTeamLogo "0070",LCase(Data.Item("LOGO2")),"Logo 2"

        if Trim(Data.Item("RESULT")) <> "" then
            SetVizData "0095",1 ,"int","Result On/Off"
            SetVizData "0100",Data.Item("RESULT")   ,"string","Result"
        else
            SetVizData "0095",0 ,"int","Result On/Off"
        end if

        GetPreview "Default", "2.5 ", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_Opening_WF(ByRef Data)

            sScene = "VB_MatchID"
        LoadSceneWF elMainLayer, sScene
        SetBGOnOffWF
        SetCommercialOnOffManual false, "VB Opening"
        SetTeamLogo "0100",LCase(Data.Item("LOGO1")),"Logo 1"
        SetTeamLogo "0200",LCase(Data.Item("LOGO2")),"Logo 2"

        if Trim(Data.Item("RESULT")) <> "" then
            SetVizData "0002",1 ,"int","Result On/Off"
            SetVizData "0300",Data.Item("RESULT") ,"string","Result"
        else
            SetVizData "0002",0  ,"int","Result On/Off"
            SetVizData "0300",""  ,"string","Result"
        end if

        GetPreviewWF "Default", "1.78", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

     public sub vbReserve(byRef Data)
        dim i
        sScene = "VB_Reservebaenke"
        LoadScene elMainLayer, sScene

        SetImg  "img_LogoHeim", s__LogoPath & "\" & LCase(Data.Item("LOGO_A"))
        SetImg  "img_LogoGast", s__LogoPath & "\" & LCase(Data.Item("LOGO_B"))
        SetText "txt_TeamHeim", UCase(Data.Item("NAME_A"))
        SetText "txt_TeamGast", UCase(Data.Item("NAME_B"))
        SetText "txt_Titel", UCase(GetString("RESERVEPLAYERS", i__TVLanguage))

        if Data.Item("BACKGROUND") then
            obj__TV.ShowObject "EINAUS_HINTERGRUND"
        else
            obj__TV.HideObject "EINAUS_HINTERGRUND"
        end if


        for i = 1 to Data.Item("ITEMCOUNT")
            SetText "ZEILE_" & i & "$TEAMHEIM$txt_Nr",      Data.Item("BIB_A"  & i)
            SetText "ZEILE_" & i & "$TEAMHEIM$txt_Spieler", UCase(Data.Item("NAME_A" & i))
            SetText "ZEILE_" & i & "$TEAMGAST$txt_Nr",      Data.Item("BIB_B"  & i)
            SetText "ZEILE_" & i & "$TEAMGAST$txt_Spieler", UCase(Data.Item("NAME_B" & i))
        next

        select case Data.Item("ITEMCOUNT")
            case 3      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.4"
            case 4      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.3"
            case 5      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.2"
            case 6      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.1"
            case 7      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.0"
        end select

        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub TVTipps(ByRef Data)
        dim i
        sScene = "BB_Sendehinweis_" & Data.Item("ITEMCOUNT") & "z"
        LoadScene elMainLayer, sScene

        SetText "ZEILE_1" & i & "$txt_Zeile_1", UCase(Data.Item("HEADER"))
        for i = 1 to Data.Item("ITEMCOUNT")
            SetText "ZEILE_" & 1+i & "$txt_Tag"    , UCase(Data.Item("DAY"  & i))
            SetText "ZEILE_" & 1+i & "$txt_Uhrzeit", UCase(Data.Item("TIME" & i))
            if Data.Item("LIVE" & i) then
                obj__TV.ShowObject "ZEILE_" & 1+i & "$EINHAUS_LIVE"
                obj__TV.HideObject "ZEILE_" & 1+i & "$EINHAUS_NORMAL"
                SetText "ZEILE_" & 1+i & "$EINHAUS_LIVE$txt_Info", UCase(Data.Item("EVENT" & i))
            else
                obj__TV.HideObject "ZEILE_" & 1+i & "$EINHAUS_LIVE"
                obj__TV.ShowObject "ZEILE_" & 1+i & "$EINHAUS_NORMAL"
                SetText "ZEILE_" & 1+i & "$EINHAUS_NORMAL$txt_Info", UCase(Data.Item("EVENT" & i))
            end if
        next

        GetPreview "Default", "1.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_Score(ByRef Data)
        if getGFXV =2 then
            BB_Score_WF Data
            exit sub
        end if
        dim i
        ' Wieviele TS

        sScene = "BB_Spielstand_2z"


        LoadScene elMainLayer, sScene
        SetShow
        SetTName Data.Item("NAME1")
        SetTName2 Data.Item("NAME2")
        SetTLogo LCase(Data.Item("LOGO1"))
        SetTLogo2 LCase(Data.Item("LOGO2"))
        
        SetVizData "0500",GetString("ABSCHNITT_" & Data.Item("ROUND"), i__TVLanguage) ,"string","Round"
        SetScore Data.Item("SCORE")
        dim c
        c= Data.Item("ITEMCOUNT")
        if c>2 then c=2
        SetVizData "0005",c ,"int","Count"
        
        dim ids
        ids=1110

        for i = 1 to (1+Data.Item("ITEMCOUNT"))
            SetVizData (ids) , Data.Item("NAME_A"& i),"string","Name A "&i
            SetVizData (ids+10) , Data.Item("NAME_B"& i),"string","Name B "&i
            SetVizData (ids+5) , Data.Item("MIN_A"& i)  ,"string","Min A "&i
            SetVizData (ids+15) , Data.Item("MIN_B"& i) ,"string","Min B "&i
            ids=ids+100
        next

        GetPreview "Default 2.0", "L1 2.0 L2 2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub BB_Score_WF(ByRef Data)
        dim i
        ' Wieviele TS
        dim c
        c= Data.Item("ITEMCOUNT")
        sScene = "BB_MatchID"
        if c>0 then
           sScene = "BB_Torschuetze"
        end if

        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOffManual true, "BB Score"
        SetVizData "0102",UCase(Data.Item("SNAME1")   ) ,"string","Team Name 1"
        SetVizData "0104",UCase(Data.Item("SNAME2") ) ,"string","Team Name 2"

        'SetTName  Data.Item("NAME1")
        'SetTName2 Data.Item("NAME2")


        SetTLogo LCase(Data.Item("LOGO1"))
        SetTLogo2_WF LCase(Data.Item("LOGO2"))

        SetVizData "0105",UCase(GetString("ABSCHNITT_" & Data.Item("ROUND"), i__TVLanguage) )  ,"string","Round"
        SetVizData "0103", Data.Item("SCORE") ,"string","Score"


        dim ids
        ids=110

        for i = 1 to (Data.Item("ITEMCOUNT"))
            if Data.Item("NAME_A"& i)<>"" then
                SetVizData "0"&(ids) ,UCase( Data.Item("NAME_A"& i) &" ("&Data.Item("MIN_A"& i)&")" ) ,"string","Name A "&i
            else
                SetVizData "0"&(ids),"" ,"string","Name A "&i
            end if
            if Data.Item("NAME_B"& i)<>"" then
                SetVizData "0"&(ids+100) ,UCase( Data.Item("NAME_B"& i) &" ("&Data.Item("MIN_B"& i)&")" )  ,"string","Name B "&i
            else
                SetVizData "0"&(ids+100),"" ,"string","Name B "&i
            end if
            ids=ids+5
        next
        for i = (1+Data.Item("ITEMCOUNT")) to 10
            SetVizData "0"&(ids) , "" ,"string","Name A "&i
            SetVizData "0"&(ids+100) , "" ,"string","Name B "&i
            ids=ids+5
        next
        
        if c<3 then
            SetVizData "0002",0   ,"int","Count Lines"
        elseif c<5 then
            SetVizData "0002",1   ,"int","Count Lines"
        elseif c<7 then
            SetVizData "0002",2   ,"int","Count Lines"
        elseif c<9 then
            SetVizData "0002",3   ,"int","Count Lines"
        else
            SetVizData "0002",4   ,"int","Count Lines"
        end if
        GetPreviewWF "Default 1.86", "TORE 1.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_Highlight(min, Name, info, logo1, logo2)
        if not i_variant=1 then exit sub
        if trim(Name) <> "" then
            if trim(info) <> "" then

            else
                sScene = "BB_Highlight_Info"
            end if
        else
            sScene = "BB_Highlight"
        end if
        sScene = "BB_Highlight_Info_2z"
        LoadScene elMainLayer, sScene
        SetShow
        
        p=Name
        pos=CC.Strings.StrPos(" ",p)
        if(pos>0 )then
            fn=Trim(Left(p,pos))
            n=Right(p,Len(p)-pos)
        else
            n=p
            fn=""
        end if
        SetPFirstName Name& " " &info
        SetPLastName ""

        'SetText "txt_Zeile_2", UCase(info)
        SetTeamLogo "0090",LCase(logo1),"Logo 1"
        SetTeamLogo "0190",LCase(logo2),"logo 2"
        SetVizData "0500",min ,"string","Freetext"

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
     public sub CB_Highlight(min, Name, info, logo1, logo2,rechts)
        if getGFXV =2 then
            CB_Highlight_WF min, Name, info, logo1, logo2,rechts
            exit sub
        end if
        sScene = "CB_Torschuetze"


        LoadScene elMainLayer, sScene
        SetShow
        'SetIBSide
        if rechts = true then
            SetVizData "0002",1 ,"int","Side"
        else
            SetVizData "0002",0  ,"int","Side"
        end if
        
        if instr(info,":")>0 then
            SetVizData "0004",1  ,"int",""
            SetVizData 1103,info  ,"string","Info"
            info=""
        else
            SetVizData "0004",0 ,"int",""
            if info <> "" then info= info& " - "
        end if

        p=Name
        pos=CC.Strings.StrPos(" ",p)
        if(pos>0 )then
            fn=Trim(Left(p,pos))
            n=Right(p,Len(p)-pos)
        else
            n=p
            fn=""
        end if
        SetVizData 1101,info&n ,"string","Info"
        dim min2
        min2=min
        if min <> "" then
            min2 = "(" &min & ")"
        end if
        SetVizData 1102, min2 ,"string","Min"

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub CB_Highlight_WF(min, Name, info, logo1, logo2,rechts)

        sScene = "CB_Highlight"


        LoadSceneWF elMainLayer, sScene
         SetCommercialOnOff "CB Highlight"
        if rechts = true then
            SetVizData "0002",1 ,"string","Side"
        else
            SetVizData "0002",0 ,"string","Side"
        end if

        SetVizData "0200",info  ,"string","Info"
        
        p=Name
        pos=CC.Strings.StrPos(" ",p)
        if(pos>0 )then
            fn=Trim(Left(p,pos))
            n=Right(p,Len(p)-pos)
        else
            n=p
            fn=""
        end if
        SetVizDataUpper "0100",Name ,"string","Name"

        SetVizDataUpper "0300", min ,"string","Min"

        GetPreviewWF "Default", "1.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub IB_Infobox(title, subline, subtitle2, subtitle3)
        if not i_variant=1 then exit sub
        sScene = "IB_Gleich_Livein"

        LoadScene elMainLayer, sScene
        SetShow
        SetIBSide
        SetVizData "0100",title   ,"string","Title"
        SetVizData "0200",subline  ,"string","Subline"
        SetVizData "0300",subtitle2 ,"string","Subtitle 1"
        SetVizData "0400",subtitle3 ,"string","Subtitle 2"
        GetPreview "Default", "3.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub FB_Frage_BB(text, text2)
        if not i_variant=1 then exit sub
        dim strCmd
        sScene = "Facebook_Fragenbox"
        LoadScene elMainLayer, sScene
        SetText "txt_Frage", UCase(text2)
        strCmd    = "SCENE*" & s__VizPath & "/" & sScene & "*TREE*$txt_Crawl"

        obj__TV.SetCrawl "txt_Crawl", crClear,  ""
        obj__TV.SetCrawl "txt_Crawl", crScript, text
        obj__TV.SetCrawl "txt_Crawl", crReset, ""
        obj__TV.SendCommand strCmd & "*GEOM*loopmode SET " & false

        GetPreview "Default 2.0", "LOOPS 1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Crawl_Social(text, hashtag, speed,logo)
        if not i_variant=1 then exit sub
        dim strCmd
        sScene = "Crawl_Livestrecke"
        LoadScene elMainLayer, sScene

        SetTitle hashtag
        setshow
        strCmd    = "SCENE*" & s__VizPath & "/" & sScene & "*TREE*$txt_Crawl"

        obj__TV.SetCrawl "txt_Crawl", crClear,  ""
        obj__TV.SetCrawl "txt_Crawl", crScript, text
        obj__TV.SetCrawl "txt_Crawl", crReset, ""
        obj__TV.SendCommand strCmd & "*GEOM*loopmode SET 1"
        obj__TV.SendCommand strCmd & "*GEOM*time SET " & speed
        SetVizData "0090","IMAGE*"&s__LogoPathDiv & "/" &logo ,"image","Logo"

        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub VB_IB_BB_FreeText(ByRef Data,msg)

		if getGFXV =2 then
            VB_IB_BB_FreeText_WF Data,msg
            exit sub
        end if
        dim t
        dim typ
        typ=Data.Item("typ")
        select case typ
            case 1
                sScene = "VB_Freetext_Zitat"
                t="3.5"
            case 2
                sScene = "IB_Freetext"
                t="3.0"
            case 3
                sScene = "BB_SM_Freetext_Lrg"
                t="2.0"
            case 4
                sScene = "BB_SM_Freetext_Lrg"
                t="2.0"
        end select
        dim ids
        dim title,subline,maxcount
        title=Data.Item("title")
        subline=Data.Item("subline")
        maxcount=Data.Item("maxcount")
        
        LoadScene elMainLayer, sScene
        SetShow

        SetTitle title    '100
        SetSubline subline '500

        if typ >2 then
            SetVizData "0195",typ-2 ,"int","Typ"
            SetVizData "0205" ,Data.Item("msg")  ,"string","Freetext"
            if maxcount <4 then
                SetVizData "0210",2 ,"int","Lines"
            elseif maxcount>4 then
                SetVizData "0210",0 ,"int","Lines"
            else
                SetVizData "0210",1 ,"int","Lines"
            end if
            '210
        elseif typ=2 then
            SetIBSide
            SetTitelDefaultHeader
            ids=1102
            for i=0 to maxcount-1
                SetVizData ids, msg.Strings(i) ,"string","Line "&i
                ids=ids+100
            next
            SetVizData "0004",maxcount,"int","Count"
        else
            SetBGOnOff
            SetTitleSubLine subline
            SetTitelDefaultHeader
            SetVizData "1100" ,Data.Item("msg") ,"string","Line"
            SetVizData "1101",""   ,"string",""
            SetVizData "1102",""   ,"string",""
            SetVizData "1103",""   ,"string",""
        end if

        GetPreview "Default", t, sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_IB_BB_FreeText_WF(ByRef Data,msg)

        dim t
        'select case typ
            'case 1
                sScene = "VB_Freetext"
                t="3.1"
            'case else
                'exit sub
        'end select
        dim ids
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff "VB Freetext"

        SetVizDataUpper "0100", Data.Item("title")  ,"string","Title"  '100
        SetVizDataUpper "0110", Data.Item("subline"),"string","Subline" '500

        SetBGOnOffWF
        dim maxcount
        maxcount=Data.Item("maxcount")
        ids=1111
            for i=0 to maxcount-1
                SetVizDataUpper ids, msg.Strings(i) ,"string","Line "&i
                ids=ids+1
            next
        'SetVizData "1111" ,Data.Item("msg")
        'SetVizData "1112",""
        'SetVizData "1113",""
        'SetVizData "1114",""
        
        SetPHSOff 'erstmal
        SetTLogo Data.Item("LOGO")
        
        SetVizData "1115",Data.Item("SUB1") ,"string","Subline 1"
        SetVizData "1116",Data.Item("SUB2") ,"string","Subline 2"
        

        GetPreviewWF "Default", t, sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub FB_FreeTable(ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "Facebook_Freetext_Tabelle"
        LoadScene elMainLayer, sScene
        SetText "txt_Titel", UCase(Data.Item("TITLE"))
        SetText "txt_Url",   Data.Item("SUBLINE")
        for i = 1 to 5
            SetText "INFO$ZEILE_" & i & "$txt_Rang", Data.Item("NR"   & i)
            SetText "INFO$ZEILE_" & i & "$txt_Team", UCase(Data.Item("TEXT" & i))
        next
        select case Data.Item("ITEMCOUNT")
            case 1      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.4"
            case 2      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.3"
            case 3      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.2"
            case 4      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.1"
            case 5      obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*POS SHOW 0.0"
        end select
        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

     public sub BB_Card(byRef Data)
         if getGFXV =2 then
            BB_Card_WF  Data
            exit sub
        end if
        sScene = "BB_2z_Logo"
        LoadScene elMainLayer, sScene
        SetShow
        SetTLogo LCase(Data.Item("LOGO"))
        SetPFirstName Data.Item("FNAME")
        SetPLastName Data.Item("NAME")
        SetPNummer Data.Item("NR")
        if Data.item("SHOWHS") and Data.Item("NR")<>"" then
            SetPHS LCase(Data.Item("LOGO")),Data.Item("NR")
        else
            SetPHSOff
        end if

        SetVizData "0200",Data.Item("SUBLINE") ,"string","Subline"
        SetVizData "0475", Data.Item("CARD_CODE") ,"int","Cardcode"

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub BB_Card_WF(byRef Data)
        if Data.item("SHOWHS") and Data.Item("NR")<>"" then
            sScene = "BB_2z_Foto"
        else
            sScene = "BB_2z_Karte"
        end if
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff "BB Karte"
        SetTLogo LCase(Data.Item("LOGO"))
        SetPFirstName UCase(Data.Item("FNAME"))
        SetPLastName UCase(Data.Item("NAME") )
        SetPNummer Data.Item("NR")
        if Data.item("SHOWHS") and Data.Item("NR")<>"" then
            SetPHS LCase(Data.Item("LOGO")),Data.Item("NR")
        else
            SetPHSOff
        end if

        SetVizData "0200",UCase(Data.Item("SUBLINE") )  ,"string","Subline"
        SetVizData "0004", 1 ,"int",""
        if Data.Item("CARD_CODE")=1 then
            ncc=0
        elseif Data.Item("CARD_CODE")=3 then
            ncc=1
        else
            ncc=2
        end if
        SetVizData "0094",""  ,"string",""
        SetVizData "0005", ncc ,"int","Cardcode"

        GetPreviewWF "Default", "2.78", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

     public sub Quiz_BB(byRef Data)
        if not i_variant=1 then exit sub
        sScene = "BB_Quiz"
        LoadScene elMainLayer, sScene

        SetText "txt_TelNr", Data.Item("PHONE")
        SetText "txt_Info", UCase(Data.Item("HINT"))
        SetText "txt_Frage", UCase(Data.Item("TEXT"))
        SetText "ANTWORT_1$txt_Antwort", UCase(Data.Item("CHOICE1"))
        SetText "ANTWORT_2$txt_Antwort", UCase(Data.Item("CHOICE2"))
        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

     public sub BB_Referee(Data)
         if getGFXV =2 then
            BB_Referee_WF Data
            exit sub
        end if
        sScene = "BB_Referees"
        LoadScene elMainLayer, sScene
        SetShow
        SetPLastName Data.Item("NAME")
        SetPFirstName Data.Item("FNAME")
        SetPNummer Data.Item("")
        SetVizData "0048",0  ,"int",""
        SetVizData "0090","IMAGE*"&s__LogoPathDiv & "/" &"whistle" ,"image","Logo"
        SetPHSOff

        SetVizData "0210",Data.Item("REF2")  ,"string","Ref 2"
        SetVizData "0310",Data.Item("REF3") ,"string","Ref 3"

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub BB_Referee_WF(Data)
        sScene = "BB_Schieri"
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOffManual false, "BB Schiedsrichter"
        SetPLastName UCase(Data.Item("NAME") )
        SetPFirstName UCase(Data.Item("FNAME"))
        SetPNummer Data.Item("")
        SetVizData "0048",0 ,"int",""
        SetVizData "0200",UCase("Schiedsrichter") ,"string",""'->erstmal
        SetVizData "0210",UCase(Data.Item("REF2")),"string","Ref 2"
        SetVizData "0220",UCase(Data.Item("REF3")),"string","Ref 3"
        SetVizData "0230",UCase(Data.Item("REF4") ),"string","Ref 4"
        GetPreviewWF "Default", "1.98", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub


    public sub VB_MegaFacts(ByRef Data)
        dim sCont, i
		if getGFXV =2 then
            VB_MegaFacts_WF Data
            exit sub
        end if
        sScene = "SVB_Megafacts"
        if Data.Item("HEADER_TYPE") =5 then sScene = "SVB_Megafacts_NoLogo"
        
        sScene=sScene &"_"& Data.Item("ITEMCOUNT")
        LoadScene elMainLayer, sScene
        SetShow
        SetBGOnOff
        SetTitelDefaultHeader
        SetTitle Data.Item("TITLE")
        SetTitleSubLine ""
        SetSubLine Data.Item("SUBTITLE")

        SetTeamLogo "0060", LCase(Data.Item("LOGO1")),"Logo 1"
        SetTeamLogo "0070", LCase(Data.Item("LOGO2")),"Logo 2"
        
        SetVizData "0063","IMAGE*"&s__PlayerFotoPath & "/" &LCase(Data.Item("FOTO")) ,"image","Player Photo 1"
        SetVizData "0073","IMAGE*"&s__PlayerFotoPath & "/" &LCase(Data.Item("FOTO2")),"image","Player Photo 2"

        select case  Data.Item("HEADER_TYPE")
            case 0
                SetVizData "0010",0,"int",""
                SetVizData "0050",0 ,"int",""
            case 1
                SetVizData "0010",0 ,"int",""
                SetVizData "0050",0 ,"int",""
            case 2
                SetVizData "0010",1 ,"int",""
                SetVizData "0050",0 ,"int",""
            case 3
                SetVizData "0010",0 ,"int",""
                SetVizData "0050",1 ,"int",""
            case 4
                SetVizData "0010",1 ,"int",""
                SetVizData "0050",1 ,"int",""
            case 5
                SetVizData "0010",1 ,"int",""
                SetVizData "0050",0 ,"int",""
        end select

        dim ids :ids=1111
        for i = 1 to 5
            SetVizData ids,Data.Item("TEXT1" & i) ,"string","Line 1 "&i
            SetVizData ids+1,Data.Item("TEXT2" & i) ,"string","Line 2 "&i
            ids=ids+100
        next
        if not Data.Item("HEADER_TYPE") =5 then SetVizData "0004",Data.Item("ITEMCOUNT"),"int","Count"


        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
     public sub VB_MegaFacts_WF(ByRef Data)
        dim sCont, i

        sScene = "VB_Megafacts"


        'sScene=sScene &"_"& Data.Item("ITEMCOUNT")
        LoadSceneWF elMainLayer, sScene

        SetBGOnOffWF
         SetCommercialOnOff "VB Megafacts"
        SetVizDataUpper "0100", Data.Item("TITLE"),"string","Title"
        SetVizDataUpper "0110",Data.Item("SUBTITLE") ,"string","Sub Title"

        SetTeamLogo "0090", LCase(Data.Item("LOGO1")),"Logo"

        if Data.Item("HEADER_TYPE")<>3 then
            SetPHSOff
        else
            SetPHS LCase(Data.Item("LOGO1")),Data.Item("FOTONR")
        end if


        dim ids :ids=1111
        for i = 1 to 6
            SetVizDataUpper ids,Data.Item("TEXT1" & i) ,"string","Line 1 "&i
            SetVizDataUpper ids+1,Data.Item("TEXT2" & i) ,"string","Line 2 "&i
            ids=ids+100
        next
        SetVizData "0004",Data.Item("ITEMCOUNT") ,"int","Count"


        GetPreviewWF "Default", "3.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub IB_MegaFacts(ByRef Data)
        if not i_variant=1 then exit sub
        dim sCont, i
        dim typ: typ= Data.Item("HEADER_TYPE")
        if  typ = 3 then
            sScene = "IB_Megafacts_Spieler"
        else
            sScene = "IB_Megafacts"
        end if
        LoadScene elMainLayer, sScene
        SetShow
        SetIBSide
        if typ = 5 then
            SetVizData "0085",0 ,"int","Logo On/Off"
        elseif typ=0 then
            SetVizData "0085",1 ,"int","Logo On/Off"
            SetTeamLogo "0090",LCase(Data.Item("LOGO1")),"Logo"
        elseif typ=1 then
            SetVizData "0085",1 ,"int","Logo On/Off"
            SetTeamLogo "0090",LCase(Data.Item("LOGO2")),"Logo"
        elseif typ=3 then
            SetTitelDefaultHeader
        end if

        SetTitle Data.Item("TITLE")
        SetSubLine Data.Item("SUBTITLE")

        if typ= 3  then
            'if typ=4 then
                SetTeamLogo "0610",LCase(Data.Item("LOGO1")),"Logo"
                SetPlayerHS "0600",LCase(Data.Item("LOGO1")),LCase(Data.Item("FOTO")),"Photo"
            'else
            '    SetTeamLogo "0610",LCase(Data.Item("LOGO2"))
            '    SetPlayerHS "0600",LCase(Data.Item("LOGO2")),LCase(Data.Item("FOTO"))
            'end if

        end if


            dim ids :ids=1102
            for i = 1 to 5
               SetVizData ids,Data.Item("TEXT1" & i) ,"string","Line 1 "&i
               SetVizData ids+1,Data.Item("TEXT2" & i) ,"string","Line 2 "&i
                ids=ids+100
            next
            if typ= 3 or typ=4 then
                if Data.Item("ITEMCOUNT")>4 then Data.Item("ITEMCOUNT")=4
            end if
            SetVizData "0004",Data.Item("ITEMCOUNT") ,"int","Count"



        GetPreview "Default 3.0", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub IB_Spieler(ByRef Data)
        if not i_variant=1 then exit sub
        dim sCont, i
        sScene = "IB_SpielerPortrait"
        LoadScene elMainLayer, sScene
        SetShow
        SetIBSide
        SetPLastName data.item("NAME")
        SetPFirstName data.item("FNAME")
        SetPlayerHS "0600", data.item("LOGO"),data.item("NR"),"Player HS"
        'SetPHS data.item("LOGO"),data.item("NR")
        SetSubLine Data.Item("TITLE")
        SetTitleLogo data.item("LOGO"),false
        dim ids:ids=1102
        for i = 1 to Data.Item("ITEMCOUNT")
                SetVizData ids, data.Item("TEXT" & i) ,"string","Line "&i
             ids=ids+100
        next
        if Data.Item("ITEMCOUNT")>3 then
            SetVizData "0004",Data.Item("ITEMCOUNT"),"int","Count"
        else
            SetVizData "0004",3 ,"int","Count"
        end if


        GetPreview "Default 3.0", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Torwand_Table(ByRef Data)
        dim i,k, obj
        sScene = "VB_Tut_Torwand"
        LoadScene elMainLayer, sScene
        SetText "$txt_Titel", UCase(Data.Item("TITLE"))

        for i = 1 to 5          ' Zeilen
            obj = "ZEILE_" & i
            if i <= Data.Item("ITEMCOUNT") then
                obj__TV.ShowObject obj
                SetText obj & "$txt_Team", UCase(Data.Item("NAME" & i))
                SetText obj & "$txt_Parameter", UCase(Data.Item("RESULT" & i))
                for k = 1 to 4  ' Bälle
                    obj__TV.HideObject obj & "$BALL_" & k & "$EINAUS_TREFFER"
                    obj__TV.HideObject obj & "$BALL_" & k & "$EINAUS_DANEBEN"
                    if Data.Item("BALL" & i & k) = 1 then obj__TV.ShowObject obj & "$BALL_" & k & "$EINAUS_TREFFER"
                    if Data.Item("BALL" & i & k) = 2 then obj__TV.ShowObject obj & "$BALL_" & k & "$EINAUS_DANEBEN"
                next
            else
                obj__TV.HideObject "$ZEILE_" & i
            end if
        next

        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Torwand_BB(ByRef Data)
        dim k
        if sScene <> "BB_TuT_Torwand" then      ' Ist die Szene schon geladen dann nur Ball Update machen
            sScene = "BB_TuT_Torwand"
            LoadScene elMainLayer, sScene
            Redim ActionList(2, 1)
            ActionList(1, 0) = "Default"
            ActionList(1, 1) = "Default"
            ActionList(2, 1) = efPlay
        else
            Redim ActionList(1, 0)
            ActionList(1, 0) = "Default"
        end if
        SetText "$txt_Zeile_1", UCase(GetString("TUT", i__TVLanguage))
        SetText "$txt_Zeile_2", UCase(Data.Item("NAME"))

        for k = 1 to 4  ' Bälle
            obj__TV.HideObject "$BALL_" & k & "$EINAUS_TREFFER"
            obj__TV.HideObject "$BALL_" & k & "$EINAUS_DANEBEN"
            if Data.Item("BALL" & k) = 1 then obj__TV.ShowObject "$BALL_" & k & "$EINAUS_TREFFER"
            if Data.Item("BALL" & k) = 2 then obj__TV.ShowObject "$BALL_" & k & "$EINAUS_DANEBEN"
        next

        GetPreview "Default", "1.8", sScene
    end sub

      Public Sub FP_TactLineup(ByRef Data)
 		if getGFXV =2 then
            FP_TactLineup_WF Data
            exit sub
        end if
        dim P_Nr,P_Name, x_Pos, y_Pos, ScenePosX, ScenePosY, Team, TeamId, i, LineupID
        sScene = "VB_takt_Aufstellung_Fussball"
        LoadScene elMainlayer, sScene
        SetBGOnOff
        SetShow
        dim LineupWidth : LineupWidth  = 860   '100-830
        dim LineupHeight: LineupHeight = 550    '125-525
        dim SceneWidth   : SceneWidth  = 490    '-250-250
        dim SceneHeight  : SceneHeight = 260    '-115-150
        dim startx:startx=-225
        dim starty:starty=-115
        Team = Data.Item("CURR_TEAM")
        If Team = "A" Then
            TeamId = 1
            LineupID = Lineup_A
        else
            TeamId = 2
            LineupID = Lineup_B
        end if
        SetVizData "0100",1 ,"int",""
        SetTeamLogo "0101",LCase(Data.Item("T_LOGO_"& TeamId)),"Team Logo 1"
        SetVizData "0111",Data.Item("T_LNAME_"& TeamId),"string","Team Name 1"
        SetVizData "0112",""  ,"string",""
        SetVizData "0120","" ,"string",""
        SetVizData "0120",GetString("Trainer", i__TVLanguage) & ": " & Data.Item("COACH" & TeamId)  ,"string","Coach 1"
        
        SetVizData "0200",1 ,"int",""
        SetTeamLogo "0201",LCase(Data.Item("T_LOGO_2")),"Team Logo 2"
        SetVizData "0211",Data.Item("T_LNAME_2") ,"string","Team Name 2"
        SetVizData "0212",""  ,"string",""
        SetVizData "0220","" ,"string",""
        SetVizData "0220",GetString("Trainer", i__TVLanguage) & ": " & Data.Item("COACHB") ,"string","Coach 2"

        SetVizData "6011",Data.Item("T_SNAME_1")&" - "&Data.Item("T_SNAME_2") ,"string","Team 2 Short"
        SetVizData "6012","" ,"string","" 'Data.Item("T_SNAME_2")


        dim ids:ids=1100
        For i = 1 to 11
            SetVizDataBufferOn
            P_Nr   = Trim(Lineup.GetPlayer(Lineup_Nr, i, LineupID))
            P_Name = (GetData(Team, P_Nr))
            x_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_X, i, LineupID),1,0,"",-1) - MakeNumber(Lineup.GetPlayer(Lineup_Nr_W, i, LineupID),1,0,"",-1)
            y_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_Y, i, LineupID),1,0,"",-1)  + 8 + MakeNumber(Lineup.GetPlayer(Lineup_Name_H, i, LineupID),1,0,"",-1)'Trim(Lineup.GetPlayer(Lineup_Name_Y, i))

            'cc.sf.DebugText i& " -" &P_Nr &" - "&P_Name
            o0= Formatnumber(x_Pos,1)
            p=(o0/LineupWidth)*SceneWidth
            o0=p+startx
            ScenePosX    = Replace(o0, ",", ".")
            o0= Formatnumber(y_Pos,1)-27
            p=(o0/LineupHeight)*SceneHeight
            o0=p+starty

            ScenePosY    = Replace(o0, ",", ".")
            'ScenePosX  = Replace(Formatnumber((x_Pos - 480) / (LineupWidth / SceneWidth), 1), ",", ".")
            'ScenePosY  = Replace(Formatnumber((y_Pos - 288) / (LineupHeight / SceneHeight), 1), ",", ".")

            SetVizData ids,P_nr ,"string","Player Number "&i
            SetVizData ids+2,P_Name ,"string","Player Name "&i
            SetVizData (ids+10)&".x1",ScenePosX  ,"double","PosX "&i
            SetVizData (ids+10)&".y1",ScenePosY  ,"double","PosY "&i
            ids=ids+100
            SetVizDataBufferOff
            if isPlayerHL(P_Nr,Team) = true then
                obj__TV.SendCommand "SCENE*" & s__VizPath & "/"&sScene&"*STAGE*DIRECTOR*$H"&i&" SHOW 0.7"
            end if
        Next
        ids=2200
        for i=1 to 7
            SetVizData ids,Data.Item("RBIB"&i) ,"string","Reserve Number "&i
            SetVizData ids+2,Data.Item("RNAME"&i) ,"string","Reserve Name "&i
            ids=ids+100
        next
        SetVizData 1005,Data.Item("ITEMCOUNT") ,"int","Count"
        SetPlayerHS 2901,LCase(Data.Item("T_LOGO_"& TeamId)),"00","Photo Coach"
        SetVizData 2902,"","string",""'Data.Item("COACH" & TeamId)
        'SetVizData 6011,""
        'SetVizData 6012,""
        SetVizData 1000, data.item("LIVEIN") ,"int","Live On/Off"
        GetPreview "Default 3.5", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0 L6 3.0 L7 3.0 L8 3.0 L9 3.0 L10 3.0 L11 3.0 SPIELERPOS_HEIM 0.0" ,sScene

        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    End Sub
    
    Public Sub FP_TactLineup_WF(ByRef Data)
        dim P_Nr,P_Name, x_Pos, y_Pos, ScenePosX, ScenePosY, Team, TeamId, i, LineupID
        sScene = "VB_takt_Aufstellung_Livein"
        if pg_settings.rb_opmode.ItemIndex=1 then  sScene=sScene&"_KONF"
        LoadSceneWF elMainlayer, sScene
        SetBGOnOffWF
        SetCommercialOnOffManual false, "Taktische Aufstellung"
        dim LineupWidth : LineupWidth  = 860   '100-830
        dim LineupHeight: LineupHeight = 550    '125-525
        dim SceneWidth   : SceneWidth  = 320    '-160-160
        dim SceneHeight  : SceneHeight = 175    '-90-100
        dim startx:startx=-160
        dim starty:starty=-85
        Team = Data.Item("CURR_TEAM")
        If Team = "A" Then
            TeamId = 1
            LineupID = Lineup_A
        else
            TeamId = 2
            LineupID = Lineup_B
        end if

        SetTeamLogo "0090",LCase(Data.Item("T_LOGO_"& TeamId)) ,"Logo"
        SetVizDataUpper "0100",Data.Item("T_LNAME_"& TeamId) ,"string","Team Name"
        SetVizData "0110","","string",""
        SetVizData "0092","0" ,"string",""
        'SetVizData "0120",GetString("Trainer", i__TVLanguage) & ": " & Data.Item("COACH" & TeamId)

        dim ids:ids=1100
        For i = 1 to 11
            SetVizDataBufferOn
            P_Nr   = Trim(Lineup.GetPlayer(Lineup_Nr, i, LineupID))
            P_Name = (GetData(Team, P_Nr))
            x_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_X, i, LineupID),1,0,"",-1) - MakeNumber(Lineup.GetPlayer(Lineup_Nr_W, i, LineupID),1,0,"",-1)
            y_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_Y, i, LineupID),1,0,"",-1)  + 8 + MakeNumber(Lineup.GetPlayer(Lineup_Name_H, i, LineupID),1,0,"",-1)'Trim(Lineup.GetPlayer(Lineup_Name_Y, i))

            'cc.sf.DebugText i& " -" &P_Nr &" - "&P_Name
            o0= Formatnumber(x_Pos,1)'-100
            p=(o0/LineupWidth)*SceneWidth
            o0=p+startx
            ScenePosX    = Replace(o0, ",", ".")
            o0= Formatnumber(y_Pos,1)-27
            p=(o0/LineupHeight)*SceneHeight
            o0=p+starty

            ScenePosY    = Replace(o0, ",", ".")
            'ScenePosX  = Replace(Formatnumber((x_Pos - 480) / (LineupWidth / SceneWidth), 1), ",", ".")
            'ScenePosY  = Replace(Formatnumber((y_Pos - 288) / (LineupHeight / SceneHeight), 1), ",", ".")

            SetVizData ids,P_nr ,"string","Player Number "&i
            SetVizData ids+5,0  ,"int",""
            SetVizDataUpper ids+10,P_Name ,"string","Player Name "&i
            SetVizData (ids+15),ScenePosX  ,"double","PosX "&i
            SetVizData (ids+20),ScenePosY  ,"double","PosY "&i
            
            ids=ids+100
            SetVizDataBufferOff
            if isPlayerHL(P_Nr,Team) = true then
                obj__TV.SendCommand "SCENE*" & s__VizPathWF & "/"&sScene&"*STAGE*DIRECTOR*$HL"&i&" SHOW 0.5"
            end if
        Next
        ids=3010
        for i=1 to 7
            'SetVizData ids,Data.Item("RBIB"&i)
            SetVizDataUpper ids,Data.Item("RBIB"&i)& " "&Data.Item("RNAME"&i),"string","Reserve "&i
            ids=ids+10
        next

        SetVizData "0002",0 ,"int",""
        if data.item("LIVEIN")=0 then
            SetVizData "0001",1  ,"int","Live In On/OFF"
            SetVizData "0008",0  ,"int","Live In On/OFF"
        end if
        GetPreviewWF "Default 2.78", "SPIELER 0.7" ,sScene

        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    End Sub
    
    public sub FP_TactLineupShowReserve()
        If obj__TV is Nothing Then Exit Sub
        obj__TV.DoEffect elMainLayer, "POS_ALL", efPlay
        obj__TV.DoEffect elMainLayer, "RESERVEBANK", efPlay

    end sub

    public sub FP_TactLineupShowReserveLI()
        obj__TV.DoEffect elMainLayer, "LIVEIN", efPlay
    end sub

    public sub FP_TactLineupHideReserveLI()
        obj__TV.DoEffect elMainLayer, "LIVEIN", efContinue
    end sub

    public sub FP_TactLineupHideReserve()
        If obj__TV is Nothing Then Exit Sub
        obj__TV.DoEffect elMainLayer, "POS_ALL", efContinue
        obj__TV.DoEffect elMainLayer, "RESERVEBANK", efContinue
        'if livein =0 then  obj__TV.DoEffect elMainLayer, "LIVEIN", efContinue
    end sub

    Public Sub FP_TactLineupLiveUpdate(ByRef Data)
    
        if getGFXV =2 then
            FP_TactLineupLiveUpdate_WF Data
            exit sub
        end if
        sScene = "VB_takt_Aufstellung_Fussball"
        dim LineupWidth : LineupWidth  = 860   '100-830
        dim LineupHeight: LineupHeight = 550    '125-525
        dim SceneWidth   : SceneWidth  = 490    '-250-250
        dim SceneHeight  : SceneHeight = 260    '-115-150
        dim startx:startx=-225
        dim starty:starty=-115

        dim o0,p
        o0= Formatnumber(Data.Item("myX"),1)'-100
        p=(o0/LineupWidth)*SceneWidth
        o0=p+startx
        dim ScenePosX   : ScenePosX    = Replace(o0, ",", ".")


        o0= Formatnumber(Data.Item("myY"),1)-27'-125
        p=(o0/LineupHeight)*SceneHeight
        o0=p+starty

        dim ScenePosY   : ScenePosY    = Replace(o0, ",", ".")
        Dim Team
        Team = UCASE(split(Lineup.ActiveLineup)(1))

        dim ids
        'if Team = "A" then
            ids=1000+(Data.Item("Curr")*100)
             SetVizData (ids+10)&".x1",ScenePosX ,"double",""
            SetVizData (ids+10)&".y1",ScenePosY  ,"double",""

            obj__TV.SendCommand "SCENE*" & s__VizPath & "/VB_takt_Aufstellung_Fussball*TREE*$SPIELER_HEIM$SPIELER_" & Data.Item("Curr") & "$POS*TRANSFORMATION*POSITION SET " & ScenePosX & " " & ScenePosY & " 0.0"

        'else
        '    ds=3000+(Data.Item("Curr")*100)
         '   SetVizData (ids+10)&".x1",ScenePosX
         '   SetVizData (ids+10)&".y1",ScenePosY
         '   obj__TV.SendCommand "SCENE*" & s__VizPath & "/VB_Lframe3070_Aufstellung*TREE*$SPIELER_GAST$SPIELER_" & Data.Item("Curr") & "$POS*TRANSFORMATION*POSITION SET " & ScenePosX & " " & ScenePosY & " 0.0"
        'end if
    End Sub
    
    Public Sub FP_TactLineupLiveUpdate_WF(ByRef Data)
        sScene = "VB_takt_Aufstellung_Livein"
        dim LineupWidth : LineupWidth  = 860   '100-830
        dim LineupHeight: LineupHeight = 550    '125-525
        dim SceneWidth   : SceneWidth  = 320    '-160-160
        dim SceneHeight  : SceneHeight = 175    '-90-100
        dim startx:startx=-160
        dim starty:starty=-85
        dim o0,p
        o0= Formatnumber(Data.Item("myX"),1)
        p=(o0/LineupWidth)*SceneWidth
        o0=p+startx
        dim ScenePosX   : ScenePosX    = Replace(o0, ",", ".")


        o0= Formatnumber(Data.Item("myY"),1)-27
        p=(o0/LineupHeight)*SceneHeight
        o0=p+starty

        dim ScenePosY   : ScenePosY    = Replace(o0, ",", ".")
        Dim Team
        Team = UCASE(split(Lineup.ActiveLineup)(1))

        dim ids

            ids=1000+(Data.Item("Curr")*100)

            SetVizData (ids+15),ScenePosX ,"double",""
            SetVizData (ids+20),ScenePosY ,"double",""
            'obj__TV.SendCommand "SCENE*" & s__VizPathWF & "/VB_takt_Aufstellung_Livein*TREE*$SPIELER_HEIM$SPIELER_" & Data.Item("Curr") & "$POS*TRANSFORMATION*POSITION SET " & ScenePosX & " " & ScenePosY & " 0.0"

    End Sub

    public sub VB_IB_RestProgramm(ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        if Data.Item("AS_INFOBOX") then
            sScene = "IB_Restprogramm"
        else
            sScene="VB_Restprogramm"
        end if

        LoadScene elMainLayer, sScene
        SetShow
        if Data.Item("AS_INFOBOX") then
            SetIBSide
        else
            SetBGOnOff
        end if
        SetTitle Data.Item("NAME")
        SetSubLine GetString("RESTPROGRAMM", i__TVLanguage)
        SetTitleLogo Data.Item("LOGO"),false
        dim ids:ids=1100
        for i = 1 to Data.Item("ITEMCOUNT")
            SetVizData ids,Data.Item("NR" & i),"string","Nr "&i
            SetTeamLogo ids+1,LCase(Data.Item("LOGO" & i)),"Logo "&i
            SetVizData ids+2, Data.Item("NAME" & i) ,"string","Name "&i
            if Data.Item("HOME" & i) then
                SetVizData ids+3,"(H)" ,"string","Where  "&i
            else
                SetVizData ids+3,"(A)" ,"string","Where  "&i
            end if

            ids=ids+100
        next


        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreview "Default 3.0", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0 L5 3.0 L6 3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub DSS_RestProgramm_Show(ByRef Data)
        'if getGFXV =2 then
            DSS_RestProgramm_Show_WF Data
        	exit sub
        'end if
        dim i
        SetVizDataFL "3001",GetString("RESTPROGRAMM", i__TVLanguage)&" "&Data.Item("NAME")

        dim ids : ids=3100
        for i = 1 to Data.Item("ITEMCOUNT")
            SetVizDataFL ids,Data.Item("NR" & i)
            SetVizDataFL ids+2,Data.Item("NAME" & i)
            if Data.Item("HOME" & i) then
                SetVizDataFL ids+3,"(H)"
            else
                SetVizDataFL ids+3,"(A)"
            end if
            ids=ids+100
        next
        SetVizDataFL "3000",Data.Item("ITEMCOUNT")
        
        GetPreview "RESTPROGRAMM 3.5 ", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 ", sScene
    end sub
    
    public sub DSS_RestProgramm_Show_WF(ByRef Data)
        dim i
        SetVizDataUpperFL "2001",GetString("RESTPROGRAMM", i__TVLanguage)&" "&Data.Item("NAME")

        dim ids : ids=2010
        for i = 1 to Data.Item("ITEMCOUNT")
            SetVizDataFL ids,Data.Item("NR" & i)
            SetVizDataUpperFL ids+1,Data.Item("NAME" & i)
            if Data.Item("HOME" & i) then
                SetVizDataFL ids+2,"(H)"
            else
                SetVizDataFL ids+2,"(A)"
            end if
            ids=ids+10
        next
        'SetVizDataFL "3000",Data.Item("ITEMCOUNT")
        sScene="DSS"
        GetPreviewWF "RESTPROGRAMM", "1.78", sScene
    end sub
    
    public sub DSS_Karte_Show(ByRef Data)
        if getGFXV =2 then
            DSS_Karte_Show_WF Data
        	exit sub
        end if

    end sub

    public sub DSS_Karte_Show_WF(ByRef Data)

        'SetPFirstName Data.Item("FNAME")
        SetVizDataFL "3011" ,Data.Item("NAME")
        SetVizDataFL "3010",Data.Item("NR")
        SetVizDataFL "3012",Data.Item("SUBLINE")
        if Data.Item("CARD_CODE")=1 then
            ncc=0
        elseif Data.Item("CARD_CODE")=3 then
            ncc=1
        else
            ncc=2
        end if
        SetVizDataFL "3005", ncc
        sScene="DSS"
        GetPreviewWF "KARTE", "3.5 ", sScene
    end sub
    
    public sub DSS_GoalScorer_Show(ByRef Data)
        if getGFXV =2 then
            DSS_GoalScorer_Show_WF Data
        	exit sub
        end if

    end sub

    public sub DSS_GoalScorer_Show_WF(ByRef Data)

        'SetPFirstName Data.Item("FNAME")
        SetVizDataUpperFL "4011" ,Data.Item("NAME")
        SetVizDataFL "4010",Data.Item("NR")
        SetVizDataUpperFL "4012",Data.Item("LINE1")
        SetPlayerHSFL "4006", Data.Item("LOGO"),Data.Item("NR")
        if  Data.Item("SHOWHS")=True then
            SetVizDataFL "4005",1
        else
            SetVizDataFL "4005",0
        end if
        sScene="DSS"
        GetPreviewWF "TORSCHUETZE", "2.54 ", sScene
    end sub


    public sub IB_BlitzErgebnisse(ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "IB_Blitzergebnisse"
        LoadScene elMainLayer, sScene
        SetShow
        SetIBSide
        SetTitle  Data.Item("HEADER")
        SetSubLine ""
        SetTitelDefaultHeader
        
        dim ids : ids=1102
        for i = 1 to Data.Item("ITEMCOUNT")
            SetVizData ids , Data.Item("NAME_A" & i) ,"string","Name A "&i
            SetVizData ids+4 , Data.Item("NAME_B" & i) ,"string","Name B "&i
            SetVizData ids+2 , Data.Item("RESULT" & i) ,"string","Result "&i
            ids=ids+100
        next

        SetVizData "0004",Data.Item("ITEMCOUNT"),"int","Count"

        GetPreview "Default 3.0", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0" ,sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub IB_BlitzTabelle(ByRef Data)
        if not i_variant=1 then exit sub
        dim i,k
        dim page2
        sScene = "IB_Blitztabelle"
        dim count,hcount
        page2=false
        LoadScene elMainLayer, sScene
        SetShow
        SetIBSide
            'SetText "$txt_Titel", UCase(GetString("BLITZTABELLE", i__TVLanguage))
        SetTitle Data.Item("HEADER")
        count=Data.Item("ITEMCOUNT")
        hcount=count
        if count>7 then
            page2=true
            hcount=Ceil(count/2.0)

        end if
        SetVizData "0502",GetString(Data.Item("HEADER1"), i__TVLanguage)  ,"string","Header 1"
        SetVizData "0504",GetString(Data.Item("HEADER2"), i__TVLanguage)  ,"string","Header 2"
        SetTitelDefaultHeader
        dim ids:ids= 1100
        k = 0
        for i = 1 to hcount
            SetVizData ids, Data.Item("PLACE" & i) ,"string","Place "&i
            SetVizData ids+2, Data.Item("NAME" & i) ,"string","Name "&i
            SetVizData ids+4, Data.Item("GOALS" & i),"string","Goals "&i
            SetVizData ids+6, Data.Item("POINTS" & i) ,"int","Points "&i

            ids=ids+100
        next
        if page2=true then
            ids=2100
            for i=(hcount+1) to (hcount*2)
                if i>count  then
                    SetVizData ids+2, "" ,"string",""
                else
                    SetVizData ids, Data.Item("PLACE" & i) ,"string","Place "&i
                    SetVizData ids+2, Data.Item("NAME" & i) ,"string","Name "&i
                    SetVizData ids+4, Data.Item("GOALS" & i) ,"string","Goals "&i
                    SetVizData ids+6, Data.Item("POINTS" & i) ,"int","Points "&i
                end if
                ids=ids+100
            next
        end if
        

        SetVizData "0004",hcount ,"int","Count"

        GetPreview "Default 3.0", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0 L6 3.0 L7 3.0", sScene
        Redim ActionList(2, 1)
            ActionList(1, 0) = "Default"
            ActionList(1, 1) = "Default"
            ActionList(2, 1) = efPlay
    end sub

    public sub DSS_BlitzTabelle_Show(ByRef Data)
        'if getGFXV =2 then
            DSS_BlitzTabelle_Show_WF Data
        	exit sub
        'end if
        dim k

        SetVizDataFL "1001",Data.Item("HEADER")
        SetVizDataFL "1002",Data.Item("HEADER1")
        SetVizDataFL "1003",Data.Item("HEADER2")
        dim ids:ids=1100
        for k = 1 to Data.Item("ITEMCOUNT")
            SetVizDataFL ids,Data.Item("PLACE" & k)
            SetVizDataFL ids+2,Data.Item("NAME" & k)
            SetVizDataFL ids+4,Data.Item("GOALS" & k)
            SetVizDataFL ids+6,Data.Item("POINTS" & k)
            ids=ids+100
        next
        SetVizDataFL "1000", Data.Item("ITEMCOUNT")

        for i=1 to Data.Item("ITEMCOUNT")
        obj__TV.SendCommand "SCENE*" & s__VizPath & "/DSS_Uhr*STAGE*DIRECTOR*H"&i&" SHOW 0.0"
        next
        sScene="DSS_Uhr"
        GetPreview "BLITZTABELLE 3.5 ", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5", sScene

    end sub
    
    public sub DSS_BlitzTabelle_Show_WF(ByRef Data)
        dim k
        dim p
        SetVizDataUpperFL "1001",Data.Item("HEADER")
        SetVizDataUpperFL "1002",Data.Item("HEADER1")
        SetVizDataUpperFL "1003",Data.Item("HEADER2")
        dim ids:ids=1010
        for k = 1 to Data.Item("ITEMCOUNT")
            p=Data.Item("PLACE" & k)
            SetVizDataFL ids,p
            SetVizDataUpperFL ids+1,Data.Item("NAME" & k)
            SetVizDataFL ids+2,Data.Item("GOALS" & k)
            SetVizDataFL ids+3,Data.Item("POINTS" & k)
            if p="1." or p="2." then
                SetVizDataFL ids+4,0
                if k<3 then
                    obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object$DSS$ZUSATZ$BLITZTABELLE$SEITE1$LINE"&k&"$ELEMENTE$img_cl_icon*ACTIVE SET 1")
                    obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object$DSS$ZUSATZ$BLITZTABELLE$SEITE1$LINE"&k&"$ELEMENTE$img_cl_icon*IMAGE SET IMAGE*VizDbCube/scene/Live_Sports/Austria/Redesign_2018/Elemente/cl_icon")
                end if
            elseif p="3." or p="4." then
                SetVizDataFL ids+4,1
                if k<5 then
                    obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object$DSS$ZUSATZ$BLITZTABELLE$SEITE1$LINE"&k&"$ELEMENTE$img_cl_icon*ACTIVE SET 1")
                    obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object$DSS$ZUSATZ$BLITZTABELLE$SEITE1$LINE"&k&"$ELEMENTE$img_cl_icon*IMAGE SET IMAGE*VizDbCube/scene/Live_Sports/Austria/Redesign_2018/Elemente/el_icon")
                end if
            elseif p="12." then
                SetVizDataFL ids+4,1
                if k<5 then
                    obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object$DSS$ZUSATZ$BLITZTABELLE$SEITE1$LINE"&k&"$ELEMENTE$img_cl_icon*ACTIVE SET 0")
                end if
            else
                SetVizDataFL ids+4,2
                if k<5 then
                    obj__TV.SendCommand("RENDERER*FRONT_LAYER*TREE*$object$DSS$ZUSATZ$BLITZTABELLE$SEITE1$LINE"&k&"$ELEMENTE$img_cl_icon*ACTIVE SET 0")
                end if
            end if
            ids=ids+10
        next
        SetVizDataFL "1004",Data.Item("ITEMCOUNT")
        sScene="DSS"
        if Data.Item("ITEMCOUNT")>6 then
            GetPreviewWF "BLITZTABELLE", "1.78", sScene
        else
            GetPreviewWF "BLITZTABELLE_OHNE_WECHSEL", "1.78", sScene
        end if

    end sub
    
    public sub DSS_BlitzErgebnisse_Show(ByRef Data)
        if getGFXV =2 then
            DSS_BlitzErgebnisse_Show_WF Data
        	exit sub
        end if
    end sub

    public sub DSS_BlitzErgebnisse_Show_WF(ByRef Data)
        dim k

        dim ids : ids=6011
        for i = 1 to Data.Item("ITEMCOUNT")
            SetVizDataUpperFL ids , Data.Item("NAME_A" & i)
            SetVizDataUpperFL ids+2 , Data.Item("NAME_B" & i)
            SetVizDataFL ids+1 , Data.Item("RESULT" & i)
            ids=ids+10
        next

        SetVizDataFL "6005",Data.Item("ITEMCOUNT")

        sScene="DSS"
        GetPreviewWF "BLITZERG", "1.78", sScene

    end sub
    
    public sub DSS_Stat_Show(ByRef Data)
        if getGFXV =2 then
            DSS_Stat_Show_WF Data
        	exit sub
        end if
    end sub

    public sub DSS_Stat_Show_WF(ByRef Data)
        dim k

        dim ids : ids=7011
        dim c:c= Data.Item("ITEMCOUNT")
        if c>3 then c=3
        for i = 1 to c
            SetVizDataFL ids , Data.Item("PARAM_A" & i)
            SetVizDataFL ids+2 , Data.Item("PARAM_B" & i)
            SetVizDataUpperFL ids+1 , Data.Item("TEXT" & i)
            ids=ids+10
        next

        SetVizDataFL "7000",c

        sScene="DSS"
        GetPreviewWF "STAT", "1.78", sScene

    end sub

    public sub BB_PlayerStats(ByRef Data)
        'if getGFXV =2 then
        if Data.Item("ISWF")= true then
            BB_PlayerStats_WF Data
            exit sub
        end if
        if not i_variant=1 then exit sub
        dim i
        if Data.Item("NEBENEINANDER") then
            'if Data.Item("MIT_TAUFE") then
                sScene = "BB_Statistik"
            'else
            '    sScene = "BB_3er_Statistik"
            'end if
        else
            sScene = "BB_Playerstat"
        end if
        LoadScene elMainLayer, sScene
        SetShow

        SetPLastName Data.Item("NAME")
        SetPFirstName Data.Item("FNAME")
        SetTLogo Data.Item("LOGO")
        SetPNummer Data.Item("NR")
        
        if Data.item("SHOWHS") and Data.Item("NR")<>"" then
            SetPHS LCase(Data.Item("LOGO")),Data.Item("NR")
        else
            SetPHSOff
        end if
        

        SetVizData "0120", Data.Item("INFO") ,"string","Info"
        dim count:count=0
        dim ids
        ids=1110
        for i = 1 to 6
            if Data.Item("TEXT" & i) <> "" then
                SetVizData ids,Data.Item("TEXT" & i)  ,"string","Para "&i
                SetVizData ids+5,Data.Item("VALUE" & i) ,"string","Value A "&i
                SetVizData ids+1,Data.Item("VALUE" & i) ,"string","Value B "&i
                ids=ids+100
                count=count+1
            end if
        next
        
        if Data.Item("NEBENEINANDER") then
              SetVizData "0005", count ,"int","Count"
        else
            SetVizData "0004", count ,"int","Count"
            SetVizData "0005", 1     ,"int",""
            SetVizData "0501", ""    ,"string",""
        end if

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub BB_PlayerStats_WF(ByRef Data)
        dim i
        sScene = "BB_Stat"
        if Data.item("SHOWHS") and Data.Item("NR")<>"" then
            sScene = "BB_Stat_Foto"
        end if
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff "BB PlayerStats"
        SetPLastName UCase(Data.Item("NAME") )
        SetPFirstName UCase(Data.Item("FNAME")  )
        SetTLogo Data.Item("LOGO")
        SetPNummer Data.Item("NR")

        if Data.item("SHOWHS") and Data.Item("NR")<>"" then
            SetPHS LCase(Data.Item("LOGO")),Data.Item("NR")
        else
            SetPHSOff
        end if


        SetVizData "0120", Data.Item("INFO"),"string","Info"
        dim count:count=0
        dim ids
        ids=210
        for i = 1 to 6
            if Data.Item("TEXT" & i) <> "" then
                SetVizData "0"&ids,UCase(Data.Item("TEXT" & i)  ) ,"string","Para "&i
                SetVizData "0"&(ids+10),Data.Item("VALUE" & i)   ,"string","Value "&i
                ids=ids+100
                count=count+1
            end if
        next

        if Data.Item("NEBENEINANDER") then
              SetVizData "0200", count ,"int","Count"
        else
            SetVizData "0004", count  ,"int","Count"
            SetVizData "0005", 1      ,"int",""
            SetVizData "0501", ""     ,"string",""
        end if

        GetPreviewWF "Default", "2.78", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub HL(ByRef Data)
        dim i
        for i = 1 to 6
            if Data.Item("HL" & i) then
                obj__TV.DoEffect elMainLayer, "H" & i, efPlay
                CC.SF.Wait 100
            end if
        next
    end sub
    
    public sub HL2(dir)
        obj__TV.DoEffect elMainLayer, dir, efPlay
    end sub

    public sub HL_FREE(ByRef Data,min, max,refhl,dir,offset)
        dim i
        for i = min to max
            if Data.Item(refhl & i) then
                if tw_virtuell.visible=true then
                    'obj__TV.DoEffect elMainLayer&"*GFX*"&tw_virtuell.rb_gfx.ItemIndex, dir & i +offset, efPlay
                    obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*1*STAGE*DIRECTOR*"&dir &i +offset &" START")
                else
                obj__TV.DoEffect elMainLayer, dir & i +offset, efPlay
                end if
                CC.SF.Wait 100
            end if
        next
    end sub
    
    public sub HL_FREE2(dir)
        if tw_virtuell.visible=true then
            obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*1*STAGE*DIRECTOR*"&dir &" START")
        else
            obj__TV.DoEffect elMainLayer, dir, efPlay
        end if
    end sub

    public sub HL_FREE_FL(ByRef Data,min, max,refhl,dir)
        dim i
        for i = min to max
            if Data.Item(refhl & i) then
                obj__TV.DoEffect elFrontLayer, dir & i, efPlay
                CC.SF.Wait 100
            end if
        next
    end sub

    public sub HL_FREE_FL2(dir)
        obj__TV.DoEffect elFrontLayer, dir, efPlay
    end sub

    public sub VB_IB_Programm(ByRef Data)
        if not i_variant=1 then exit sub
        dim i, obj
        dim ids
        if Data.Item("AS_INFOBOX") = true then
            sScene = "IB_Hinweise"
            ids =1102
        else
            sScene = "VB_Hinweise"
            ids=  1111
        end if

        LoadScene elMainLayer, sScene
        SetShow
        if Data.Item("AS_INFOBOX") = true then
            SetIBSide
        else
            SetBGOnOff
        end if
        SetTitelDefaultHeader
        SetTitle Data.Item("HEADER")
        SetTitleSubLine ""
        SetDropLine ""
        SetSubLine ""
        SetVizData "0085", 0  ,"int",""
        if Data.Item("AS_INFOBOX") = true then SetSubLine ""
        for i = 1 to 5
            SetVizData ids,Data.Item("NAME_A" & i) & " - " & Data.Item("NAME_B" & i) ,"string","Match"
            SetVizData ids+1 ,Data.Item("TIME" & i) ,"string","Time"
            SetTeamLogo ids+2,LCase(Data.Item("LOGO_A" & i)),"Logo A"
            SetTeamLogo ids+3,LCase(Data.Item("LOGO_B" & i)),"Logo B"

            'if i<6 then
            '    obj = "QUOTE_" & i
            '    SetText obj & "$txt_Spiel_Quote",      UCase(Data.Item("NAME_A" & i)) & " - " & UCase(Data.Item("NAME_B" & i))
            '    SetText obj & "$txt_Quote_Sieg"&i,      Data.Item("QH" & i)
            '    SetText obj & "$txt_Quote_Remi"&i,      Data.Item("QD" & i)
            '    SetText obj & "$txt_Quote_Niederlage"&i,      Data.Item("QG" & i)
            'end if
            ids=ids+100
        next

        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"


        GetPreview "Default 3.0", "L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub Programm_continue()
        GetPreview "Default 1.8 TAFEL_1 0.0", "TAFEL_2 1.3", sScene
        Redim ActionList(2, 2)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "TAFEL_1"
        ActionList(2, 1) = efContinue
        ActionList(1, 2) = "TAFEL_2"
        ActionList(2, 2) = efPlay
    end sub

    public sub QuotenStart
        if not i_variant=1 then exit sub
        obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$STOP_ADMIRAL*VALUE SET PAUSER"
        obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*ACTION*RESET*KEY*$PLAY_ADMIRAL*MODE SET COMMAND"
        obj__TV.DoEffect elMainLayer, "Default", efContinue
    end sub

    public sub VB_IB_PlayerStatsTable(ByRef Data)
        if getGFXV =2 then
            VB_IB_PlayerStatsTable_WF Data
            exit sub
        end if
        dim i
        if Data.Item("AS_INFOBOX") = true then
            sScene = "IB_Hitliste_Logos"

        else
            sScene = "VB_Hitliste"
        end if

        LoadScene elMainLayer, sScene
        SetShow
        SetTitelDefaultHeader
        SetVizData "0008", 0 ,"int",""
        SetTitle Data.Item("TITLE")
        SetTitleSubLine ""
        SetDropLine ""
        SetVizData "0500",Data.Item("SUBTITLE") ,"string","Subtitle"

        if Data.Item("AS_INFOBOX") = true then
            SetIBSide
            SetVizData "0501",Data.Item("HEADER_A") ,"string","Header A"
        else
            SetBGOnOff
            SetVizData "0501","" ,"string",""
            SetVizData "0008",1  ,"int",""
            if Data.Item("TWO_PARAMS") = true then
                SetVizData "0005",2 ,"int",""
                SetVizData "0502",Data.Item("HEADER_A")  ,"string","Header A"
                SetVizData "0503",Data.Item("HEADER_B") ,"string","Header B"
            else
                SetVizData "0005",3  ,"int",""
                SetVizData "0502","" ,"string",""
                SetVizData "0503",Data.Item("HEADER_A") ,"string","Header A"
            end if
        end if


        dim ids : ids = 1100
        for i = 1 to 8  ' IB hat nur 6!
            if Data.Item("AS_INFOBOX") = true then
                SetVizData ids ,Data.Item("NR" & i) ,"string","Number "&i
                SetVizData ids+2, Data.Item("NAME" & i) ,"string","Name "&i
                SetVizData ids+3 ,Data.Item("PARAM_A" & i),"string","Para A "&i
                SetTeamLogo ids+1,LCase(Data.Item("LOGO"&i)),"Logo "&i
            else
                SetVizData ids ,Data.Item("NR" & i),"string","Number "&i
                SetVizData ids+2, Data.Item("NAME" & i) ,"string","Name "&i
                SetTeamLogo ids+1,LCase(Data.Item("LOGO"&i)),"Logo "&i
                SetVizData ids+3 ,"" ,"string",""
                if Data.Item("TWO_PARAMS") = true then
                    SetVizData ids+4,Data.Item("PARAM_A" & i) ,"string","Para A "&i
                    SetVizData ids+5,Data.Item("PARAM_B" & i) ,"string","Para B "&i
                else
                    SetVizData ids+4,"" ,"string",""
                    SetVizData ids+5,Data.Item("PARAM_A" & i) ,"string","Para A "&i
                end if
            end if
            ids =ids + 100
        next
            SetVizData "0004" ,Data.Item("ITEMCOUNT") ,"int","Count"
        GetPreview "Default 2.0", "L1 2.0 L2 2.0 L3 2.0 L4 2.0 L5 2.0 L6 2.0 L7 2.0 L8 2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_IB_PlayerStatsTable_WF(ByRef Data)
        dim i
        if Data.Item("AS_INFOBOX") = true then
            sScene = "IB_Stat"

        else
            'sScene = "VB_Hitliste"
        end if

        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff "VB PlayerStat"
        SetVizDataUpper "0100" ,Data.Item("TITLE")  ,"string","Title"
        SetVizDataUpper "0110",Data.Item("SUBTITLE") ,"string","§ubtitle"

        if Data.Item("AS_INFOBOX") = true then
            SetIBSide
            SetVizDataUpper "0120",Data.Item("HEADER_A") ,"string","Header A"
            SetVizData "0090","IMAGE*"&s__LogoPathDiv & "/" &"ofbl_Ball","image","Image"
        else
            SetBGOnOff
            SetVizData "0501",""  ,"string",""
            SetVizData "0008",1 ,"int",""
            if Data.Item("TWO_PARAMS") = true then
                SetVizData "0005",2 ,"int",""
                SetVizDataUpper "0502",Data.Item("HEADER_A")  ,"string","Header A"
                SetVizDataUpper "0503",Data.Item("HEADER_B") ,"string","Header B"
            else
                SetVizData "0005",3 ,"int",""
                SetVizData "0502","" ,"string",""
                SetVizDataUpper "0503",Data.Item("HEADER_A") ,"string","Header A"
            end if
        end if


        dim ids : ids = 1111
        for i = 1 to 8  ' IB hat nur 6!
            if Data.Item("AS_INFOBOX") = true then
                'SetVizData ids ,Data.Item("NR" & i)
                SetVizDataUpper ids, Data.Item("NAME" & i),"string","Name "&i
                SetVizData ids+1 ,Data.Item("PARAM_A" & i),"string","Para A "&i
                'SetTeamLogo ids+1,LCase(Data.Item("LOGO"&i))
            else
                SetVizData ids ,Data.Item("NR" & i),"string","Number "&i
                SetVizDataUpper ids+2, Data.Item("NAME" & i) ,"string","Name "&i
                SetTeamLogo ids+1,LCase(Data.Item("LOGO"&i)),"Logo "&i
                SetVizData ids+3 ,"","string",""
                if Data.Item("TWO_PARAMS") = true then
                    SetVizData ids+4,Data.Item("PARAM_A" & i) ,"string","Para A "&i
                    SetVizData ids+5,Data.Item("PARAM_B" & i),"string","Para B "&i
                else
                    SetVizData ids+4,"" ,"string",""
                    SetVizData ids+5,Data.Item("PARAM_A" & i),"string","Para A "&i
                end if
            end if
            ids =ids + 100
        next
         if Data.Item("ITEMCOUNT")>5 then
             SetVizData "0004" ,5 ,"int","Count"
        else
            SetVizData "0004" ,Data.Item("ITEMCOUNT") ,"int","Count"
        end if

        GetPreviewWF "Default", "3.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub


    public sub VB_TeamStats(ByRef Data)
        if getGFXV =2 then
            VB_TeamStats_WF Data
            exit sub
        end if
        dim i
        sScene = "SVB_Statistikvgl"
        LoadScene elMainLayer, sScene
        SetShow
        SetBGOnOff
        SetTitleLogo "",false
        SetTeamLogo "0060" ,LCase(Data.Item("LOGO1")),"Logo A"
        SetTeamLogo "0070" ,LCase(Data.Item("LOGO2")),"Logo B"
        SetVizData "0050",0 ,"int",""
        SetVizData "0100",Data.Item("NAME1") ,"string","Name A"
        SetVizData "0200",Data.Item("NAME2") ,"string","Name B"
        SetVizData "0110","" ,"string",""
        SetVizData "0210","" ,"string",""

        SetVizData "0500", GetString("TEAM_STATISTIK", i__TVLanguage) ,"string","Title"
        if Data.Item("HL") <> "" then
            SetVizData "0500", Data.Item("HL") ,"string","Headline"
        end if

        if Data.Item("WITH_SCORE") = true then
            SetVizData "0149",1,"int","Score On/Off"
            SetVizData "0150",Data.Item("SCORE") ,"string","Score"
        else
            SetVizData "0149",0 ,"int","Score On/Off"
            SetVizData "0150","vs" ,"string","Score"
        end if

        dim ids:ids= 1100
        for i = 1 to 8
            SetVizData ids,Data.Item("PARAM_A" & i) ,"string","Value A "&i
            SetVizData ids+1,Data.Item("TEXT" & i)  ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i)  ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT"),"int","Count"

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_TeamStats_WF(ByRef Data)
        dim i
        sScene = "VB_Vergleich"
        LoadSceneWF elMainLayer, sScene

        SetBGOnOffWF
        SetCommercialOnOffManual false, "VB Team Stats"
        SetVizDataUpper "0100", GetString("TEAM_STATISTIK", i__TVLanguage),"string","Title"
        if Data.Item("HL") <> "" then
            SetVizData "0100", Data.Item("HL") ,"string","Headline"
        end if
        SetVizData "0110",""  ,"string",""
        SetVizDataUpper "0094",Data.Item("SNAME1")   ,"string","Name A"
        SetVizdata "0095",""  ,"string",""
        SetTeamLogo "0090",  LCase(Data.Item("LOGO1")),"Logo A"
        SetVizDataUpper "0098",Data.Item("SNAME2") ,"string","Name B"
        SetVizdata "0099","","string",""
        SetTeamLogo  "0096",LCase(Data.Item("LOGO2")),"Logo B"

        SetVizData "0005",1   ,"int",""


        dim ids:ids= 1110
        for i = 1 to 10
            SetVizData ids,Data.Item("PARAM_A" & i),"string","Value A "&i
            SetVizDataUpper ids+1,Data.Item("TEXT" & i),"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i),"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreviewWF "Default", "3.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub IB_TeamStats(ByRef Data)
        if getGFXV =2 then
            IB_TeamStats_WF Data
            exit sub
        end if
        dim i
        sScene = "IB_Statistikvgl"
        LoadScene elMainLayer, sScene
        SetShow
        SetIBSide


        'SetTeamLogo "0090" ,LCase(Data.Item("LOGO1"))
        'SetTeamLogo "0095" ,LCase(Data.Item("LOGO2"))


        SetVizData "0110","" ,"string",""

        SetVizData "0115",Data.Item("NAME1"),"string","Name A"
        SetVizData "0120",Data.Item("NAME2"),"string","Name B"

        SetVizData "0100", GetString("TEAM_STATISTIK", i__TVLanguage) ,"string","Title"
        if Data.Item("HL") <> "" then
            SetVizData "0100", Data.Item("HL") ,"string","Headline"
        end if


        dim ids:ids= 1100
        for i = 1 to 8
            SetVizData ids,Data.Item("PARAM_A" & i) ,"string","Value A "&i
            SetVizData ids+1,Data.Item("TEXT" & i) ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i)  ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT"),"int","Count"

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub IB_TeamStats_WF(ByRef Data)
        dim i
        sScene = "IB_Vergleich"
        LoadSceneWF elMainLayer, sScene
        SetIBSide
         SetCommercialOnOff "IB TeamStats"

        SetTeamLogo "0090" ,LCase(Data.Item("LOGO1")),"Logo A"
        SetTeamLogo "0096" ,LCase(Data.Item("LOGO2")),"Logo B"


        SetVizData "0110",""  ,"string",""

        SetVizDataUpper "0115",Data.Item("NAME1")  ,"string","Name A"
        SetVizDataUpper "0120",Data.Item("NAME2") ,"string","Name B"

        SetVizDataUpper "0100", GetString("TEAM_STATISTIK", i__TVLanguage) ,"string","Title"
        if Data.Item("HL") <> "" then
            SetVizDataUpper "0100", Data.Item("HL") ,"string","Headline"
        end if


        dim ids:ids= 1110
        for i = 1 to 8
            SetVizData ids,Data.Item("PARAM_A" & i),"string","Value A "&i
            SetVizDataUpper ids+1,Data.Item("TEXT" & i) ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i) ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT")  ,"int","Count"

        GetPreviewWF "Default", "3.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub VB_PlayerStatsCompare(ByRef Data)
        if getGFXV =2 then
            VB_PlayerStatsCompare_WF Data
            exit sub
        end if

        dim i

        sScene = "SVB_Statistikvgl"

        LoadScene elMainLayer, sScene
        
        SetShow
        SetBGOnOff
        SetTitleLogo "",false
        SetTeamLogo "0060" ,LCase(Data.Item("LOGO1") ),"Logo A"
        SetTeamLogo "0070" ,LCase(Data.Item("LOGO2")),"Logo B"

        SetVizData "0100",Data.Item("NAME1"),"string","Name A"
        SetVizData "0200",Data.Item("NAME2"),"string","Name B"
        SetVizData "0110","" ,"string",""
        SetVizData "0210","" ,"string",""
        SetVizData "0500", Data.Item("TITLE"),"string","Title"
        
        SetVizData "0149",-1 ,"int",""
        SetVizData "0150",""  ,"string",""
        

        if not Data.item("ONLYPHOTO") then
            SetVizData "0050",1 ,"int","Photo On/Off"
            SetVizData "0063","IMAGE*"&s__PlayerFotoPath & "/" &LCase(Data.Item("FOTO1")) ,"image","Photo A"
            SetVizData "0073","IMAGE*"&s__PlayerFotoPath & "/" &LCase(Data.Item("FOTO2"))  ,"image","Photo B"
        else
            SetVizData "0050",0 ,"int","Photo On/Off"
        end if


        dim ids:ids= 1100
        for i = 1 to 8
            SetVizData ids,Data.Item("PARAM_A" & i) ,"string","Value A "&i
            SetVizData ids+1,Data.Item("TEXT" & i) ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i)  ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_PlayerStatsCompare_WF(ByRef Data)
        dim i

        sScene = "VB_Vergleich"

        LoadSceneWF elMainLayer, sScene

        SetBGOnOffWF
        
         SetCommercialOnOff "VB Vergleich"
        SetVizDataUpper "0100",Data.Item("TITLE") ,"string","Title"
        SetVizData "0110","" ,"string",""
        SetVizDataUpper "0094",Data.Item("FNAME1") ,"string","Player First Name A"
        SetVizDataUpper "0095",Data.Item("LNAME1") ,"string","Player Last Name A"
        SetTeamLogo "0090",  LCase(Data.Item("LOGO1")),"Logo A"
        SetVizDataUpper "0098",Data.Item("FNAME2"),"string","Player First Name B"
        SetVizDataUpper "0099",Data.Item("LNAME2") ,"string","Player Last Name B"
        SetTeamLogo  "0096",LCase(Data.Item("LOGO2")),"Logo B"

        if Data.Item("FOTO") =true then
            SetVizData "0005",0  ,"int","Photo On/Off"
            SetPlayerHS "0093",  LCase(Data.Item("LOGO1")), LCase(Data.Item("NR1")),"Photo A"
            SetPlayerHS "0097",  LCase(Data.Item("LOGO2")), LCase(Data.Item("NR2")),"Photo B"
        else
            SetVizData "0005",1 ,"int","Photo On/Off"
        end if


        dim ids:ids= 1110
        for i = 1 to 10
            SetVizData ids,Data.Item("PARAM_A" & i)  ,"string","Value A "&i
            SetVizDataUpper ids+1,Data.Item("TEXT" & i)   ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i) ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreviewWF "Default", "3.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_PlayerStat(ByRef Data)
        if getGFXV =2 then
            VB_PlayerStat_WF Data
            exit sub
        end if
        dim i


    end sub
    
    public sub VB_PlayerStat_WF(ByRef Data)
        dim i

        sScene = "VB_SpielerStat"

        LoadSceneWF elMainLayer, sScene

        SetCommercialOnOff "VB SpielerStats"
        SetBGOnOffWF
        dim ids:ids= 1111
        if Data.Item("SIDE") = 0 then
            SetVizDataUpper "0100",Data.Item("NAME1") ,"string","Name A"
            SetPlayerHS "0090",Data.Item("LOGO1"),Data.Item("NR1"),"Photo A"
            for i = 1 to 10
                SetVizData ids+1,Data.Item("PARAM_A" & i) ,"string","Value A "&i
                SetVizDataUpper ids,Data.Item("TEXT" & i),"string","Para A "&i
                ids=ids+100
            next
        else
            SetVizDataUpper "0100",Data.Item("NAME2") ,"string","Name B"
            SetPlayerHS "0090",Data.Item("LOGO2"),Data.Item("NR2"),"Photo B"
            for i = 1 to 10
                SetVizData ids+1,Data.Item("PARAM_B" & i)  ,"string","Value B "&i
                SetVizDataUpper ids,Data.Item("TEXT" & i) ,"string","Para B "&i
                ids=ids+100
            next
        end if

        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreviewWF "Default 2.24", "STAT 2.06", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub IB_PlayerStatsCompare(ByRef Data)
        if getGFXV =2 then
            IB_PlayerStatsCompare_WF Data
            exit sub
        end if
        dim i

        sScene = "IB_Statistikvgl"

        LoadScene elMainLayer, sScene

        SetIBSide


        SetTeamLogo "0090" ,LCase(Data.Item("LOGO1")),"Logo A"
        SetTeamLogo "0095" ,LCase(Data.Item("LOGO2")),"Logo B"


        SetVizData "0110",""  ,"string",""

        SetVizData "0115",Data.Item("NAME1") ,"string","Name A"
        SetVizData "0120",Data.Item("NAME2") ,"string","Name B"

        SetVizData "0100", Data.Item("TITLE"),"string","Title" 'GetString("TEAM_STATISTIK", i__TVLanguage)
        if Data.Item("HL") <> "" then
            'SetVizData "0100", Data.Item("TITLE") ,"string","Title"
        end if


        dim ids:ids= 1100
        for i = 1 to 8
            SetVizData ids,Data.Item("PARAM_A" & i),"string","Value A "&i
            SetVizData ids+1,Data.Item("TEXT" & i) ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i) ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT") ,"int","Count"

        GetPreview "Default 3.5", "L1 3.5 L2 3.5 L3 3.5 L4 3.5 L5 3.5 L6 3.5 L7 3.5 L8 3.5 L9 3.5 L10 3.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub IB_PlayerStatsCompare_WF(ByRef Data)
        dim i
        sScene = "IB_Vergleich"
        LoadSceneWF elMainLayer, sScene
        SetIBSide
         SetCommercialOnOff "IB PlayerStatsCompare"

        SetTeamLogo "0090" ,LCase(Data.Item("LOGO1")),"Logo A"
        SetTeamLogo "0095" ,LCase(Data.Item("LOGO2")),"Logo B"


        SetVizData "0110",""  ,"string",""

        SetVizDataUpper "0115",Data.Item("NAME1"),"string","Name A"
        SetVizDataUpper "0120",Data.Item("NAME2"),"string","Name B"

        SetVizDataUpper "0100", Data.Item("TITLE"),"string","Title" 'GetString("TEAM_STATISTIK", i__TVLanguage)
        if Data.Item("HL") <> "" then
            'SetVizDataUpper "0100", Data.Item("TITLE"),"string"
        end if


        dim ids:ids= 11010
        for i = 1 to 8
            SetVizData ids,Data.Item("PARAM_A" & i),"string","Value A "&i
            SetVizDataUpper ids+1,Data.Item("TEXT" & i) ,"string","Para "&i
            SetVizData ids+2,Data.Item("PARAM_B" & i)  ,"string","Value B "&i
            ids=ids+100
        next
        SetVizData "0004", Data.Item("ITEMCOUNT"),"int","Count"

        GetPreviewWF "Default", "3.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub


    public sub Stat_BB(ByRef Data)
        dim i
        sScene = "BB_Statistik"
        LoadScene elMainLayer, sScene
        SetText "txt_TeamHeim", UCase(Data.Item("NAME1"))
        SetText "txt_TeamGast", UCase(Data.Item("NAME2"))
        SetText "txt_Erg"     , UCase(Data.Item("SCORE"))
        SetImg  "img_LogoHeim", s__LogoPath & "\" & LCase(Data.Item("LOGO1"))
        SetImg  "img_LogoGast", s__LogoPath & "\" & LCase(Data.Item("LOGO2"))

        for i = 1 to 4
            SetText "WECHSEL_" & i & "$txt_WertHeim" , UCase(Data.Item("PARAM_A" & i))
            SetText "WECHSEL_" & i & "$txt_WertGast" , UCase(Data.Item("PARAM_B" & i))
            SetText "WECHSEL_" & i & "$txt_Parameter", UCase(Data.Item("TEXT"    & i))
        next
        GetPreview "Default", "1.8", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub BB_TeamStat(ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "BB_Statistik_Vergleich"
        LoadScene elMainLayer, sScene
        SetShow
        SetTName Data.Item("NAME1")
        SetTLogo  LCase(Data.Item("LOGO1"))
        SetTName2 Data.Item("NAME2")
        SetTLogo2  LCase(Data.Item("LOGO2"))
        SetScore  Data.Item("SCORE")
        SetSubLine Data.Item("HL")
        dim id:ids=1109

        SetVizData "0004",Data.Item("ITEMCOUNT"),"int","Count"
        for i = 1 to Data.Item("ITEMCOUNT")
            SetVizData ids+1,Data.Item("TEXT"& i) ,"string","Para "&i
            SetVizData ids,Data.Item("PARAM_A" & i) ,"string","Value A "&i
            SetVizData ids+3,Data.Item("PARAM_B" & i) ,"string","Value B "&i
            ids=ids+100
        next

        GetPreview "Default 2.0", "L1 2.0 L2 2.0 L3 2.0 L4 2.0 L5 2.0 L6 2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub


    Public Function DSS_Show(ByRef Data)
        dim sDirector
        dim casefix
        if Data.Item("WITH_CLOCK") then
            sScene = "DSS"
            casefix=true
        else
            sScene = "DSS_Uhr"'"DSS_ASAT"
            casefix =false
        end if
        obj__TV.RendererUpdate false
        obj__TV.OpenProject s__VizPathWF
        obj__TV.SetScene sScene
        obj__TV.LoadScene elFrontLayer
        obj__TV.DoEffect elFrontLayer, "ALL", efReset
        obj__TV.RendererUpdate true
        b__VisibleDSS     = True
        b__VisibleADD     = False
        b__VisibleText    = False
        if Data.Item("WITH_CLOCK") then
            SetVizDataFL "0001",1
            b__VisibleClock = true
        else
            SetVizDataFL "0001",0
            b__VisibleClock = False
        end if

        dim i
        select case tw_Layout.layout.ItemIndex
            case 0      i=1
            case 1      i=3
            case 2      i=4
            case 3      i=11
        end select
        SetVizDataFL "0000",i
        dim time
        time= pgMain.ed_nachspiel.Text
        if not trim(time)="" then time= "+"&time
        SetVizDataFL "0360",time

        dim iAddTime : iAddTime = Data.Item("INJURYTIME")
        dim bAddTime : bAddTime = (iAddTime > -1)
        if casefix=true then
            SetVizDataUpperFL "0100",Data.Item("T_SNAME_1")
            SetVizDataUpperFL "0200",Data.Item("T_SNAME_2")
        else
            SetVizDataFL "0100",Data.Item("T_SNAME_1")
            SetVizDataFL "0200",Data.Item("T_SNAME_2")
        end if
        if pg_settings.rb_opmode.ItemIndex=0 then
            SetVizDataFL "0001",1
        end if
        SetVizDataFL "0110.material",s__ColorPath&"/"& Data.Item("T_COLOR_1")
        SetVizDataFL "0210.material",s__ColorPath&"/"& Data.Item("T_COLOR_2")

        SetVizDataFL "0150", Data.Item("T_SCORE_1") & ":" & Data.Item("T_SCORE_2") 'SetText "DSS_Uhr$txt_Erg", Data.Item("T_SCORE_1") & ":" & Data.Item("T_SCORE_2")
        SetVizDataFL "0105", Data.Item("T_SCORE_1")
        SetVizDataFL "0205", Data.Item("T_SCORE_2")
        
        obj__TV.SetClock 0, clLimit, Data.Item("MAINTIME_LIMIT")
        obj__TV.SendCommand "CLOCK0*DIRECTION SET UP"
        'if Data("TIME_ISRUNNING") then
'            obj__TV.SendCommand "CLOCK0 START"
'            obj__TV.SendCommand "CLOCK1 START"  ' Ich glaube es ist egal wenn ich die jetzt schon Starte. Sie ist eh nicht eingeblendet
'        else
'            obj__TV.SendCommand "CLOCK0 STOP"
'            obj__TV.SendCommand "CLOCK1 STOP"
'        end if

        ' NOTIZ: Problematisch. Die ADD Time ist mglw. veraltet die TSP Zeit aber nicht.
        if (Data.Item("MAINTIME_LIMIT") <> "") and ((TSP.GetTime(TSP_Time, 0) / 1000) > Data.Item("MAINTIME_LIMIT")) then
            obj__TV.SendCommand "CLOCK0*TIME SET " & Data.Item("MAINTIME_LIMIT")
        else  ' Problem ist, das Uhren Objekt prüft Zeit-Limits NUR wenn sie TICKT
            obj__TV.SendCommand "CLOCK0*TIME SET " & (TSP.GetTime(TSP_Time, 0) / 1000)
        end if
        obj__TV.SendCommand "CLOCK1*TIME SET " & (iAddTime / 1000)


        if Data.Item("CARDH" ) >0then
            SetVizDataFL "0120",1
            if Data.Item("CARDH" ) >1 then
                SetVizDataFL "0125",Data.Item("CARDH" )
            else
                SetVizDataFL "0125",""
            end if
            'SetVizDataFL "0110",1
            'obj__TV.DoEffect elFrontLayer, "KARTE_HEIM", efPlay
            'b__VisibleRedCardH=true
            obj__TV.SendCommand "RENDERER*FRONT_LAYER*STAGE*DIRECTOR*ROTEKARTE_HEIM SHOW 0.5"
        else
            SetVizDataFL "0120",0
            'SetVizDataFL "0110",0
            'b__VisibleRedCardH=false
        end if
        if Data.Item("CARDG")>0 then
            SetVizDataFL "0220",1
            if Data.Item("CARDG" ) >1 then
                SetVizDataFL "0225",Data.Item("CARDG" )
            else
                SetVizDataFL "0225",""
            end if
            'obj__TV.DoEffect elFrontLayer, "KARTE_GAST", efPlay
            'SetVizDataFL "0210",1
            'b__VisibleRedCardG=true
            obj__TV.SendCommand "RENDERER*FRONT_LAYER*STAGE*DIRECTOR*ROTEKARTE_GAST SHOW 0.5"
        else
            SetVizDataFL "0220",0
            'SetVizDataFL "0210",0
            'b__VisibleRedCardG=false
        end if
        'obj__TV.DoEffect elFrontLayer, "Default", efPlay
        DSS_Show=bAddTime
        'CC.Sf.Wait 500
        'If bAddTime Then obj__TV.DoEffect elFrontLayer, "OVERTIME", efPlay : b__VisibleADD = true

        call SetIniOption("VISIBLE_DSS", b__VisibleDSS)
        call SetIniOption("VISIBLE_CLOCK", b__VisibleClock)
        call SetIniOption("VISIBLE_ADD",  b__VisibleADD)
        call SetIniOption("VISIBLE_TEXT", b__VisibleText)
        call SetIniOption("VISIBLE_CARDH", b__VisibleRedCardH)
        call SetIniOption("VISIBLE_CARDG", b__VisibleRedCardG)
    End Function
    
    public sub DSS_Show_Start(ByRef Data)
        if Data("TIME_ISRUNNING") then
            obj__TV.SendCommand "CLOCK0 START"
            obj__TV.SendCommand "CLOCK1 START"  ' Ich glaube es ist egal wenn ich die jetzt schon Starte. Sie ist eh nicht eingeblendet
        else
            obj__TV.SendCommand "CLOCK0 STOP"
            obj__TV.SendCommand "CLOCK1 STOP"
        end if
        obj__TV.DoEffect elFrontLayer, "Default", efPlay

    end sub
    
    public sub DSS_Show_Start_Sponsor()
        obj__TV.DoEffect elFrontLayer, "SPONSOR", efPlay
    end sub

    public sub DSS_Show_Start_OT()
        obj__TV.DoEffect elFrontLayer, "OVERTIME", efPlay
        b__VisibleADD = true
        call SetIniOption("VISIBLE_ADD",  b__VisibleADD)
    end sub

    Public function DSS_Hide_OT()
        DSS_Hide_OT=false
        IF b__VisibleADD THEN
            obj__TV.DoEffect elFrontLayer, "OVERTIME", efContinue
            DSS_Hide_OT=true
            'cc.SF.Wait 350
        END IF
    end function
    
    Public function DSS_Hide_Text()
        DSS_Hide_Text=false
        IF b__VisibleADD THEN
            obj__TV.DoEffect elFrontLayer, "ZUSATZINFO", efContinue
            DSS_Hide_Text=true
            'cc.SF.Wait 350
        END IF
    end function

    Public Sub DSS_Hide()
        dssishiding=true
        if b__VisibleRedCardH then
            obj__TV.DoEffect elFrontLayer, "KARTE_HEIM", efContinue
        end if
        if b__VisibleRedCardG then
            obj__TV.DoEffect elFrontLayer, "KARTE_GAST", efContinue
        end if
        if b__VisibleClock then
            obj__TV.DoEffect elFrontLayer, "Default", efContinue
'            cc.SF.Wait 1000
        elseif b__VisibleDSS then       ' DSS und ERGEBNIS schließen sich gegenseitig aus!
            obj__TV.DoEffect elFrontLayer, "Default", efContinue
            'cc.SF.Wait 1000
        end if

        b__VisibleDSS   = False
        b__VisibleClock = False
        b__VisibleADD   = False
        b__VisibleText  = False
        b__VisibleRedCardH =false
        b__VisibleRedCardG =false
        call SetIniOption("VISIBLE_DSS", b__VisibleDSS)
        call SetIniOption("VISIBLE_CLOCK", b__VisibleClock)
        call SetIniOption("VISIBLE_ADD",  b__VisibleADD)
        call SetIniOption("VISIBLE_TEXT", b__VisibleText)
        call SetIniOption("VISIBLE_CARDH", b__VisibleRedCardH)
        call SetIniOption("VISIBLE_CARDG", b__VisibleRedCardG)
        dssishiding=false
    End Sub

    Public Sub Start_MainClock(ByRef Data)
        if not b__VisibleClock then exit sub
        dim iAddTime : iAddTime = Data.Item("INJURYTIME")
        dim bAddTime : bAddTime = (iAddTime > -1)
        obj__TV.SetClock 0, clLimit, Data.Item("MAINTIME_LIMIT")
        obj__TV.SendCommand "CLOCK1*TIME SET " & (iAddTime / 1000)
        obj__TV.SendCommand "CLOCK1 START"
        obj__TV.SendCommand "CLOCK0*TIME SET " &  TSP.GetTime(TSP_Time, 0) / 1000
        obj__TV.SetClock 0, clDirection, 1  ' Data.Item("MAINTIME_DIRECTION")
        obj__TV.SendCommand "CLOCK0 START"
    End Sub

    Public Sub Stop_MainClock(ByRef Data)
        if not b__VisibleClock then exit sub
        dim iAddTime : iAddTime = Data.Item("INJURYTIME")
        dim bAddTime : bAddTime = (iAddTime > -1)
        obj__TV.SetClock 0, clLimit, Data.Item("MAINTIME_LIMIT")
        obj__TV.SendCommand "CLOCK1 STOP"
        obj__TV.SendCommand "CLOCK1*TIME SET " & (iAddTime / 1000)
        obj__TV.SendCommand "CLOCK0 STOP "
        obj__TV.SendCommand "CLOCK0*TIME SET " & (Data.Item("MAINTIME") / 1000)
    End Sub


    Public Sub OnAdditionalTime(atime)
        if dssishiding=true then exit sub
       if not b__VisibleClock then exit sub
       dim time
       time=pgMain.ed_nachspiel.Text
       if not trim(time)="" then time= "+"&time
        SetVizDataFL "0360", time
      ' obj__TV.SendCommand "SCENE*" & s__VizPath & "/DSS_Uhr_ST*TREE*$DSS_Uhr$CLOCK1*TIME SET 0"
      obj__TV.SendCommand "CLOCK1*TIME SET "&atime
      ' obj__TV.SendCommand "SCENE*" & s__VizPath & "/DSS_Uhr_ST*TREE*$DSS_Uhr$CLOCK1 START"
      obj__TV.SendCommand "CLOCK1 START"
       if not b__VisibleADD then
           obj__TV.DoEffect elFrontLayer, "OVERTIME", efPlay
           b__VisibleADD = true
       end if
    End Sub

    Public Sub Update_MainScore(ByRef Data)
        if (not b__VisibleDSS) and (not b__VisibleClock) then exit sub
        SetVizDataFL "0150", Data.Item("T_AGGSCORE_1") & ":" & Data.Item("T_AGGSCORE_2")
        SetVizDataFL "0105", Data.Item("T_AGGSCORE_1")
        SetVizDataFL "0205", Data.Item("T_AGGSCORE_2")
    end Sub

    Public Sub DSS_Zusatz_Show(msg)

        if not b__VisibleDSS then exit sub
        if getGFXV =2 then
            DSS_Zusatz_Show_WF msg
        	exit sub
        end if
        SetVizDataFL "0500", msg
        if not b__VisibleText then
            obj__TV.DoEffect elFrontLayer, "ZUSATZINFO", efPlay
        end if
        b__VisibleText = True
    end Sub
    Public Sub DSS_Zusatz_Show_WF(msg)

        if not b__VisibleDSS then exit sub
        SetVizDataUpperFL "8000", msg
        if not b__VisibleText then
            obj__TV.DoEffect elFrontLayer, "FREETEXT", efPlay
        end if
        b__VisibleText = True
    end Sub



    Public Sub DSS_Zusatz_Hide()
        if getGFXV =2 then
            DSS_Zusatz_Hide_WF
        	exit sub
        end if
        IF b__VisibleText THEN
            obj__TV.DoEffect elFrontLayer, "ZUSATZINFO", efContinue
        END IF
        b__VisibleText = False
    end Sub
    
    Public Sub DSS_Zusatz_Hide_WF()
        IF b__VisibleText THEN
            obj__TV.DoEffect elFrontLayer, "FREETEXT", efContinue
        END IF
        b__VisibleText = False
    end Sub
    

    
    public sub DSS_Nachspielzeit(time)
        dim t
        t=time
        if not trim(t)="" then t= "+"&t
        SetVizDataFL "0360", t
    end sub

    Public Sub DSS_Card_Show(ch,cg)
        if not b__VisibleDSS then exit sub
         if ch >0then
            SetVizDataFL "0120",1
            if ch > 1 then
               SetVizDataFL "0125",ch
            else
                SetVizDataFL "0125",""
                'obj__TV.DoEffect elFrontLayer, "ROTEKARTE_HEIM", efPlay
            end if
            obj__TV.SendCommand "RENDERER*FRONT_LAYER*STAGE*DIRECTOR*ROTEKARTE_HEIM SHOW 0.5"
        else
            SetVizDataFL "0120",0
            obj__TV.DoEffect elFrontLayer, "ROTEKARTE_HEIM", efReset
        end if
        if cg then
            SetVizDataFL "0220",1
            if cg > 1 then
               SetVizDataFL "0225",cg
            else
                SetVizDataFL "0225",""
                'obj__TV.DoEffect elFrontLayer, "ROTEKARTE_GAST", efPlay
            end if
            obj__TV.SendCommand "RENDERER*FRONT_LAYER*STAGE*DIRECTOR*ROTEKARTE_GAST SHOW 0.5"
        else
            SetVizDataFL "0220",0
            obj__TV.DoEffect elFrontLayer, "ROTEKARTE_GAST", efReset
        end if
    end Sub

    Public Sub DSS_Card_Hide(dir)
        if dir="H" then
            IF b__VisibleRedCardH THEN
                obj__TV.DoEffect elFrontLayer, "KARTE_HEIM", efContinue
                cc.SF.Wait 350
            END IF
            b__VisibleRedCardH = False
        else
            IF b__VisibleRedCardG THEN
                obj__TV.DoEffect elFrontLayer, "KARTE_GAST", efContinue
                cc.SF.Wait 350
            END IF
            b__VisibleRedCardG = False
        end if

    end Sub


     public sub DSS_Sponsor_Hide()
        obj__TV.DoEffect elFrontLayer, "FLASH_SPONSOR", efContinue
        'cc.sf.Wait 200
        'obj__TV.DoEffect elFrontLayer, "FLASH_SPONSOR", efReset
    end sub

    public sub DSS_Sponsor_Show(nr)
        ' SIEMIC Dieser Sponsor geht nur wenn der DSS NICHT sichtbar ist!!!
        SetVizDataFL "0011",""
        if nr = "3" then    ' "Unterstützt durch Produkt Platzierung"
            sScene = "DSS_Uhr"
            'if not i_variant=1 then exit sub
            obj__TV.RendererUpdate false
            obj__TV.SetScene sScene
            obj__TV.LoadScene elFrontLayer
            obj__TV.DoEffect elFrontLayer, "ALL", efReset
            obj__TV.RendererUpdate true
            SetVizDataFL "0010","IMAGE*"&s__LogoPathDiv & "/" &"PRODUKTPLAZIERUNG"
            obj__TV.DoEffect elFrontLayer, "FLASH_SPONSOR", efPlay
            exit sub
        end if

        if not (b__VisibleClock or b__VisibleDSS) then exit sub
        if nr = "1" then         '        => EINAUS_ADMIRAL / EINAUS_KURIER
            SetVizDataFL "0010","IMAGE*"&s__LogoPathDiv & "/" &"Admiral"

        else
            SetVizDataFL "0010","IMAGE*"&s__LogoPathDiv & "/" &"Kurier"
        end if
        SetVizDataFL "0001",0
        obj__TV.DoEffect elFrontLayer, "SPONSOR", efPlay
    end sub

    Public Function ClearAll()
        ClearAll=false
        If obj__TV is Nothing Then Exit function

        if s__LastAnim <> "" Then
            obj__TV.DoEffect elMainLayer, s__LastAnim, efContinue
            ClearAll=true
            obj__TV.DoEffect elMainLayer, "SPONSOR", efReset
        end if
        s__LastAnim = ""
        SetIniOption "LAST_SCENE", s__LastAnim

        ReDim ActionList(1, 0)
        ActionList(0, 0) = ""
    End function


    'Lädt Scene in Viz >> Synchron
    Private Sub SetScene(ByVal sScene)
        obj__TV.OpenProject s__VizPath
        obj__TV.SetScene sScene
    End Sub

    Private Sub LoadScene(ByVal strLayer, ByVal sScene)
        ExportData.Removeall
        ExportDataTyp.Removeall
        ExportDataDesc.Removeall
        if tw_gfx_select.cb_prepare_ar.Checked=true and strLayer=22 then
            obj__TV.DoEffect 2, "ALL", efReset
            CC.SF.ShowSplashForm "VIZ is loading scene " & sScene & " ... ", clYellow

            obj__TV.OpenProject s__VizPathAR
            obj__TV.RendererUpdate false

            obj__TV.SendCommandEx("POOLS CLEANUP")
            obj__TV.SetScene sScene&"_AR"
          '  cc.SF.TimerSet

            ' SIEMIC:   TODO  If Kill_Bill switch is set, terminate this routine instantly
            sLayer = "MAIN_LAYER"
            s_ARScene=sScene&"_AR"
            sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & " SET_OBJECT SCENE*" & s__VizPathAR & "/" & sScene&"_AR")
            sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")

            Prepare_Layer strLayer

            obj__TV.RendererUpdate true

            CC.SF.HideSplashForm
            ExportData.Add "SVIZPATH",s__VizPathAR
            ExportData.Add "SVIZSCENE",sScene&"_AR"
        else
            MasterClearAll i_variant                 ' Das passt mir nicht! Egal in welchen Layer ich was lade er blendet alle aus?
           ' cc.SF.DebugText "Loading Scene '" & sScene & "' ..."
            CC.SF.ShowSplashForm "VIZ is loading scene " & sScene & " ... ", clYellow

            obj__TV.OpenProject s__VizPath
            obj__TV.RendererUpdate false

            obj__TV.SendCommandEx("POOLS CLEANUP")
            obj__TV.SetScene sScene
          '  cc.SF.TimerSet

            ' SIEMIC:   TODO  If Kill_Bill switch is set, terminate this routine instantly
            dim sLayer
            If strLayer = 1 Then
               sLayer = "FRONT_LAYER"
            ElseIf strLayer = 2 Then
               sLayer = "MAIN_LAYER"
            ElseIf strLayer = 3 Then
               sLayer = "BACK_LAYER"
            End If
            dim sResult
            s_ARScene=sScene
            sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & " SET_OBJECT SCENE*" & s__VizPath & "/" & sScene)
            sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")

            Prepare_Layer strLayer

            obj__TV.RendererUpdate true
            CC.SF.HideSplashForm
            ExportData.Add "SVIZPATH",s__VizPath
            ExportData.Add "SVIZSCENE",sScene
            ExportDataTyp.Add "SVIZSCENE","system"
            ExportDataTyp.Add "SVIZPATH","system"
        end if
'        cc.SF.Wait 250
 '      cc.SF.DebugText "Scene '" & sResult & "' loaded in " & cc.SF.TimerGet & "ms ..."
    End Sub
    
    Private Sub LoadSceneWF(ByVal strLayer, ByVal sScene)
            ExportData.RemoveAll
            ExportDataTyp.Removeall
            ExportDataDesc.Removeall
            MasterClearAll i_variant                 ' Das passt mir nicht! Egal in welchen Layer ich was lade er blendet alle aus?
           ' cc.SF.DebugText "Loading Scene '" & sScene & "' ..."
            CC.SF.ShowSplashForm "VIZ is loading scene " & sScene & " ... ", clYellow

            obj__TV.OpenProject s__VizPathWF
            obj__TV.RendererUpdate false

            obj__TV.SendCommandEx("POOLS CLEANUP")
            obj__TV.SetScene sScene
          '  cc.SF.TimerSet

            ' SIEMIC:   TODO  If Kill_Bill switch is set, terminate this routine instantly
            dim sLayer
            If strLayer = 1 Then
               sLayer = "FRONT_LAYER"
            ElseIf strLayer = 2 Then
               sLayer = "MAIN_LAYER"
            ElseIf strLayer = 3 Then
               sLayer = "BACK_LAYER"
            End If
            dim sResult
            s_ARScene=sScene
            sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & " SET_OBJECT SCENE*" & s__VizPathWF & "/" & sScene)
            sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")

            Prepare_Layer strLayer

            obj__TV.RendererUpdate true
            CC.SF.HideSplashForm
            
            ExportData.Add "SVIZPATH",s__VizPathWF
            ExportData.Add "SVIZSCENE",sScene
            ExportDataTyp.Add "SVIZSCENE","system"
            ExportDataTyp.Add "SVIZPATH","system"
    End Sub


    Private Sub LoadScene2(ByVal strLayer, ByVal sScene)
        'ClearAll                  ' Das passt mir nicht! Egal in welchen Layer ich was lade er blendet alle aus?
       ' cc.SF.DebugText "Loading Scene '" & sScene & "' ..."
        CC.SF.ShowSplashForm "VIZ is loading scene " & sScene & " ... ", clYellow

        obj__TV.OpenProject s__VizPath
        obj__TV.RendererUpdate false

        obj__TV.SendCommandEx("POOLS CLEANUP")
        obj__TV.SetScene sScene
      '  cc.SF.TimerSet

        ' SIEMIC:   TODO  If Kill_Bill switch is set, terminate this routine instantly
        dim sLayer
        If strLayer = 1 Then
           sLayer = "FRONT_LAYER"
        ElseIf strLayer = 2 Then
           sLayer = "MAIN_LAYER"
        ElseIf strLayer = 3 Then
           sLayer = "BACK_LAYER"
        End If
        dim sResult
        sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & " SET_OBJECT SCENE*" & s__VizPath & "/" & sScene)
        sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")

        Prepare_Layer strLayer

        obj__TV.RendererUpdate true
        CC.SF.HideSplashForm
'        cc.SF.Wait 250
 '      cc.SF.DebugText "Scene '" & sResult & "' loaded in " & cc.SF.TimerGet & "ms ..."
    End Sub

    Private Sub LoadSceneAR(ByVal strLayer, ByVal sScene)
        CC.SF.ShowSplashForm "VIZ is loading scene " & sScene & " ... ", clYellow

        obj__TV.OpenProject s__VizPathAR
        obj__TV.SetScene sScene
        dim sLayer
        If strLayer = 1 Then
           sLayer = "FRONT_LAYER"
        ElseIf strLayer = 2 Then
           sLayer = "MAIN_LAYER"
        ElseIf strLayer = 3 Then
           sLayer = "BACK_LAYER"
        End If
        dim sResult
        sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & " SET_OBJECT SCENE*" & s__VizPathAR & "/" & sScene)
        sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")

        Prepare_Layer strLayer
        obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*1*STAGE SHOW 0.0")
        CC.SF.HideSplashForm
    End Sub

    Private Sub LoadSceneEx(ByVal strLayer, ByVal sScene, ByVal inPos, ByVal outPos)
        MasterClearAll i_variant
        obj__TV.OpenProject s__VizPath
        obj__TV.RendererUpdate false

        obj__TV.SendCommandEx("POOLS CLEANUP")
        obj__TV.SetScene sScene
        cc.SF.TimerSet
        If strLayer = 1 Then
           sLayer = "FRONT_LAYER"
        ElseIf strLayer = 2 Then
           sLayer = "MAIN_LAYER"
        ElseIf strLayer = 3 Then
           sLayer = "BACK_LAYER"
        End If
        sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & " SET_OBJECT SCENE*" & s__VizPath & "/" & sScene)
        sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")

        obj__TV.SendCommandEx("RENDERER*" & sLayer & "*TREE*$clip_in*FUNCTION*imageClip*animPos SET 5" )'& CStr(inPos) )
        obj__TV.SendCommandEx("RENDERER*" & sLayer & "*TREE*$clip_out*FUNCTION*imageClip*animPos SET 5" )' & CStr(outPos))

        Prepare_Layer strLayer

        obj__TV.RendererUpdate true

        'cc.SF.DebugText "Scene '" & sResult & "' loaded in " & cc.SF.TimerGet & "ms ..."
        cc.SF.Wait 2500
    End Sub



    'Numeric to Layer in Viz
    Private Function GetLayer(ByVal intLayer)
        Select Case intLayer
            Case 1 : GetLayer = elFrontLayer
            Case 2 : GetLayer = elMainLayer
            Case 3 : GetLayer = elBackLayer
        End Select
    End Function

    Private Sub Prepare_Layer(ByVal strLayer)
        obj__TV.DoEffect strLayer, "ALL", efReset
    End Sub

    'Set Text in VIZ
    Private Sub SetText(ByVal sObject, ByVal sContent)
        obj__TV.SetContent sObject, objText, sContent
    End Sub

    'Set Image in VIZ
    Private Sub SetImg(ByVal sObject, ByVal sContent)
        obj__TV.SetContent sObject, objImage, sContent
    End Sub

    'Set Object in VIZ
    Private Sub SetObj(ByVal sObject, ByVal sContent)
        obj__TV.SetContent sObject, objObject, sContent
    End Sub

    'Preview ziehen von entsprechender Animation und Frame
    Public Sub GetPreview(ByVal PrevData, ByVal intFrame, ByVal sScene)
    if not i_variant=1 then exit sub
        Dim sCmd
        'If tw_preview.Visible Then
            If IsArray(PrevData) Then
               iCount = UBound(PrevData)
               For i = 0 to iCount
                   strPrevCmd = strPrevCmd & PrevData(i) & " "
               Next
               strPrevCmd = Trim(strPrevCmd)
               if tw_gfx_select.cb_prepare_ar.Checked=true then
                    obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathAR & "/" & sScene & "_AR VIDEO " & strPrevCmd
               else
                    obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPath & "/" & sScene & " VIDEO " & strPrevCmd
               end if
            Else
                if tw_gfx_select.cb_prepare_ar.Checked=true then
                    obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathAR & "/" & sScene & "_AR VIDEO " & PrevData & " " & intFrame
                else
                   obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPath & "/" & sScene & " VIDEO " & PrevData & " " & intFrame
               end if
            End If

           call obj__TV.GetPreview(PrevData, intFrame, 1, "d:\Preview.jpg")
           tw_preview.img_preview.LoadFromFile "d:\Preview.jpg"
        'end If
        s_pngscene=sScene
        pnggenerate="RENDERER PREVIEW SCENE*" & s__VizPath & "/" & sScene & " "&pg_settings.tb_thumbnailpath_viz.Text&"?SUBPATH?\?FILENAME?.png "& PrevData & " " & intFrame
        if pg_settings.rb_thumbsnail.ItemIndex=1 and tw_gfx_select.cb_prepare_ar.Checked=false then
            'obj__TV.SendCommand("RENDERER PREVIEW_SIZE -1 -1")
            'Replace(pnggenerate,"?FILENAME?",TimeStamp&"_"&sScene
            'obj__TV.SendCommand(pnggenerate)
            ExportPNG(TimeStamp&"_"&sScene)
            ExportPNG(sScene)
        end if

    End Sub

     Public Sub GetPreviewWF(ByVal PrevData, ByVal intFrame, ByVal sScene)
     if not i_variant=1 then exit sub
        Dim sCmd
        'If tw_preview.Visible Then
            If IsArray(PrevData) Then
               iCount = UBound(PrevData)
               For i = 0 to iCount
                   strPrevCmd = strPrevCmd & PrevData(i) & " "
               Next
               strPrevCmd = Trim(strPrevCmd)
               if tw_gfx_select.cb_prepare_ar.Checked=true then
                    obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathAR & "/" & sScene & "_AR VIDEO " & strPrevCmd
               else
                    obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathWF & "/" & sScene & " VIDEO " & strPrevCmd
               end if
            Else
                if tw_gfx_select.cb_prepare_ar.Checked=true then
                    obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathAR & "/" & sScene & "_AR VIDEO " & PrevData & " " & intFrame
                else
                   obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathWF & "/" & sScene & " VIDEO " & PrevData & " " & intFrame
               end if
            End If
            obj__TV.OpenProject s__VizPathWF
            obj__TV.SetScene sScene
           call obj__TV.GetPreview(PrevData, intFrame, 1, "d:\Preview.jpg")
           tw_preview.img_preview.LoadFromFile "d:\Preview.jpg"
        'end If
        s_pngscene=sScene
        pnggenerate="RENDERER PREVIEW SCENE*" & s__VizPathWF & "/" & sScene & " "&pg_settings.tb_thumbnailpath_viz.Text&"?SUBPATH?\?FILENAME?.png "& PrevData & " " & intFrame
        if pg_settings.rb_thumbsnail.ItemIndex=1 and tw_gfx_select.cb_prepare_ar.Checked=false then
            'obj__TV.SendCommand("RENDERER PREVIEW_SIZE -1 -1")
            'obj__TV.SendCommand("RENDERER PREVIEW SCENE*" & s__VizPathWF & "/" & sScene & " "&pg_settings.tb_thumbnailpath.Text&  "\"&TimeStamp&"_"&sScene&".png " & PrevData & " " & intFrame)
            'Replace(pnggenerate,"?FILENAME?",TimeStamp&"_"&sScene)
            'obj__TV.SendCommand(pnggenerate)
            ExportPNG(TimeStamp&"_"&sScene)
        end if

    End Sub

    public sub ExportPNG(filename)
        if i_variant=1 then
            dim f
            dim subpath
            subpath=GetSubPath()
            obj__TV.SendCommand("RENDERER PREVIEW_SIZE -1 -1")
            f=Replace( pnggenerate,"?SUBPATH?",subpath)
            f=Replace( f,"?FILENAME?",filename)
            'cc.sf.DebugText filename
            'cc.sf.DebugText pnggenerate
            'cc.SF.DebugText f
            obj__TV.SendCommand(f)
        end if
    end sub

    ' Löscht den Preview
    Public Sub ClearPreview()
        IF trim(sScene) = "" THEN
            obj__TV.SendCommand "RENDERER PREVIEW CURRENT VIDEO ALL 0.0"
        ELSE
            if tw_gfx_select.cb_prepare_ar.Checked=true then
                obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPathAR & "/" & sScene & "_AR VIDEO Default 0.0"
            else
                obj__TV.SendCommand "RENDERER PREVIEW SCENE*" & s__VizPath & "/" & sScene & " VIDEO Default 0.0"
            end if
        END IF
        displaysponsor=""
    End Sub

     public sub Quoten( ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "BB_Admiral_Quoten"
        LoadScene elMainLayer, sScene
        dim con

        obj__TV.HideObject "EINAUS_DREIERQUOTE"
        obj__TV.HideObject "EINAUS_ZWEIERQUOTE"
        if Data.Item("TYP") then
            con="EINAUS_DREIERQUOTE"
            SetText con&"$txt_Quote_1", UCase(Data.Item("Q1"))
            SetText con&"$txt_Quote_2", UCase(Data.Item("Q2"))
            SetText con&"$txt_Quote_3", UCase(Data.Item("Q3"))
        else
            con="EINAUS_ZWEIERQUOTE"
            SetText con&"$txt_Quote_1", UCase(Data.Item("Q1"))
            SetText con&"$txt_Quote_2", UCase(Data.Item("Q3"))
        end if

        obj__TV.showObject con
        SetText con&"$txt_TeamHeim", UCase(Data.Item("NAME1"))
        SetText con&"$txt_TeamGast", UCase(Data.Item("NAME2"))


        GetPreview "Default", "1.1", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    'Propertys
    Public Property Get TVLanguage()
        TVLanguage = i__TVLanguage
    End Property
    Public Property Let TVLanguage(ByVal intNewData)
        i__TVLanguage = intNewData
    End Property
    Public Property Get TVContent()
        TVContent = i__TVContent
    End Property
    Public Property Let TVContent(ByVal intNewData)
        i__TVContent = intNewData
    End Property
    Public Property Get TVObj()
        Set TVObj = obj__TV
    End Property
    Public Property Set TVObj(ByRef Data)
        Set obj__TV = Data
        If Not obj__TV Is Nothing Then
        End If
    End Property
    'L-Forms
    public sub LF_Info( ByRef Data)
    	if getGFXV =2 then
            LF_Info_WF Data
            exit sub
        end if
        dim i
        dim ids
        dim dir
        sScene = "VB_Lframe7030_Aut_Fussball"
        LoadScene elMainLayer, sScene
        SetShow
        obj__TV.DoEffect elMainLayer,  "ALL", efReset
        SetBGOnOff
        SetTitelDefaultHeaderLF

        if Data.item("BBTYP") = 0 then
            SetVizData "970000",3 ,"int",""
            SetVizData "990100",Data.Item("BBHL"),"string","BB Headline"
            SetVizData "990102",""  ,"string",""
            SetVizData "990200",Data.Item("BBSL"),"string","BB Subline"
        elseif Data.item("BBTYP") = 1 then
            SetVizData "970000",2  ,"int",""
            SetVizData "980149",0  ,"int",""
            SetVizData "980150","vs" ,"string",""
            SetVizData "980100",Data.Item("NAME1")  ,"string","Name A"
            SetVizData "980200",Data.Item("NAME2") ,"string","Name B"
            SetTeamLogo "980090", Data.Item("LOGO1") ,"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"Logo B"
            SetVizData "981100",Data.Item("BBSL"),"string","BB Subline"
        elseif Data.item("BBTYP") = 2 then
            SetVizData "970000",2 ,"int",""
            SetVizData "980149",1 ,"int",""
            SetVizData "980150",Data.Item("BBSCORE") ,"string","BB Score"
            SetVizData "980100",Data.Item("NAME1") ,"string","Name A"
            SetVizData "980200",Data.Item("NAME2")  ,"string","Name B"
            SetTeamLogo "980090", Data.Item("LOGO1") ,"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2") ,"Logo B"
            SetVizData "981100",Data.Item("BBSL")  ,"string","BB Subline"

        else
            SetVizData "970000",3 ,"int",""
            SetVizData "990100",Data.Item("BBHL") ,"string","BB Headline"
            SetVizData "990102",""  ,"string",""
            SetVizData "990200",Data.Item("BBSL"),"string","BB Subline"
        end if

        select case Data.item("STYP")
        case "0"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*AUFSTELLUNG_HEIM START"& Chr(34)
            dir= "AUFSTELLUNG_HEIM"
            SetVizData "110500",Data.Item("TEAMNAMEA") ,"string","Team Name A"
            SetVizData "120500",Data.Item("TEAMNAMEB"),"string","Team Name B"
            SetLFTitle "Aufstellung"
            ids=111100
            for i=1 to 11
                SetVizDataBufferOn
                SetVizData ids,Data.Item("TEAMNRA"&i) ,"string","Team Nr A "&i
                SetVizData ids+2,Data.Item("TEAMNAMEA"&i),"string","Team Player A "&i
                SetVizData ids+10000,Data.Item("TEAMNRB"&i),"string","Team Nr B "&i
                SetVizData ids+10002,Data.Item("TEAMNAMEB"&i),"string","Team Player B "&i
                SetVizDataBufferOff
                ids=ids+100
            next
        case "1"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*TABELLE_1 START"& Chr(34)
            dir= "TABELLE_1"
            'SetText "TABELLE$txt_Titel", UCase(Data.Item("TABHL"))
            SetLFTitle Data.Item("TABHL")
            ids=91100
            SetVizData "090501","" ,"string",""
            for i = 1 to 10                   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("TABPLACE"&i),"string","Tab Place "&i
                SetVizData "0"&ids+2,Data.Item("TABNAME"&i),"string","Tab Teamname "&i
                SetVizData "0"&ids+3,"" ,"string",""
                SetVizData "0"&ids+6,Data.Item("TABPTS"&i),"string","Tab Points "&i

                

                if false then
                if     i = 2 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 2 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 3 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 4 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 9 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 9 = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 255/255 & " " & 10 / 255 & " " & 20 / 255 & vbNullChar
                    end if
                end if
                end if
                SetVizDataBufferOff
                ids=ids+100
            next

            SetVizData "000100", Data.Item("REHL") ,"string","Erg Headline"
            SetVizData "070500", "" ,"string",""
            ids=71102
            for i=1 to 5
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("RENAMEA"&i) ,"string","Erg Name A "&i
                SetVizData "0"&ids+2,Data.Item("RERESULT"&i) ,"string","Erg Result "&i
                SetVizData "0"&ids+4,Data.Item("RENAMEB"&i) ,"string","Erg Name B "&i
            SetVizDataBufferOff
                ids=ids+100
            next
            SetVizData "070004",5  ,"int",""

        case "2"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*ERGEBNISSE START"& Chr(34)
            dir= "ERGEBNISSE"
            SetVizData "000100", Data.Item("REHL") ,"string","Erg Headline"
            SetVizData "070500", "" ,"string",""
            ids=71102
            for i=1 to 5
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("RENAMEA"&i) ,"string","Erg Name A "&i
                SetVizData "0"&ids+2,Data.Item("RERESULT"&i),"string","Erg Result "&i
                SetVizData "0"&ids+4,Data.Item("RENAMEB"&i) ,"string","Erg Name B "&i
                SetVizDataBufferOff
                ids=ids+100
            next
            SetVizData "070004",5 ,"int",""
            'SetLFTitle "Ergebnisse"
            'SetText "TABELLE$txt_Titel", UCase(Data.Item("TABHL"))
            ids=91100
            SetVizData "090501","" ,"string",""
            for i = 1 to 10                   ' FULL STANDINGS TABLE
            SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("TABPLACE"&i) ,"string","Tab Place "&i
                SetVizData "0"&ids+2,Data.Item("TABNAME"&i) ,"string","Tab Teamname "&i
                SetVizData "0"&ids+3,"" ,"string",""
                SetVizData "0"&ids+6,Data.Item("TABPTS"&i) ,"string","Tab Points "&i


                if false then
                if     i = 2 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 2 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 3 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 4 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 9 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 9 = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 255/255 & " " & 10 / 255 & " " & 20 / 255 & vbNullChar
                    end if
                end if
                end if
                SetVizDataBufferOff
                ids=ids+100
            next


        case "3"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*FAHRPLAN START"& Chr(34)
            dir= "FAHRPLAN"
            SetLFTitle Data.Item("GHL")
            SetVizData "150500", Data.Item("GSL")  ,"string","Subline"
            ids=151101
            for i=1 to 5
                SetVizData ids,Data.Item("GKOM"&i) ,"string","Game "&i
                'SetImg  "SPIELE$SPIEL_"&i&"$img_LogoHeim_"&i, s__LogoPath & "\" & LCase(Data.Item("GLOGOA"&i))
                'SetImg  "SPIELE$SPIEL_"&i&"$img_LogoGast_"&i, s__LogoPath & "\" & LCase(Data.Item("GLOGOB"&i))
                ids=ids+1
            next
            SetVizData "150004",Data.Item("GITEMCOUNT"),"int","Game Count"
        end select

        GetPreview "Default 3.0", dir&" 3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub LF_Info_WF( ByRef Data)
        dim i
        dim ids
        dim dir
        sScene = "VB_Lframe_Tabelle"
        if Data.Item("ANIM_TYPE") <> 0 then sScene="VB_Lframe_ERG_Tabelle_3_6"
        'if pg_settings.rb_opmode.ItemIndex=1 then  sScene=sScene&"_KONF"
        LoadSceneWF elMainLayer, sScene
        SetCommercialOnOff "LFrame Info"
        dir="TABELLE"
        obj__TV.DoEffect elMainLayer,  "ALL", efReset
        SetBGOnOff

        if Data.item("STYP")="2" then
            SetVizData "0001",0 ,"int","Typ"
        else
            SetVizData "0001",1 ,"int","Typ"
        end if

        SetVizDataUpper "10100",Data.Item("BBHL") ,"string","BB Headline"
        SetVizDataUpper "10200",Data.Item("BBSL") ,"string","BB Subline"
        'SetTeamLogo "0090",Data.Item("LOGO1")
        SetVizData "10000","IMAGE*"&s__LogoPathDiv & "/" &"ofbl_Ball" ,"image","Image"

        SetVizDataUpper "2100", Data.Item("TABHL"),"string","Tab Headline"
        ids=2110
        dim s,e
        if Data.Item("ANIM_TYPE") =0 then
            s=1
            e=12
        elseif Data.Item("ANIM_TYPE")=1 then
            s=1
            e=6
        else
            s=7
            e=12
        end if
        for i = s to e                   ' FULL STANDINGS TABLE
            SetVizDataBufferOn
            SetVizData ids,Data.Item("TABPLACE"&i),"string","Tab Place "&i
            SetVizDataUpper ids+1,Data.Item("TABNAME"&i) ,"string","Tab Team "&i
            SetVizData ids+2,Data.Item("TABGAMES"&i),"string","Tab Games "&i
            SetVizData ids+3,Data.Item("TABGOALS"&i),"string","Tab Goals "&i
            SetVizData ids+4,Data.Item("TABDIFF"&i),"string","Tab Diff "&i
            SetVizData ids+5,Data.Item("TABPTS"&i) ,"string","Tab Points "&i

            SetVizDataBufferOff
            ids=ids+100
        next
        
        SetVizDataUpper "4000", Data.Item("REHL"),"string","Result Headline"
        ids=4005
        if Data.Item("ANIM_TYPE") =0 then
            s=1
            e=6
        elseif Data.Item("ANIM_TYPE")=1 then
            s=1
            e=3
        else
            s=4
            e=6
        end if
        for i=s to e
           SetVizDataBufferOn
            SetVizData ids,0 ,"int",""
            SetVizDataUpper ids+5,Data.Item("RENAMEA" & i) ,"string","Res Name A "&i
            SetTeamLogo ids+10, Data.Item("RELOGOA" & i),"Res Logo A "&i
            SetVizDataUpper ids+15,Data.Item("RENAMEB" & i) ,"string","Res Name B "&i 
            SetTeamLogo ids+20, Data.Item("RELOGOB" & i),"Res Logo B "&i
            SetVizData ids+1,Data.Item("RERESULT" & i)  ,"string","Res Result "&i

            SetVizDataBufferOff
            ids=ids+1000
        next

        GetPreviewWF "Default 2.82", dir&" 2.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub LF_Interview( ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        dim ids
        dim dir
        if Data.item("STYP")=1 or Data.item("STYP")=2 then
            sScene = "VB_Lframe_5050_Aut_Fussball"
        else
            sScene = "VB_Lframe_5050"
        end if

        LoadScene elMainLayer, sScene
        SetShow
        obj__TV.DoEffect elMainLayer,  "ALL", efReset

        SetBGOnOff
        SetTitelDefaultHeaderLF

        if Data.item("BBTYP") = 0 then
            if Data.Item("BBSTATTYP") = 0 then
                SetVizData "970000",3 ,"int",""
                SetVizData "990100",Data.Item("BBHL") ,"string","BB Headline"
                SetVizData "990102",""  ,"string",""
                SetVizData "990200",Data.Item("BBSL") ,"string","BB Subline"

            else
                SetVizData "970000",1 ,"int",""
                SetVizData "970100",Data.Item("BBHL") ,"string","BB Headline"
                SetVizData "970102",Data.Item("FNAME")  ,"string","BB Player Name"
                SetVizData "970120",Data.Item("BBSL") ,"string","BB Subline"
                SetVizData "970095",Data.Item("NR")   ,"string","BB Player Number"
                ids=971110
                for i=1 to 3
                    SetVizData ids,Data.Item("BBSTATTEXT"&i),"string","BB Stat "&i
                    SetVizData ids+5,Data.Item("BBSTATVALUE"&i),"string","BB Value "&i
                    ids=ids+100
                next
                SetVizData 970005,3 ,"int",""
                SetTeamLogo 970090,LCase(Data.Item("LOGO1")),"BB Logo A"
            end if
        elseif Data.item("BBTYP") = 1 then
            SetVizData "970000",2  ,"int",""
            SetVizData "980149",0  ,"int",""
            SetVizData "980150","vs" ,"string",""
            SetVizData "980100",Data.Item("NAME1") ,"string","BB Name A"
            SetVizData "980200",Data.Item("NAME2") ,"string","BB Name B"
            SetTeamLogo "980090", Data.Item("LOGO1"),"BB Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"BB Logo B"
            SetVizData "981100",Data.Item("BBSL") ,"string","BB Subline"
        elseif Data.item("BBTYP") = 2 then
            SetVizData "970000",2 ,"int",""
            SetVizData "980149",1 ,"int",""
            SetVizData "980150",Data.Item("BBSCORE") ,"string","BB Score"
            SetVizData "980100",Data.Item("NAME1") ,"string","BB Name A"
            SetVizData "980200",Data.Item("NAME2")  ,"string","BB Name B"
            SetTeamLogo "980090", Data.Item("LOGO1"),"BB Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2") ,"BB Logo B"
            SetVizData "981100",Data.Item("BBSL")  ,"string","BB Subline"

        else
            SetVizData "970000",3 ,"int",""
            SetVizData "990100",Data.Item("BBHL") ,"string","BB Headline"
            SetVizData "990102","" ,"string",""
            SetVizData "990200",Data.Item("BBSL") ,"string","BB Subline"
        end if
        SetLFTitle Data.Item("SHL")
        select case Data.item("STYP")
        case "0"   'MF

            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*MEGAFACTS START"& Chr(34)
            dir="MEGAFACTS"
            SetVizData "020500" ,"","string",""
            ids=21102
            for i=1 to 5
                SetVizData "0"&ids,Data.Item("MF1"&i) ,"string","MF 1 "&i
                SetVizData "0"&ids+1,Data.Item("MF2"&i) ,"string","MF 2 "&i
                ids=ids+100

            next
            SetVizData "020004",Data.Item("MFITEMCOUNT"),"int","MF Count"
        case "1"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*TABELLE_1 START"& Chr(34)
            dir="TABELLE_1"
            'SetText "TABELLE$txt_Titel", UCase(Data.Item("TABHL"))

            ids=91100

            for i = 1 to 10                   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("TABPLACE"&i) ,"string","Tab Place "&i
                SetVizData "0"&ids+2,Data.Item("TABNAME"&i),"string","Tab Team "&i
                SetVizData "0"&ids+3,Data.Item("TABGAMES"&i) ,"string","Tab Games "&i
                SetVizData "0"&ids+6,Data.Item("TABPTS"&i)  ,"string","Tab Points "&i
                SetVizData "0"&ids+4,Data.Item("TABGOALS"&i) ,"string","Tab Goals "&i
                SetVizData "0"&ids+5,Data.Item("TABDIFF"&i) ,"string","Tab Diff "&i

                if false then
                if     i = 2 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 2 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 3 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 4 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 9 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 9 = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 255/255 & " " & 10 / 255 & " " & 20 / 255 & vbNullChar
                    end if
                end if
                end if
                SetVizDataBufferOff
                ids=ids+100
            next

            SetVizData "070500", Data.Item("REHL") ,"string","Result Headline"
            ids=71102
            for i=1 to 5
            SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("RENAMEA"&i) ,"string","Res Name A "&i
                SetVizData "0"&ids+2,Data.Item("RERESULT"&i) ,"string","Res Result "&i
                SetVizData "0"&ids+4,Data.Item("RENAMEB"&i) ,"string","Res Name B "&i
                SetVizDataBufferOff
                ids=ids+100
            next
            SetVizData "070004",5 ,"int",""

        case "2"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*ERGEBNISSE START"& Chr(34)
            dir="ERGEBNISSE"
            SetVizData "070500", Data.Item("REHL") ,"string","Result Headline"
            ids=71102
            for i=1 to 5
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("RENAMEA"&i) ,"string","Res Name A "&i
                SetVizData "0"&ids+2,Data.Item("RERESULT"&i),"string","Res Result "&i
                SetVizData "0"&ids+4,Data.Item("RENAMEB"&i) ,"string","Res Name B "&i
                SetVizDataBufferOff
                ids=ids+100
            next
            SetVizData "070004",5 ,"int",""

            'SetText "TABELLE$txt_Titel", UCase(Data.Item("TABHL"))
            ids=91100
            for i = 1 to 10                   ' FULL STANDINGS TABLE
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("TABPLACE"&i),"string","Tab Place "&i
                SetVizData "0"&ids+2,Data.Item("TABNAME"&i),"string","Tab Team "&i
                SetVizData "0"&ids+3,Data.Item("TABGAMES"&i) ,"string","Tab Gamse "&i
                SetVizData "0"&ids+6,Data.Item("TABPTS"&i)   ,"string","Tab Points "&i
                SetVizData "0"&ids+4,Data.Item("TABGOALS"&i) ,"string","Tab Goals "&i
                SetVizData "0"&ids+5,Data.Item("TABDIFF"&i)  ,"string","Tab Diff "&i

                if false then
                if     i = 2 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 2 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 3 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 160/255 & " " & 8 / 255 & " " & 16 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 4 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 3 = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    end if
                elseif i = 9 then
                    if CURRENT_LEAGUE = "119" then  ' 1. Liga PLatz 9 = Grau
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 72/255 & " " & 72 / 255 & " " & 72 / 255 & vbNullChar
                    else                           ' 2. Liga = Dunkelrot
                         buffer = buffer & "1  SCENE*" & s__VizPath & "/" & sScene & "*TREE*$" & sCont & "$obj_Rang*MATERIAL*COLOR SET " & 255/255 & " " & 10 / 255 & " " & 20 / 255 & vbNullChar
                    end if
                end if
                end if
                SetVizDataBufferOff
                ids=ids+100
            next
        case "3"
            obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*STATISTIK START"& Chr(34)
            dir="STATISTIK"
            SetVizData "010500",Data.Item("STNAME1") ,"string", "Stat Name A"
            SetVizData "010501",Data.Item("STNAME2"),"string","Stat Name B"
            ids= 11101
            for i=1 to 8
                SetVizDataBufferOn
                SetVizData "0"&ids,Data.Item("STPARAM_A"&i) ,"string","Stat Value A "&i
                SetVizData "0"&ids+1,Data.Item("STTEXT"&i),"string","Stat Para "&i
                SetVizData "0"&ids+2,Data.Item("STPARAM_B"&i) ,"string","Stat Value B "&i
                SetVizDataBufferOff
                ids=ids+100
            next
            SetVizData "010004",Data.Item("STITEMCOUNT") ,"int","Stat Count"
        end select

        GetPreview "Default 3.0 ", "MEGAFACTS 2.5" , sScene                         '
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub LF_PlayerStat( ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "VB_Lframe7030"
        LoadScene elMainLayer, sScene
        dim dir
        obj__TV.DoEffect elMainLayer,  "ALL", efReset
        SetShow
        SetBGOnOff
        SetTitelDefaultHeaderLF
        if Data.item("BBTYP") = 0 then
            if Data.Item("BBSTATTYP") = 0 then
                SetVizData "970000",3 ,"int",""
                SetVizData "990100",Data.Item("BBHL"),"string","BB Headline"
                SetVizData "990102","" ,"string",""
                SetVizData "990200",Data.Item("BBSL") ,"string","BB Subline"

            else
                SetVizData "970000",1 ,"int",""
                SetVizData "970100",Data.Item("BBHL") ,"string","BB Headline"
                SetVizData "970102",Data.Item("FNAME") ,"string","BB Name"
                SetVizData "970120",Data.Item("BBSL") ,"string","BB Subline"
                SetVizData "970095",Data.Item("NR") ,"string","BB Number"
                ids=971110
                for i=1 to 3
                    SetVizData ids,Data.Item("BBSTATTEXT"&i),"string","BB Stat Text "&i
                    SetVizData ids+5,Data.Item("BBSTATVALUE"&i),"string","BB Value "&i
                    ids=ids+100
                next
                SetVizData 970005,3 ,"int",""
                SetTeamLogo 970090,LCase(Data.Item("LOGO1")),"Logo A"
            end if
        elseif Data.item("BBTYP") = 1 then
            SetVizData "970000",2  ,"int",""
            SetVizData "980149",0  ,"int",""
            SetVizData "980150","vs" ,"string",""
            SetVizData "980100",Data.Item("NAME1")  ,"string","BB Name A"
            SetVizData "980200",Data.Item("NAME2"),"string","BB Name B"
            SetTeamLogo "980090", Data.Item("LOGO1"),"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"Logo A"
            SetVizData "981100",Data.Item("BBSL") ,"string","BB Subline"
        elseif Data.item("BBTYP") = 2 then
            SetVizData "970000",2 ,"int",""
            SetVizData "980149",1 ,"int",""
            SetVizData "980150",Data.Item("BBSCORE"),"string","BB Score"
            SetVizData "980100",Data.Item("NAME1"),"string","BB Name A"
            SetVizData "980200",Data.Item("NAME2") ,"string","BB Name B"
            SetTeamLogo "980090", Data.Item("LOGO1"),"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"Logo A"
            SetVizData "981100",Data.Item("BBSL"),"string","BB Subline"

        else
            SetVizData "970000",3 ,"int",""
            SetVizData "990100",Data.Item("BBHL") ,"string","BB Headline"
            SetVizData "990102","" ,"string",""
            SetVizData "990200",Data.Item("BBSL")  ,"string","BB Subline"
        end if
        SetLFTitle Data.Item("STHL")
        SetVizData "060500",Data.Item("STSTAT") ,"string","Stats"

            'obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*VERGLEICH START"& Chr(34)
         select case Data.Item("STTYP")
            case "0"

            case "1"
                obj__TV.SendCommand "RENDERER*MAIN_LAYER*STAGE*DIRECTOR*Default*KEY*$ACTION*VALUE SET " & Chr(34) &"THIS_SCENE*STAGE*DIRECTOR*TOPSPIELER_2Z START"& Chr(34)
                dir="TOPSPIELER_2Z"
                ids= 61102
                for i=1 to 5
                    SetVizDataBufferOn
                    SetVizData "0"&ids,Data.Item("STNAME"&i)  ,"string","Stat Name "&i
                    SetVizData "0"&ids+1,Data.Item("STTEXT"&i) ,"string","Stat Para "&i
                    SetVizData "0"&ids+2,Data.Item("STVALUE"&i),"string","Stat Value "&i
                    SetVizDataBufferOff
                    ids=ids+100
                next
                if Data.Item("STITEMCOUNT")>5 then  Data.Item("STITEMCOUNT")=5
                SetVizData "060004",Data.Item("STITEMCOUNT") ,"int","Stat Count"

            case "2"

        end select

        GetPreview "Default 3.0", dir&" 3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public sub LF_Lineup( ByRef Data)
        if not i_variant=1 then exit sub
        dim i
        sScene = "VB_Lframe3070_Aufstellung"
        LoadScene elMainLayer, sScene
        SetTitelDefaultHeaderLF
        SetShow
        obj__TV.DoEffect elMainLayer,  "ALL", efReset
        if Data.item("BBTYP") = 0 then
            if Data.Item("BBSTATTYP") = 0 then
                SetVizData "970000",3 ,"int",""
                SetVizData "990100",Data.Item("BBHL") ,"string","BB Headline"
                SetVizData "990102",""  ,"string",""
                SetVizData "990200",Data.Item("BBSL"),"string","BB Subline"

            else
                SetVizData "970000",1 ,"int",""
                SetVizData "970100",Data.Item("BBHL"),"string","BB Headline"
                SetVizData "970102",Data.Item("FNAME")  ,"string","BB Name"
                SetVizData "970120",Data.Item("BBSL")  ,"string","BB Subline"
                SetVizData "970095",Data.Item("NR")   ,"string","BB Number"
                ids=971110
                for i=1 to 3
                    SetVizData ids,Data.Item("BBSTATTEXT"&i),"string","BB Stat Text "&i
                    SetVizData ids+5,Data.Item("BBSTATVALUE"&i) ,"string","BB Value "&i
                    ids=ids+100
                next
                SetVizData 970005,3 ,"int",""
                SetTeamLogo 970090,LCase(Data.Item("LOGO1")),"Logo A"
            end if
        elseif Data.item("BBTYP") = 1 then
            SetVizData "970000",2 ,"int",""
            SetVizData "980149",0 ,"int",""
            SetVizData "980150","vs" ,"string",""
            SetVizData "980100",Data.Item("NAME1")  ,"string","BB Name A"
            SetVizData "980200",Data.Item("NAME2") ,"string","BB Name B"
            SetTeamLogo "980090", Data.Item("LOGO1"),"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"Logo B"
            SetVizData "981100",Data.Item("BBSL") ,"string","BB Subline"
        elseif Data.item("BBTYP") = 2 then
            SetVizData "970000",2 ,"int",""
            SetVizData "980149",1 ,"int",""
            SetVizData "980150",Data.Item("BBSCORE"),"string","BB Score"
            SetVizData "980100",Data.Item("NAME1"),"string","BB Name A"
            SetVizData "980200",Data.Item("NAME2") ,"string","BB Name B"
            SetTeamLogo "980090", Data.Item("LOGO1"),"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"Logo B"
            SetVizData "981100",Data.Item("BBSL") ,"string","BB Subline"

        elseif Data.item("BBTYP") = 3 then
            SetVizData "970000",3 ,"int",""
            SetVizData "990100",Data.Item("BBHL") ,"string","BB Headline"
            SetVizData "990102",""    ,"string",""
            SetVizData "990200",Data.Item("BBSL"),"string","BB Subline"
        else
            SetVizData "970000",4 ,"int",""
            obj__TV.SetCrawl "BAUCHBINDEN$CRAWL$txt_CrawlHeim", crClear,  ""
            obj__TV.SetCrawl "BAUCHBINDEN$CRAWL$txt_CrawlHeim", crScript, Data.Item("BBHL")
            obj__TV.SetCrawl "BAUCHBINDEN$CRAWL$txt_CrawlHeim", crReset, ""
            obj__TV.SetCrawl "BAUCHBINDEN$CRAWL$txt_CrawlGast", crClear,  ""
            obj__TV.SetCrawl "BAUCHBINDEN$CRAWL$txt_CrawlGast", crScript, Data.Item("BBCRAWL2")
            obj__TV.SetCrawl "BAUCHBINDEN$CRAWL$txt_CrawlGast", crReset, ""
            SetVizData "981100",Data.Item("BBSL"),"string","BB Subline"

            SetTeamLogo "980090", Data.Item("LOGO1"),"Logo A"
            SetTeamLogo "980190", Data.Item("LOGO2"),"Logo B"

            if Data.item("CRAWLLEFT") then
                obj__TV.HideObject "BAUCHBINDEN$CRAWL$LOGO_2"
            else
                obj__TV.ShowObject "BAUCHBINDEN$CRAWL$LOGO_2"
            end if
        end if

        dim P_Nr,P_Name, x_Pos, y_Pos, ScenePosX, ScenePosY, Team, TeamId,  LineupID

        dim LineupWidth : LineupWidth  = 860    '80-850
        dim LineupHeight: LineupHeight = 550   '80-470
        dim SceneWidth   : SceneWidth  = 410    '-200-200
        dim SceneHeight  : SceneHeight = 210    '-86-118
        dim startx:startx=-190
        dim starty:starty=-90
        if Data.Item("BFIRST") ="B" then
            Team = "B"
            TeamId = 2
            LineupID = Lineup_B
            Lineup.ActiveLineup = "Team B"
        else
            Team = "A"
            TeamId = 1
            LineupID = Lineup_A
            Lineup.ActiveLineup = "Team A"
        end if
        SetVizData "000100",Data.Item("LNAME1") ,"string","Teamname A"
        SetVizData "000102",""  ,"string",""
        SetVizData "000110",Data.Item("LNAME2") ,"string","Teamname B"
        SetVizData "000112","" ,"string",""
        SetTeamLogo "000090",LCase(Data.Item("LLOGO1")),"Logo A"
        'SetVizData "000100",Data.Item("LNAME1")
        'SetVizData "000102",""
        SetTeamLogo "000095",LCase(Data.Item("LLOGO2")),"Logo B"
        dim ids: ids=191100
        dim o0,p
        For i = 1 to 11
            SetVizDataBufferOn
            P_Nr   = Trim(Lineup.GetPlayer(Lineup_Nr, i, LineupID))
            P_Name = (GetData(Team, P_Nr))
            x_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_X, i, LineupID),1,0,"",-1) - MakeNumber(Lineup.GetPlayer(Lineup_Nr_W, i, LineupID),1,0,"",-1)
            y_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_Y, i, LineupID),1,0,"",-1)  + 8 + MakeNumber(Lineup.GetPlayer(Lineup_Name_H, i, LineupID),1,0,"",-1)'Trim(Lineup.GetPlayer(Lineup_Name_Y, i))

            'cc.sf.DebugText i& " -" &P_Nr &" - "&P_Name
            o0= Formatnumber(x_Pos,1)'-80
            p=(o0/LineupWidth)*SceneWidth
            o0=p+startx
            ScenePosX    = Replace(o0, ",", ".")
            o0= Formatnumber(y_Pos,1)-27
            p=(o0/LineupHeight)*SceneHeight
            o0=p+starty

            ScenePosY    = Replace(o0, ",", ".")
            'ScenePosX  = Replace(Formatnumber((x_Pos - 480) / (LineupWidth / SceneWidth), 1), ",", ".") '- 21
            'ScenePosY  = Replace(Formatnumber((y_Pos - 288) / (LineupHeight / SceneHeight), 1), ",", ".") +16'-41

            SetVizData ids,P_nr  ,"string","Player Number "&i
            SetVizData ids+2,P_Name ,"string","Player Name "&i
            SetVizData (ids+10)&".x1",ScenePosX  ,"double","PosX "&i
            SetVizData (ids+10)&".y1",ScenePosY  ,"double","PosY "&i
            ids=ids+100
            SetVizDataBufferOff
            if isPlayerHL(P_Nr,Team) =true then
                obj__TV.SendCommand "SCENE*" & s__VizPath & "/"&sScene&"*STAGE*DIRECTOR*$H"&i&" SHOW 0.7"
            end if
        Next

        if Data.Item("BFIRST")="B" then
            Team = "A"
            TeamId = 1
            LineupID = Lineup_A
            Lineup.ActiveLineup = "Team A"
        else
            Team = "B"
            TeamId = 2
            LineupID = Lineup_B
            Lineup.ActiveLineup = "Team B"
        end if
        
        ids=193100
        For i = 1 to 11
            SetVizDataBufferOn
            P_Nr   = Trim(Lineup.GetPlayer(Lineup_Nr, i, LineupID))
            P_Name = (GetData(Team, P_Nr))
            'c.sf.DebugText P_Nr &" - "&P_Name
            x_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_X, i, LineupID),1,0,"",-1) - MakeNumber(Lineup.GetPlayer(Lineup_Nr_W, i, LineupID),1,0,"",-1)
            y_Pos  = MakeNumber(Lineup.GetPlayer(Lineup_Name_Y, i, LineupID),1,0,"",-1)  + 8 + MakeNumber(Lineup.GetPlayer(Lineup_Name_H, i, LineupID),1,0,"",-1)'Trim(Lineup.GetPlayer(Lineup_Name_Y, i))

            o0= Formatnumber(x_Pos,1)'-80
            p=(o0/LineupWidth)*SceneWidth
            o0=p+startx
            ScenePosX    = Replace(o0, ",", ".")
            o0= Formatnumber(y_Pos,1)-27
            p=(o0/LineupHeight)*SceneHeight
            o0=p+starty

            ScenePosY    = Replace(o0, ",", ".")

            SetVizData ids,P_nr ,"string","Player Number "&i
            SetVizData ids+2,P_Name ,"string","Player Name "&i
            SetVizData (ids+10)&".x1",ScenePosX ,"double","PosX "&i
            SetVizData (ids+10)&".y1",ScenePosY ,"double","PosY "&i
            ids=ids+100
            SetVizDataBufferOff
            if isPlayerHL(P_Nr,Team) =true then
                obj__TV.SendCommand "SCENE*" & s__VizPath & "/"&sScene&"*STAGE*DIRECTOR*$BH"&i&" SHOW 0.7"
            end if
        Next

        GetPreview "Default 3.0 ", " L1 3.0 L2 3.0 L3 3.0 L4 3.0 L5 3.0 L6 3.0 L7 3.0 L8 3.0 L9 3.0 L10 3.0 L11 3.0 TAKT_AUFSTELLUNG 3.0 SPIELERPOS_HEIM 0.0",sScene   'TAKT_AUFSTELLUNG 3.0
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    Public Sub FP_TactLineupLiveUpdateLF(ByRef Data)
        sScene = "VB_Lframe3070_Aufstellung"
        dim LineupWidth : LineupWidth  = 860   '80-850
        dim LineupHeight: LineupHeight = 550    '80-470
        dim SceneWidth   : SceneWidth  = 410    '-200-200
        dim SceneHeight  : SceneHeight = 210    '-86-118
        dim startx:startx=-190
        dim starty:starty=-90

        dim o0,p
        o0= Formatnumber(Data.Item("myX"),1)'-80
        p=(o0/LineupWidth)*SceneWidth
        o0=p+startx
        dim ScenePosX   : ScenePosX    = Replace(o0, ",", ".")


        o0= Formatnumber(Data.Item("myY"),1)-27
        p=(o0/LineupHeight)*SceneHeight
        o0=p+starty

        dim ScenePosY   : ScenePosY    = Replace(o0, ",", ".")
        Dim Team
        Team = UCASE(split(Lineup.ActiveLineup)(1))
        'cc.SF.DebugText Data.Item("myX") &" - "& Data.Item("myY") &" --- "&ScenePosX & " - "& ScenePosY
        dim ids
        if Team = "A" then
            ids=191000+(Data.Item("Curr")*100)
            SetVizData (ids+10)&".x1",ScenePosX  ,"double",""
            SetVizData (ids+10)&".y1",ScenePosY  ,"double",""
            obj__TV.SendCommand "SCENE*" & s__VizPath & "/VB_Lframe3070_Aufstellung*TREE*$SPIELER_HEIM$SPIELER_" & Data.Item("Curr") & "$POS*TRANSFORMATION*POSITION SET " & ScenePosX & " " & ScenePosY & " 0.0"

        else
            ds=193000+(Data.Item("Curr")*100)
            SetVizData (ids+10)&".x1",ScenePosX  ,"double",""
            SetVizData (ids+10)&".y1",ScenePosY  ,"double",""
            obj__TV.SendCommand "SCENE*" & s__VizPath & "/VB_Lframe3070_Aufstellung*TREE*$SPIELER_GAST$SPIELER_" & Data.Item("Curr") & "$POS*TRANSFORMATION*POSITION SET " & ScenePosX & " " & ScenePosY & " 0.0"
        end if

    End Sub

    Public sub VorlaufLogo_Show(byref Data)
        sScene = "Cornerbug_Vorlauf"
        LoadScene elFrontlayer, sScene
        
        dim i
        select case tw_Layout.layout.ItemIndex
            case 0      i=1
            case 1      i=3
            case 2      i=4
            case 3      i=11
            case 4      i=8
            case 5      i=9
        end select
        SetVizDataFL "0000",i
        SetVizDataFL "0090","IMAGE*"&s__LogoPath & "/" &LCase(Data.Item("LOGO1"))
        SetVizDataFL "0190","IMAGE*"&s__LogoPath & "/" &LCase(Data.Item("LOGO2"))
        SetVizDataFL "0003",Data.Item("TYP")
        if  Data.Item("TYP") = 1 then
            SetVizDataFL "0150",Data.Item("SCORE")
        elseif  Data.Item("TYP") = 2 then
            obj__TV.SendCommand "CLOCK5*TIME SET " & Data.Item("TIME")
            if  Data.Item("TIME") <3600 then
                obj__TV.SendCommand "SCENE*" & s__VizPath & "/"&sScene&"*TREE*$txt_Clock*GEOM*CLOCK*FORMAT SET mm:ss"
            else
                obj__TV.SendCommand "SCENE*" & s__VizPath & "/"&sScene&"*TREE*$txt_Clock*GEOM*CLOCK*FORMAT SET hh:mm:ss"
            end if
            obj__TV.SendCommand "CLOCK5*LIMIT SET 0"
            obj__TV.SendCommand "CLOCK5*DIRECTION SET DOWN"
            obj__TV.SendCommand "CLOCK5 START"
        elseif Data.Item("TYP") = 3 then
            SetVizDataFL "0500",Data.Item("TEXT")
        end if
        if Data.Item("LEFT")=true then
           SetVizDataFL "0002" ,0
        else
           SetVizDataFL "0002" ,1
        end if
        obj__TV.DoEffect elFrontlayer, "Default", efPlay
    end sub
    Public sub VorlaufLogo_Hide()
        obj__TV.DoEffect elFrontlayer, "Default", efContinue
        cc.sf.Wait 1000,"Wait"
        'obj__TV.SetScene "DSS_Uhr"
        'obj__TV.SendCommand "SCENE*" & s__VizPath & "/DSS_Uhr*STAGE SHOW 0"
         '  obj__TV.LoadScene elFrontLayer
         '  obj__TV.DoEffect elFrontLayer, "ALL", efReset
    end sub

     Public sub BB_ColdOpen(byref Data)
        if not i_variant=1 then exit sub
        sScene = "CB_Cold_Opener"
        LoadScene elMainlayer, sScene
        SetShow
        'SetTeamLogo "0060",lCase(Data.Item("LOGO1"))
        'SetTeamLogo "0070",lCase(Data.Item("LOGO2"))
        SetVizData "1100", Data.Item("PAGE1") ,"string","Text 1"
        SetVizData "1200",Data.Item("PAGE2") ,"string","Text 2"
        SetVizData "1300",Data.Item("PAGE3") ,"string","Text 3"
        SetVizData "0004",1 ,"int",""
        GetPreview "Default", "0.6", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    Public sub Karusell_Show(byref Data)
        'sScene = "CB_Konf_Ergs"
        'LoadScene2 elBacklayer, sScene

        SetVizDataBL "6011",Data.Item("TEAMA")
        SetVizDataBL "6012",Data.Item("SCORE")
        SetVizDataBL "6013",Data.Item("TEAMB")

        obj__TV.DoEffect elBacklayer, "Default", efPlay
    end sub

    Public sub Karusell_Hide()
        obj__TV.DoEffect elBacklayer, "Default", efContinue
    end sub

    Public sub Karusell_Next(byref Data)
        sScene = "CB_Konf_Ergebnisse"
        if Data.Item("SIDE") = "A" then
            SetVizDataBL "6011",Data.Item("TEAMA")
            SetVizDataBL "6012",Data.Item("SCORE")
            SetVizDataBL "6013",Data.Item("TEAMB")
            obj__TV.SendCommand("RENDERER*BACK_LAYER*STAGE*DIRECTOR*$BLITZERG CONTINUE REVERSE")
            'obj__TV.DoEffect elBacklayer, "BLITZERG", efContinue
        else
            SetVizDataBL "6111",Data.Item("TEAMA")
            SetVizDataBL "6112",Data.Item("SCORE")
            SetVizDataBL "6113",Data.Item("TEAMB")
            obj__TV.DoEffect elBacklayer, "BLITZERG", efContinue
        end if
    end sub

     public sub Butterfly(byref Data)
        select case Data.Item("TYP")
            case 0  sScene = "VB_Butterfly_5050_1_1"
            case 1  sScene = "VB_Butterfly_5050_1_2"
        end select

        LoadScene elMainLayer, sScene
        obj__TV.DoEffect elMainLayer,  "ALL", efReset
        SetShow
        SetVizData "0100",""  ,"string",""
        SetVizData "0102",Data.Item("HLL")  ,"string","Headline Links"
        SetVizData "2100","" ,"string",""
        SetVizData "2102",Data.Item("HLR"),"string","Headline Rechts"
        
        SetVizData "0200",Data.Item("SLL"),"string","Subline Links"
        SetVizData "2200",Data.Item("SLR"),"string","Subline Rechts"




        GetPreview "Default", "2.5", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub

    public Sub PlayFL(director)
        obj__TV.DoEffect elFrontLayer, director,efPlay
    end sub
    public sub ContinueFL(director)
        obj__TV.DoEffect elFrontLayer, director,efContinue
    end sub

    public sub IB_Penalty(byref Data)
        if not i_variant=1 then exit sub
        sScene = "IB_Elfmeter"

        dim i

        LoadScene elMainLayer, sScene
        SetIBSide
        SetShow
        SetTitleLogo Data.Item("LOGO"),false
        SetTitle Data.Item("TITLE")
        dim ids:ids=210
        for i=1 to Data.Item("ITEMCOUNT")
            SetVizData ids&".active",1 ,"int","On/Off "&i
            SetVizData ids+1,Data.Item("HIT"&i) ,"string","Hit "&i
            SetVizData ids&".position",Data.Item("X"&i) & " " & Data.Item("Y"&i) & " 0.0" ,"tuple","Pos "&i
            ids=ids+10
        next
        for i=Data.Item("ITEMCOUNT")+1 to 20
            SetVizData ids&".active",0 ,"int","On/Off "&i
            ids=ids+10
        next


        GetPreview "Default", "3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub IB_Twittervoting(byref Data)
        if not i_variant=1 then exit sub
        sScene = "IB_Twittervoting"

        dim i

        LoadScene elMainLayer, sScene
        SetIBSide
        SetShow

        SetVizData "0006",Data.Item("TYP")  ,"string","Typ"
        SetTitle Data.Item("HL")
        SetVizData "1202",Data.Item("SL1")  ,"string","Subline 1"
        SetVizData "1203",Data.Item("SL2")  ,"string","Subline 2"
        SetVizData "0200",Data.Item("QUESTION") ,"string","question"
        SetVizData "1100", Data.Item("VS1") ,"string","Start 1"
        SetVizData "1101", Data.Item("VE1") ,"string","Ende 1"
        SetVizData "1200", Data.Item("VS2") ,"string","Start 2"
        SetVizData "1201", Data.Item("VE2") ,"string","Ende 2"
        
        SetTeamLogo "0610",Data.Item("LOGO1"),"Logo A"
        SetTeamLogo "0710",Data.Item("LOGO2"),"Logo A"
        SetPlayerHS "0600",Data.Item("LOGO1"),Data.Item("PHOTO1"),"Photo A"
        SetPlayerHS "0700",Data.Item("LOGO2"),Data.Item("PHOTO2"),"Photo B"
        
        if Data.Item("PHOTO")= true then
            SetVizData "0007",1 ,"int","Photo On/Off"
        else
            SetVizData "0007",0 ,"int","Photo On/Off"
        end if
        if Data.Item("TWITTER")= true then
            SetVizData "0085",1 ,"int","Twitter On/Off"
        else
            SetVizData "0085",0 ,"int","Twitter On/Off"
        end if
        GetPreview "Default", "3.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub VB_Virtual(data)
        sScene = data
        LoadSceneAR elMainLayer, sScene

        'Redim ActionList(2, 1)
        'ActionList(1, 0) = "Default"
        'ActionList(1, 1) = "Default"
        'ActionList(2, 1) = efPlay
    end sub

    public sub VB_Virtual_Set(data)
        if Data.item("GFX") <> "NONE" and Data.item("GFX") <> "" then
            obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*1 SET_OBJECT SCENE*" & s__VizPathARTemp & "/" & Data.item("GFX") )
            obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*1*STAGE SHOW 0.0")
        end if
    
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 11.position SET "&Data.item("X")&" 0 "&Data.item("Z"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 12.rotation SET 0 "&Data.item("PAN")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 13 SET "&Data.item("SCALE"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 14.position SET 0 "&Data.item("Y")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 15.position SET 0 "&-(Data.item("Y"))&" 0")

        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.position SET "&Data.item("X1")&" 0 "&Data.item("Z1"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.rotation SET 0 "&Data.item("PAN1")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 22 SET "&Data.item("SCALE1"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 23.position SET 0 "&Data.item("Y1")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 24.position SET 0 "&-(Data.item("Y1"))&" 0")
        
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.position SET "&Data.item("X2")&" 0 "&Data.item("Z2"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.rotation SET 0 "&Data.item("PAN2")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 32 SET "&Data.item("SCALE2"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 33.position SET 0 "&Data.item("Y2")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 34.position SET 0 "&-(Data.item("Y2"))&" 0")
        
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 51.position SET "&Data.item("X3")&" 0 "&Data.item("Z3"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 51.rotation SET 0 "&Data.item("PAN3")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 52 SET "&Data.item("SCALE3"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 53.position SET 0 "&Data.item("Y3")&" 0")
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 54.position SET 0 "&-(Data.item("Y3"))&" 0")


        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 41 SET "&Data.item("PLANE"))

        if Data.item("LOGO1")="" then
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.active SET 0")
        else
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.active SET 1")
        end if
        
        if Data.item("LOGO2")="" then
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.active SET 0")
        else
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.active SET 1" )
        end if
        
        if Data.item("IMG1")="" then
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 20.active SET 0")
        else
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 20.active SET 1")
        end if

        if Data.item("IMG2")="" then
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 30.active SET 0")
        else
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 30.active SET 1" )
        end if

        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 0061 SET "&s__PhotoVirtual & "/" &Data.item("IMG1"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 0071 SET "&s__PhotoVirtual & "/" &Data.item("IMG2"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 0060 SET IMAGE*"&s__LogoPath & "/" &Data.item("LOGO1"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 0070 SET IMAGE*"&s__LogoPath & "/" &Data.item("LOGO2"))

        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 0095 SET "& Data.item("ONOFF1"))
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 0100 SET "& Data.item("TEXT1"))
    end sub
    
    public sub GetValue()
        dim r
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 11.position GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_x.text=split(r)(0)
        tw_virtuell.edt_pos_y.text=split(r)(1)
        tw_virtuell.edt_pos_z.text=split(r)(2)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 12.rotation GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_pan.text=split(r)(1)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 13 GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_scale.text=r
        
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.position GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_x1.text=split(r)(0)
        tw_virtuell.edt_pos_y1.text=split(r)(1)
        tw_virtuell.edt_pos_z1.text=split(r)(2)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.rotation GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_pan1.text=split(r)(1)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 22 GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_scale1.text=r
        
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.position GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_x2.text=split(r)(0)
        tw_virtuell.edt_pos_y2.text=split(r)(1)
        tw_virtuell.edt_pos_z2.text=split(r)(2)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.rotation GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_pan2.text=split(r)(1)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 32 GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_scale2.text=r
        
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 51.position GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_x3.text=split(r)(0)
        tw_virtuell.edt_pos_y3.text=split(r)(1)
        tw_virtuell.edt_pos_z3.text=split(r)(2)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 51.rotation GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_pos_pan3.text=split(r)(1)
        obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 52 GET")
        r=obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*result GET")
        tw_virtuell.edt_scale3.text=r

        'cc.sf.DebugText r
    end sub
    
    public sub SetValue(nr)
        select case nr
        case 11
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 11.position SET "&tw_virtuell.edt_pos_x.text&" 0 "&tw_virtuell.edt_pos_z.text)
            'obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 12.position SET 0 "&tw_virtuell.edt_pos_y.text&" 0")
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 14.position SET 0 "&tw_virtuell.edt_pos_y.text&" 0")
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 15.position SET 0 "&-(tw_virtuell.edt_pos_y.text)&" 0")
        case 12
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 12.rotation SET 0 "&tw_virtuell.edt_pos_pan.text&" 0")
        case 13
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 13 SET "&tw_virtuell.edt_scale.text)
        case 21
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.position SET "&tw_virtuell.edt_pos_x1.text&" 0 "&tw_virtuell.edt_pos_z1.text)
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 23.position SET 0 "&tw_virtuell.edt_pos_y1.text&" 0")
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 24.position SET 0 "&-(tw_virtuell.edt_pos_y1.text)&" 0")
        case 22
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 21.rotation SET 0 "&tw_virtuell.edt_pos_pan1.text&" 0")
        case 23
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 22 SET "&tw_virtuell.edt_scale1.text)
        case 31
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.position SET "&tw_virtuell.edt_pos_x2.text&" 0 "&tw_virtuell.edt_pos_z2.text)
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 33.position SET 0 "&tw_virtuell.edt_pos_y2.text&" 0")
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 34.position SET 0 "&-(tw_virtuell.edt_pos_y2.text)&" 0")
        case 32
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 31.rotation SET 0 "&tw_virtuell.edt_pos_pan2.text&" 0")
        case 33
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 32 SET "&tw_virtuell.edt_scale2.text)
        case 41
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 41 SET "&tw_virtuell.rb_botton.ItemIndex)
        case 51
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 51.position SET "&tw_virtuell.edt_pos_x3.text&" 0 "&tw_virtuell.edt_pos_z3.text)
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 53.position SET 0 "&tw_virtuell.edt_pos_y3.text&" 0")
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 54.position SET 0 "&-(tw_virtuell.edt_pos_y3.text)&" 0")
        case 52
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 51.rotation SET 0 "&tw_virtuell.edt_pos_pan3.text&" 0")
        case 53
            obj__TV.SendCommand("RENDERER*MAIN_LAYER*TREE*$object*FUNCTION*ControlObject*in SET ON 52 SET "&tw_virtuell.edt_scale3.text)
         end select
    end sub
   public sub GFX_Cmd(cmd,nr)
        select case (cmd)
            case "PLAY"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*"&nr&"*STAGE*DIRECTOR*Default START")
            case "CONTINUE"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*"&nr&"*STAGE*DIRECTOR*Default CONTINUE")
            case "WECHSEL"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*"&nr&"*STAGE*DIRECTOR*WECHSEL CONTINUE")
            case "RESET"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*"&nr&"*STAGE SHOW 0.0")
        end  select
   end sub

   public sub VIRTUAL_Cmd(cmd)
        select case (cmd)
            case "PLAY"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*STAGE* START")
            case "CONTINUE"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*STAGE CONTINUE")
            case "WECHSEL"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*STAGE*DIRECTOR*WECHSEL CONTINUE")
            case "RESET"
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*STAGE SHOW 0.0")
                obj__TV.SendCommandEx("RENDERER*MAIN_LAYER*GFX*1*STAGE SHOW 0.0")
        end  select
   end sub
   
   public sub BB_XPromo(byRef Data)
        if not i_variant=1 then exit sub
        sScene = "BB_Crosspromo_1"
        LoadScene elMainLayer, sScene
        SetShow
        SetVizData "0100", Data.Item("LINE1"),"string","Line 1"
        SetVizData "0201", Data.Item("LINE2"),"string","Line 2"
        SetVizData "0202", Data.Item("LINE3"),"string","Line 3"
        SetVizData "0090","IMAGE*"&s__LogoPathDiv & "/" &Data.Item("IMG"),"image","Image"

        GetPreview "Default", "2.0", sScene
        Redim ActionList(2, 1)
        ActionList(1, 0) = "Default"
        ActionList(1, 1) = "Default"
        ActionList(2, 1) = efPlay
    end sub
    
    public sub PP
        sScene = "CB_Produktplazierung"
        LoadScene elMainLayer, sScene
        obj__TV.DoEffect elMainLayer, "Default",efPlay
    end sub
    
    public sub CamSelect(cam)

        obj__TV.SendCommandEx("RENDERER SET_CAMERA "&cam)
    end sub
    
    public sub SetDefaultGFX(channel,onoff,scene,team)
        if channel=i_variant then
            if onoff then
                obj__TV.OpenProject s__VizPathWF
                obj__TV.RendererUpdate false

                obj__TV.SendCommandEx("POOLS CLEANUP")
                obj__TV.SetScene scene

                dim sResult
                sResult = obj__TV.SendCommandEx("RENDERER*MAIN_LAYER SET_OBJECT SCENE*" & s__VizPathWF & "/" & scene)
                sResult = obj__TV.SendCommandEx("RENDERER*" & sLayer & "*NAME GET")
                SetVizData "1114", team ,"reserved",""

                obj__TV.RendererUpdate true
            else
                obj__TV.ClearScene elMainLayer
            end if
        end if
    end sub
End Class

</script_body>
</script>
